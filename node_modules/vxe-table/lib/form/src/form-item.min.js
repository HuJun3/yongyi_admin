"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ctor=_interopRequireDefault(require("xe-utils/ctor")),_vXETable=_interopRequireDefault(require("../../v-x-e-table")),_tools=require("../../tools"),_conf=_interopRequireDefault(require("../../conf"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function renderPrefixIcon(e,t){return e("span",{class:"vxe-form--item-title-prefix"},[e("i",{class:t.icon||_conf.default.icon.FORM_PREFIX})])}function renderSuffixIcon(e,t){return e("span",{class:"vxe-form--item-title-suffix"},[e("i",{class:t.icon||_conf.default.icon.FORM_SUFFIX})])}function renderTitle(e,t){var i=t.title,l=t.titlePrefix,r=t.titleSuffix,n=[];return l&&n.push(l.message?e("vxe-tooltip",{props:{content:_tools.UtilTools.getFuncText(l.message),enterable:l.enterable,theme:l.theme}},[renderPrefixIcon(e,l)]):renderPrefixIcon(e,l)),n.push(e("span",{class:"vxe-form--item-title-label"},_tools.UtilTools.getFuncText(i))),r&&n.push(r.message?e("vxe-tooltip",{props:{content:_tools.UtilTools.getFuncText(r.message),enterable:r.enterable,theme:r.theme}},[renderSuffixIcon(e,r)]):renderSuffixIcon(e,r)),n}var _default={name:"VxeFormItem",props:{title:String,field:String,size:String,span:[String,Number],align:String,titleAlign:String,titleWidth:[String,Number],titlePrefix:Object,titleSuffix:Object,resetValue:{default:null},visible:{type:Boolean,default:null},visibleMethod:Function,folding:Boolean,collapseNode:Boolean,itemRender:Object},inject:{$vxeform:{default:null}},data:function(){return{showError:!1,showRule:null}},computed:{vSize:function(){return this.size||this.$parent.size||this.$parent.vSize},isRequired:function(){var e=this.$vxeform,t=this.field;if(e&&e.rules){var i=e.rules[t];if(i)return i.some(function(e){return e.required})}return!1},errRule:function(){var e=this.$vxeform,i=this.field;return e?_ctor.default.find(e.invalids,function(e){var t=e.property;return i===t}):null}},watch:{errRule:function(e){var t=this;clearTimeout(this.showErrTimeout),this.showError=!1,e?(this.showRule=e.rule,setTimeout(function(){t.showError=!0},30)):this.showErrTimeout=setTimeout(function(){t.showRule=null},350)}},render:function(e){var t=this._e,i=this.$scopedSlots,l=this.$vxeform,r=this.title,n=this.folding,o=this.visible,s=this.visibleMethod,a=this.field,u=this.collapseNode,f=this.itemRender,c=this.isRequired,d=this.showError,h=this.showRule,m=f?_vXETable.default.renderer.get(f.name):null,v=this.span||l.span,p=this.align||l.align,x=this.titleAlign||l.titleAlign,g=this.titleWidth||l.titleWidth,_=l.collapseAll,b=s,R={data:l.data,property:a,item:this,$form:l};if(!1===o)return t();!b&&m&&m.itemVisibleMethod&&(b=m.itemVisibleMethod);var S=[];return m&&m.renderItemContent?S=m.renderItemContent.call(this,e,f,R):m&&m.renderItem?S=m.renderItem.call(this,e,f,R):i&&i.default&&(S=i.default.call(this,R,e)),e("div",{class:["vxe-form--item",v?"vxe-col--".concat(v," is--span"):null,{"is--title":r,"is--required":c,"is--hidden":n&&_,"is--active":!b||b(R),"is--error":d}]},[e("div",{class:"vxe-form--item-inner"},[r?e("div",{class:["vxe-form--item-title",x?"align--".concat(x):null],style:g?{width:isNaN(g)?g:"".concat(g,"px")}:null},renderTitle(e,this)):null,e("div",{class:["vxe-form--item-content",p?"align--".concat(p):null]},S.concat([u?e("div",{class:"vxe-form--item-trigger-node",on:{click:this.toggleCollapseEvent}},[e("span",{class:"vxe-form--item-trigger-text"},_?_conf.default.i18n("vxe.form.unfolding"):_conf.default.i18n("vxe.form.folding")),e("i",{class:["vxe-form--item-trigger-icon",_?_conf.default.icon.FORM_FOLDING:_conf.default.icon.FORM_UNFOLDING]})]):null,h&&l.validOpts.showMessage?e("div",{class:"vxe-form--item-valid",style:h.maxWidth?{width:"".concat(h.maxWidth,"px")}:null},h.message):null]))])])},methods:{toggleCollapseEvent:function(e){var t=this.$vxeform;t.toggleCollapse(),t.$emit("toggle-collapse",{collapse:!t.collapseAll,data:t.data,$form:t,$event:e},e)}}};exports.default=_default;