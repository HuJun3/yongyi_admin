{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/pages/order/orderList/components/tableList.vue?vue&type=style&index=0&id=1186764a&scoped=true&lang=stylus&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/pages/order/orderList/components/tableList.vue","mtime":1610587844000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaW1nIHsKICAgIGhlaWdodDogMzZweDsKICAgIGRpc3BsYXk6IGJsb2NrOwp9Ci50YWJCb3gKICAgIHdpZHRoIDEwMCUKICAgIGhlaWdodCAxMDAlCiAgICBkaXNwbGF5IGZsZXgKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXIKICAgIC50YWJCb3hfaW1nCiAgICAgICAgd2lkdGggMzZweAogICAgICAgIGhlaWdodCAzNnB4CiAgICAgICAgaW1nCiAgICAgICAgICAgIHdpZHRoIDEwMCUKICAgICAgICAgICAgaGVpZ2h0IDEwMCUKICAgIC50YWJCb3hfdGl0CiAgICAgICAgd2lkdGggNjAlCiAgICAgICAgZm9udC1zaXplIDEycHggIWltcG9ydGFudAogICAgICAgIG1hcmdpbiAwIDJweCAwIDEwcHgKICAgICAgICBsZXR0ZXItc3BhY2luZzogMXB4OwogICAgICAgIHBhZGRpbmc6IDVweCAwOwogICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7Ci5vcmRlckRhdGEgPj4+Lml2dS10YWJsZS1jZWxse3BhZGRpbmctbGVmdDogMCAhaW1wb3J0YW50O30KLnZlcnRpY2FsLWNlbnRlci1tb2RhbHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7fQo="},{"version":3,"sources":["tableList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAidA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"tableList.vue","sourceRoot":"src/pages/order/orderList/components","sourcesContent":["<template>\n    <div>\n        <Table :columns=\"columns\" :data=\"orderList\"\n               ref=\"table\"\n               :loading=\"loading\" highlight-row\n               no-data-text=\"暂无数据\"\n               no-filtered-data-text=\"暂无筛选结果\"\n               @on-selection-change=\"onSelectTab\"\n               class=\"orderData mt25\"\n        >\n            <template slot-scope=\"{ row, index }\" slot=\"order_id\">\n                <span v-text=\"row.order_id\" style=\"display: block;\"></span>\n                <span v-show=\"row.is_del === 1\" style=\"color: #ED4014;display: block;\">用户已删除</span>\n            </template>\n            <template slot-scope=\"{ row, index }\" slot=\"info\">\n                <div class=\"tabBox\" v-for=\"(val, i ) in row._info\" :key=\"i\">\n                    <div class=\"tabBox_img\" v-viewer>\n                        <img v-lazy=\"val.cart_info.productInfo.attrInfo?val.cart_info.productInfo.attrInfo.image:val.cart_info.productInfo.image\">\n                    </div>\n                    <span class=\"tabBox_tit\">{{ val.cart_info.productInfo.store_name + ' | ' }}{{val.cart_info.productInfo.attrInfo?val.cart_info.productInfo.attrInfo.suk:''}}</span>\n                    <span class=\"tabBox_pice\">{{ '￥'+ val.cart_info.truePrice + ' x '+ val.cart_info.cart_num}}</span>\n                </div>\n            </template>\n            <template slot-scope=\"{ row, index }\" slot=\"statusName\">\n                <div v-html=\"row.status_name.status_name\" class=\"pt5\"></div>\n                <div v-viewer v-if=\"row.status_name.pics\" class=\"pictrue mr10\" v-for=\"(item,index) in row.status_name.pics || []\" :key=\"index\"><img v-lazy=\"item\" :src=\"item\" /></div>\n            </template>\n            <template slot-scope=\"{ row, index }\" slot=\"action\">\n                <a @click=\"edit(row)\"  v-if='row._status === 1'>编辑</a>\n                <a @click=\"sendOrder(row)\" v-if='row._status === 2 && row.shipping_type === 1'>发送货</a>\n                <a @click=\"delivery(row)\"  v-if='row._status === 4'>配送信息</a>\n                <a @click=\"bindWrite(row)\"  v-if=\"row.shipping_type == 2 && row.status == 0  && row.paid == 1 && row.refund_status === 0\">立即核销</a>\n                <Divider type=\"vertical\" v-if='row._status === 1 || row._status === 2 || row._status === 4 || (row.shipping_type == 2 && row.status == 0  && row.paid == 1 && row.refund_status === 0)'/>\n                <template>\n                    <Dropdown @on-click=\"changeMenu(row,$event)\">\n                        <a href=\"javascript:void(0)\">更多\n                            <Icon type=\"ios-arrow-down\"></Icon>\n                        </a>\n                        <DropdownMenu slot=\"list\">\n                            <DropdownItem name=\"1\" ref=\"ones\" v-show='row._status === 1 && row.paid === 0 && row.pay_type === \"offline\" '>立即支付</DropdownItem>\n                            <DropdownItem name=\"2\">订单详情</DropdownItem>\n                            <DropdownItem name=\"3\">订单记录</DropdownItem>\n                            <DropdownItem name=\"11\" v-show=\"row._status >= 3 && row.express_dump\">电子面单打印</DropdownItem>\n                            <DropdownItem name=\"10\" v-show=\"row._status >= 2\">小票打印</DropdownItem>\n                            <DropdownItem name=\"4\"  v-show='row._status !==1 || ( row._status === 3 && (row.use_integral > 0 && row.use_integral >= row.back_integral) ) '>订单备注</DropdownItem>\n                            <DropdownItem name=\"5\"  v-show='row._status !==1 && ((parseFloat(row.pay_price) > parseFloat(row.refund_price) || (row.pay_price == 0 && [0,1].indexOf(row.refund_status) !== -1)))'>立即退款</DropdownItem>\n                            <DropdownItem name=\"6\"  v-show='row._status !==1 && (row.use_integral > 0 && row.use_integral >= row.back_integral) '>退积分</DropdownItem>\n                            <DropdownItem name=\"7\"  v-show='row._status === 3'>不退款</DropdownItem>\n                            <DropdownItem name=\"8\"  v-show='row._status === 4'>已收货</DropdownItem>\n                            <DropdownItem name=\"9\">删除订单</DropdownItem>\n                        </DropdownMenu>\n                    </Dropdown>\n                </template>\n            </template>\n        </Table>\n        <div class=\"acea-row row-right page\">\n            <Page :total=\"page.total\" :current=\"page.pageNum\" show-elevator show-total @on-change=\"pageChange\"\n                  :page-size=\"page.pageSize\" @on-page-size-change=\"limitChange\" show-sizer/>\n        </div>\n        <!-- 编辑 退款 退积分 不退款-->\n        <edit-from ref=\"edits\" :FromData=\"FromData\" @submitFail=\"submitFail\"></edit-from>\n        <!-- 详情 -->\n        <details-from ref=\"detailss\" :orderDatalist=\"orderDatalist\" :orderId=\"orderId\"></details-from>\n        <!-- 备注 -->\n        <order-remark ref=\"remarks\" :orderId=\"orderId\" @submitFail=\"submitFail\"></order-remark>\n        <!-- 记录 -->\n        <order-record ref=\"record\"></order-record>\n        <!-- 发送货 -->\n        <order-send ref=\"send\" :orderId=\"orderId\" @submitFail=\"submitFail\"></order-send>\n    </div>\n</template>\n\n<script>\n    import expandRow from './tableExpand.vue';\n    import { orderList, getOrdeDatas, getDataInfo, getRefundFrom, getnoRefund, refundIntegral, getDistribution, writeUpdate } from '@/api/order';\n    import { mapState, mapMutations } from 'vuex';\n    import editFrom from '../../../../components/from/from';\n    import detailsFrom from '../handle/orderDetails';\n    import orderRemark from '../handle/orderRemark';\n    import orderRecord from '../handle/orderRecord';\n    import orderSend from '../handle/orderSend';\n\n    export default {\n        name: 'table_list',\n        components: { expandRow, editFrom, detailsFrom, orderRemark, orderRecord, orderSend },\n        data () {\n            return {\n                delfromData: {},\n                modal: false,\n                orderList: [],\n                orderCards: [],\n                loading: false,\n                orderId: 0,\n                columns: [\n                    {\n                        type: 'expand',\n                        width: 30,\n                        render: (h, params) => {\n                            return h(expandRow, {\n                                props: {\n                                    row: params.row\n                                }\n                            })\n                        }\n                    },\n                    {\n                        type: 'selection',\n                        width: 40,\n                        align: 'center'\n                    },\n                    {\n                        title: '订单号',\n                        align: 'center',\n                        slot: 'order_id',\n                        minWidth: 150\n                    },\n                    {\n                        title: '订单类型',\n                        key: 'pink_name',\n                        minWidth: 120\n                    },\n                    {\n                        title: '用户信息',\n                        key: 'nickname',\n                        minWidth: 100\n                    },\n                    {\n                        title: '商品信息',\n                        slot: 'info',\n                        minWidth: 330\n                    },\n                    {\n                        title: '实际支付',\n                        key: 'pay_price',\n                        minWidth: 70\n                    },\n                    {\n                        title: '支付时间',\n                        key: '_pay_time',\n                        minWidth: 100\n                    },\n                    {\n                        title: '支付状态',\n                        key: 'pay_type_name',\n                        minWidth: 80\n                    },\n                    {\n                        title: '订单状态',\n                        key: 'statusName',\n                        slot: 'statusName',\n                        minWidth: 100\n                    },\n                    {\n                        title: '操作',\n                        slot: 'action',\n                        fixed: 'right',\n                        minWidth: 150,\n                        align: 'center'\n                    }\n                ],\n                page: {\n                    total: 0, // 总条数\n                    pageNum: 1, // 当前页\n                    pageSize: 10 // 每页显示条数\n                },\n                data: [],\n                FromData: null,\n                orderDatalist: null,\n                modalTitleSs: '',\n                isDelIdList: []\n            }\n        },\n        computed: {\n            ...mapState('order', [\n                'orderPayType',\n                'orderStatus',\n                'orderTime',\n                'orderNum',\n                'fieldKey',\n                'orderType'\n            ])\n        },\n        mounted () {},\n        created () {\n            this.getList();\n        },\n        watch: {\n            'orderType': function () {\n                this.page.pageNum = 1;\n                this.getList();\n            }\n        },\n        methods: {\n            ...mapMutations('order', [\n                'getIsDel',\n                'getisDelIdListl'\n            ]),\n            // 操作\n            changeMenu (row, name) {\n                this.orderId = row.id;\n                switch (name) {\n                    case '1':\n                        this.delfromData = {\n                            title: '修改立即支付',\n                            url: `/order/pay_offline/${row.id}`,\n                            method: 'post',\n                            ids: ''\n                        };\n                        this.$modalSure(this.delfromData).then((res) => {\n                            this.$Message.success(res.msg);\n                            this.$emit('changeGetTabs');\n                            this.getList();\n                        }).catch(res => {\n                            console.log(res);\n                            this.$Message.error(res.msg);\n                        });\n                        // this.modalTitleSs = '修改立即支付';\n                        break;\n                    case '2':\n                        this.getData(row.id);\n                        break;\n                    case '3':\n                        this.$refs.record.modals = true;\n                        this.$refs.record.getList(row.id);\n                        break;\n                    case '4':\n                        this.$refs.remarks.modals = true;\n                        break;\n                    case '5':\n                        this.getRefundData(row.id);\n                        break;\n                    case '6':\n                        this.getRefundIntegral(row.id);\n                        break;\n                    case '7':\n                        this.getNoRefundData(row.id);\n                        break;\n                    case '8':\n                        this.delfromData = {\n                            title: '修改确认收货',\n                            url: `/order/take/${row.id}`,\n                            method: 'put',\n                            ids: ''\n                        };\n                        this.$modalSure(this.delfromData).then((res) => {\n                            this.$Message.success(res.msg);\n                            this.getList();\n                        }).catch(res => {\n                            this.$Message.error(res.msg);\n                        });\n                        // this.modalTitleSs = '修改确认收货';\n                        break;\n                    case '10':\n                        this.delfromData = {\n                            title: '立即打印订单',\n                            info: '您确认打印此订单吗?',\n                            url: `/order/print/${row.id}`,\n                            method: 'get',\n                            ids: ''\n                        };\n                        this.$modalSure(this.delfromData).then((res) => {\n                            this.$Message.success(res.msg);\n                            this.$emit('changeGetTabs');\n                            this.getList();\n                        }).catch(res => {\n                            console.log(res);\n                            this.$Message.error(res.msg);\n                        });\n                        break;\n                    case '11':\n                        this.delfromData = {\n                            title: '立即打印电子面单',\n                            info: '您确认打印此电子面单吗?',\n                            url: `/order/order_dump/${row.id}`,\n                            method: 'get',\n                            ids: ''\n                        };\n                        this.$modalSure(this.delfromData).then((res) => {\n                            this.$Message.success(res.msg);\n                            this.getList();\n                        }).catch(res => {\n                            this.$Message.error(res.msg);\n                        });\n                        break;\n                    default:\n                        this.delfromData = {\n                            title: '删除订单',\n                            url: `/order/del/${row.id}`,\n                            method: 'DELETE',\n                            ids: ''\n                        };\n                        // this.modalTitleSs = '删除订单';\n                        this.delOrder(row, this.delfromData);\n                }\n            },\n            // 立即支付 /确认收货//删除单条订单\n            submitModel () {\n                this.getList();\n            },\n            pageChange (index) {\n                this.page.pageNum = index;\n                this.getList();\n            },\n            limitChange (limit) {\n                this.page.pageSize = limit;\n                this.getList();\n            },\n            // 订单列表\n            getList (res) {\n                this.page.pageNum = res === 1 ? 1 : this.page.pageNum;\n                this.loading = true;\n                orderList({\n                    page: this.page.pageNum,\n                    limit: this.page.pageSize,\n                    status: this.orderStatus,\n                    pay_type: this.orderPayType,\n                    data: this.orderTime,\n                    real_name: this.orderNum,\n                    field_key: this.fieldKey,\n                    type: this.orderType === 0 ? '' : this.orderType\n                }).then(async res => {\n                    let data = res.data;\n                    this.orderList = data.data;\n                    this.orderCards = data.stat;\n                    this.page.total = data.count;\n                    this.$emit('on-changeCards', data.stat);\n                    this.loading = false;\n                }).catch(res => {\n                    this.loading = false;\n                    this.$Message.error(res.msg);\n                })\n            },\n            // 全选\n            onSelectTab (selection) {\n                let isDel = selection.some(item => {\n                    return item.is_del === 1\n                });\n                this.getIsDel(isDel);\n                this.getisDelIdListl(selection);\n            },\n            // 编辑\n            edit (row) {\n                this.getOrderData(row.id);\n            },\n            // 删除单条订单\n            delOrder (row, data) {\n                if (row.is_del === 1) {\n                    this.$modalSure(data).then((res) => {\n                        this.$Message.success(res.msg);\n                        this.getList();\n                    }).catch(res => {\n                        this.$Message.error(res.msg);\n                    });\n                } else {\n                    const title = '错误！';\n                    const content = '<p>您选择的的订单存在用户未删除的订单，无法删除用户未删除的订单！</p>';\n                    this.$Modal.error({\n                        title: title,\n                        content: content\n                    });\n                }\n            },\n            // 获取编辑表单数据\n            getOrderData (id) {\n                getOrdeDatas(id).then(async res => {\n                    if (res.data.status === false) {\n                        return this.$authLapse(res.data);\n                    }\n                    this.$authLapse(res.data);\n                    this.FromData = res.data;\n                    this.$refs.edits.modals = true;\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                })\n            },\n            // 获取详情表单数据\n            getData (id) {\n                getDataInfo(id).then(async res => {\n                    this.$refs.detailss.modals = true;\n                    this.orderDatalist = res.data;\n                    if (this.orderDatalist.orderInfo.refund_reason_wap_img) {\n                        try {\n                            this.orderDatalist.orderInfo.refund_reason_wap_img = JSON.parse(this.orderDatalist.orderInfo.refund_reason_wap_img);\n                        } catch (e) {\n                            this.orderDatalist.orderInfo.refund_reason_wap_img = [];\n                        }\n                    }\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                })\n            },\n            // 修改成功\n            submitFail () {\n                this.getList();\n            },\n            // 获取退款表单数据\n            getRefundData (id) {\n                this.$modalForm(getRefundFrom(id)).then(() => {\n                    this.getList();\n                    this.$emit('changeGetTabs');\n                });\n            },\n            // 获取退积分表单数据\n            getRefundIntegral (id) {\n                refundIntegral(id).then(async res => {\n                    this.FromData = res.data;\n                    this.$refs.edits.modals = true;\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                })\n            },\n            // 不退款表单数据\n            getNoRefundData (id) {\n                this.$modalForm(getnoRefund(id)).then(() => {\n                    this.getList();\n                    this.$emit('changeGetTabs');\n                });\n            },\n            // 发送货\n            sendOrder (row) {\n                this.$refs.send.modals = true;\n                this.$refs.send.getList();\n                this.$refs.send.getDeliveryList();\n                this.orderId = row.id;\n            },\n            // 配送信息表单数据\n            delivery (row) {\n                getDistribution(row.id).then(async res => {\n                    this.FromData = res.data;\n                    this.$refs.edits.modals = true;\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                })\n            },\n            change (status) {\n                console.log(status);\n            },\n            // 数据导出；\n            exportData: function () {\n                this.$refs.table.exportCsv({\n                    filename: '商品列表'\n                });\n            },\n            // 核销订单\n            bindWrite (row) {\n                let self = this\n                this.$Modal.confirm({\n                    title: '提示',\n                    content: '确定要核销该订单吗？',\n                    cancelText: '取消',\n                    closable: true,\n                    maskClosable: true,\n                    onOk: function () {\n                        writeUpdate(row.order_id).then(res => {\n                            self.$Message.success(res.msg)\n                            self.getList();\n                        })\n                    }\n                });\n            }\n        }\n    }\n</script>\n\n<style scoped lang=\"stylus\">\n    img {\n        height: 36px;\n        display: block;\n    }\n    .tabBox\n        width 100%\n        height 100%\n        display flex\n        align-items: center\n        .tabBox_img\n            width 36px\n            height 36px\n            img\n                width 100%\n                height 100%\n        .tabBox_tit\n            width 60%\n            font-size 12px !important\n            margin 0 2px 0 10px\n            letter-spacing: 1px;\n            padding: 5px 0;\n            box-sizing: border-box;\n    .orderData >>>.ivu-table-cell{padding-left: 0 !important;}\n    .vertical-center-modal{\n        display: flex;\n        align-items: center;\n        justify-content: center;}\n</style>\n"]}]}