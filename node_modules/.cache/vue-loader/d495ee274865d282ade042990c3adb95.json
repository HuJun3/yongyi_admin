{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/pages/order/orderList/handle/orderSend.vue?vue&type=style&index=0&id=80567452&scoped=true&lang=css&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/pages/order/orderList/handle/orderSend.vue","mtime":1610587844000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5leHByZXNzX3RlbXBfaWQgewogICAgcG9zaXRpb246IHJlbGF0aXZlOwp9CgouZXhwcmVzc190ZW1wX2lkIGJ1dHRvbiB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDUwJTsKICAgIHJpZ2h0OiAxMTBweDsKICAgIHBhZGRpbmc6IDA7CiAgICBib3JkZXI6IG5vbmU7CiAgICBiYWNrZ3JvdW5kOiBub25lOwogICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpOwogICAgY29sb3I6ICM1N2EzZjM7Cn0KCi5pdnUtYnRuLXRleHQ6Zm9jdXMgewogICAgYm94LXNoYWRvdzogbm9uZTsKfQo="},{"version":3,"sources":["orderSend.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwRA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"orderSend.vue","sourceRoot":"src/pages/order/orderList/handle","sourcesContent":["<template>\n    <Modal v-model=\"modals\" scrollable title=\"订单发送货\" class=\"order_box\" :closable=\"false\">\n        <Form ref=\"formItem\" :model=\"formItem\" :label-width=\"100\" @submit.native.prevent>\n            <FormItem label=\"选择类型：\">\n                <RadioGroup v-model=\"formItem.type\" @on-change=\"changeRadio\">\n                    <Radio label=\"1\">发货</Radio>\n                    <Radio label=\"2\">送货</Radio>\n                    <Radio label=\"3\">虚拟</Radio>\n                </RadioGroup>\n            </FormItem>\n<!--            <FormItem v-show=\"formItem.type === '1' && export_open\" label=\"发货类型：\">-->\n<!--                <RadioGroup v-model=\"formItem.express_record_type\" @on-change=\"changeExpress\">-->\n<!--                    <Radio label=\"1\">手动填写</Radio>-->\n<!--                    <Radio label=\"2\">电子面单打印</Radio>-->\n<!--                </RadioGroup>-->\n<!--            </FormItem>-->\n            <div v-show=\"formItem.type==='1'\">\n                <FormItem label=\"快递公司：\">\n                    <Select v-model=\"formItem.delivery_name\" filterable placeholder=\"请选择快递公司\" style=\"width:80%;\" @on-change=\"expressChange\">\n                        <Option v-for=\"(item,i) in express\" :value=\"item.value\" :key=\"item.value\">{{ item.value }}</Option>\n                    </Select>\n                </FormItem>\n                <FormItem v-if=\"formItem.express_record_type === '1'\" label=\"快递单号：\">\n                    <Input v-model=\"formItem.delivery_id\" placeholder=\"请输入快递单号\" style=\"width:80%;\"></Input>\n                </FormItem>\n<!--                <template v-if=\"formItem.express_record_type === '2'\">-->\n<!--                    <template>-->\n<!--                        <FormItem label=\"电子面单：\" class=\"express_temp_id\">-->\n<!--                            <Select v-model=\"formItem.express_temp_id\" placeholder=\"请选择电子面单\" style=\"width:80%;\" @on-change=\"expressTempChange\">-->\n<!--                                <Option v-for=\"(item,i) in expressTemp\" :value=\"item.temp_id\" :key=\"i\">{{ item.title }}</Option>-->\n<!--                            </Select>-->\n<!--                            <Button v-if=\"formItem.express_temp_id\" type=\"text\" @click=\"preview\">预览</Button>-->\n<!--                        </FormItem>-->\n<!--                    </template>-->\n<!--                    <FormItem label=\"寄件人姓名：\">-->\n<!--                        <Input v-model=\"formItem.to_name\" placeholder=\"请输入寄件人姓名\" style=\"width:80%;\"></Input>-->\n<!--                    </FormItem>-->\n<!--                    <FormItem label=\"寄件人电话：\">-->\n<!--                        <Input v-model=\"formItem.to_tel\" placeholder=\"请输入寄件人电话\" style=\"width:80%;\"></Input>-->\n<!--                    </FormItem>-->\n<!--                    <FormItem label=\"寄件人地址：\">-->\n<!--                        <Input v-model=\"formItem.to_addr\" placeholder=\"请输入寄件人地址\" style=\"width:80%;\"></Input>-->\n<!--                    </FormItem>-->\n<!--                </template>-->\n            </div>\n            <div v-show=\"formItem.type==='2'\">\n                <FormItem label=\"送货人：\">\n                    <Select v-model=\"formItem.sh_delivery\" placeholder=\"请选择送货人\" style=\"width:80%;\" @on-change=\"shDeliveryChange\">\n                        <Option v-for=\"(item,i) in deliveryList\" :value=\"item.id\" :key=\"i\">{{ item.nickname }}（{{ item.phone }}）</Option>\n                    </Select>\n                </FormItem>\n            </div>\n            <div v-show=\"formItem.type==='3'\">\n                <FormItem label=\"备注：\">\n                    <Input v-model=\"formItem.fictitious_content\" type=\"textarea\" :autosize=\"{minRows: 2,maxRows: 5}\" placeholder=\"备注\" style=\"width:80%;\"></Input>\n                </FormItem>\n            </div>\n        </Form>\n        <div slot=\"footer\">\n            <Button @click=\"cancel\">取消</Button>\n            <Button type=\"primary\" @click=\"putSend\">提交</Button>\n        </div>\n        <div ref=\"viewer\" v-viewer>\n            <img :src=\"temp.pic\" style=\"display:none\" />\n        </div>\n    </Modal>\n</template>\n\n<script>\n    import { getExpressData, putDelivery, orderExpressTemp, orderDeliveryList, orderSheetInfo } from '@/api/order';\n    export default {\n        name: 'orderSend',\n        props: {\n            orderId: Number\n        },\n        data () {\n            return {\n                formItem: {\n                    type: '1',\n                    express_record_type: '1',\n                    delivery_name: '',\n                    delivery_id: '',\n                    express_temp_id: '',\n                    to_name: '',\n                    to_tel: '',\n                    to_addr: '',\n                    sh_delivery: '',\n                    fictitious_content: ''\n                },\n                modals: false,\n                express: [],\n                expressTemp: [],\n                deliveryList: [],\n                temp: {},\n              export_open:true,\n            }\n        },\n        mounted(){\n        },\n        methods: {\n            changeRadio (o) {\n                switch (o) {\n                    case '1':\n                        this.formItem.delivery_name = '';\n                        this.formItem.delivery_id = '';\n                        this.formItem.express_temp_id = '';\n                        this.formItem.express_record_type = '1';\n                        this.expressTemp = [];\n                        break;\n                    case '2':\n                        this.formItem.sh_delivery = '';\n                        break;\n                    case '3':\n                        this.formItem.fictitious_content = '';\n                        break;\n                    default:\n                        break;\n                }\n            },\n            changeExpress(j){\n                switch (j){\n                    case '2':\n                        this.formItem.delivery_name = '';\n                        this.formItem.express_temp_id = '';\n                        this.expressTemp = [];\n                        break;\n                    case '1':\n                        this.formItem.delivery_name = '';\n                        this.formItem.delivery_id = '';\n                        break;\n                    default:\n                        break;\n                }\n            },\n            reset(){\n                this.formItem = {\n                        type: '1',\n                        express_record_type: '1',\n                        delivery_name: '',\n                        delivery_id: '',\n                        express_temp_id: '',\n                        expressTemp : [],\n                        to_name: '',\n                        to_tel: '',\n                        to_addr: '',\n                        sh_delivery: '',\n                        fictitious_content: ''\n                };\n            },\n            // 物流公司列表\n            getList () {\n                console.log('kkkkk',this.modals);\n                getExpressData().then(async res => {\n                  this.express = res.data\n                  this.getSheetInfo();\n                }).catch(res => {\n                    this.loading = false;\n                    this.$Message.error(res.msg);\n                })\n            },\n            // 提交\n            putSend () {\n                let data = {\n                    id: this.orderId,\n                    datas: this.formItem\n                };\n                if(this.formItem.type === '1'){\n                    if(this.formItem.delivery_name === ''){\n                        return this.$Message.error('快递公司不能为空');\n                    }else if(this.formItem.delivery_id === ''){\n                        return this.$Message.error('快递单号不能为空');\n                    }\n                }\n                if(this.formItem.type === '2'){\n                    if(this.formItem.sh_delivery === ''){\n                        return this.$Message.error('送货人不能为空');\n                    }\n                }\n                putDelivery(data).then(async res => {\n                    this.modals = false;\n                    this.$Message.success(res.msg);\n                    this.$emit('submitFail');\n                    this.reset()\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                })\n            },\n            cancel () {\n                this.modals = false;\n                this.reset();\n            },\n            // 电子面单列表\n            expressChange (value) {\n                let expressItem = this.express.find(item => {\n                    return item.value === value;\n                });\n                this.formItem.delivery_code = expressItem.code;\n                if (this.formItem.express_record_type === '2') {\n                    this.expressTemp = [];\n                    this.formItem.express_temp_id = '';\n                    orderExpressTemp({\n                        com: this.formItem.delivery_code\n                    }).then(res => {\n                        this.expressTemp = res.data;\n                        if(!res.data.length){\n                            this.$Message.error('请配置你所选快递公司的电子面单');\n                        }\n                    }).catch(err => {\n                        this.$Message.error(err.msg);\n                    });\n                }\n            },\n            getDeliveryList () {\n                orderDeliveryList().then(res => {\n                    this.deliveryList = res.data.list;\n                }).catch(err => {\n                    this.$Message.error(err.msg);\n                });\n            },\n            getSheetInfo () {\n                orderSheetInfo().then(res => {\n                    const data = res.data;\n                    for (const key in data) {\n                        if (data.hasOwnProperty(key)) {\n                            this.formItem[key] = data[key];\n                        }\n                    }\n                    this.export_open = data.export_open === undefined ? true : data.export_open;\n                    if (!this.export_open) {\n                      this.formItem.express_record_type = '1';\n                    }\n                    this.formItem.to_addr = data.to_add;\n                    // if (this.formItem.express_record_type === '2') {\n                    //   let express = this.express.find(item => {\n                    //     if (item.id === parseInt(data.id)) {\n                    //       return item;\n                    //     }\n                    //   });\n                    //   this.formItem.delivery_name = express?express.value || '':'';\n                    //   if (this.formItem.delivery_name) {\n                    //     orderExpressTemp({\n                    //       com: express.code\n                    //     }).then(res => {\n                    //       this.expressTemp = res.data;\n                    //       let expressTemp = this.expressTemp.find(item => {\n                    //         if (item.id === parseInt(data.express_temp_id)) {\n                    //           return item;\n                    //         }\n                    //       });\n                    //       this.formItem.express_temp_id = expressTemp.id || 0;\n                    //     }).catch(err => {\n                    //     });\n                    //   }\n                    // }\n\n                }).catch(err => {\n                    this.$Message.error(err.msg);\n                });\n            },\n            shDeliveryChange (value) {\n                let deliveryItem = this.deliveryList.find(item => {\n                    return item.id === value;\n                });\n                this.formItem.sh_delivery_name = deliveryItem.nickname;\n                this.formItem.sh_delivery_id = deliveryItem.phone;\n                this.formItem.sh_delivery_uid = deliveryItem.uid;\n            },\n            expressTempChange (tempId) {\n                this.temp = this.expressTemp.find(item => {\n                    return tempId === item.temp_id;\n                });\n            },\n            preview () {\n                this.$refs.viewer.$viewer.show();\n            }\n        }\n    }\n</script>\n\n<style scoped>\n    .express_temp_id {\n        position: relative;\n    }\n\n    .express_temp_id button {\n        position: absolute;\n        top: 50%;\n        right: 110px;\n        padding: 0;\n        border: none;\n        background: none;\n        transform: translateY(-50%);\n        color: #57a3f3;\n    }\n\n    .ivu-btn-text:focus {\n        box-shadow: none;\n    }\n</style>\n"]}]}