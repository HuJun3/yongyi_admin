{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/pages/system/maintain/systemFile/opendir.vue?vue&type=style&index=0&id=c61d0132&scoped=true&lang=stylus&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/pages/system/maintain/systemFile/opendir.vue","mtime":1619614846000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5tdDIwCiAgICA+Pj4uaXZ1LWljb24taW9zLWZvbGRlci1vdXRsaW5lCiAgICAgICBmb250LXNpemUgMTRweCAhaW1wb3J0YW50CiAgICA+Pj4gLml2dS1pY29uLWlvcy1kb2N1bWVudC1vdXRsaW5lCiAgICAgICBmb250LXNpemUgMThweCAhaW1wb3J0YW50CiAgICA+Pj4gLml2dS10YWJsZS1yb3cKICAgICAgIGN1cnNvciBwb2ludGVyCi5tcjUKICAgbWFyZ2luLXJpZ2h0IDVweAouYmFja3MKICAgY3Vyc29yIHBvaW50ZXIKICAgZGlzcGxheSBpbmxpbmUtYmxvY2sKCg=="},{"version":3,"sources":["opendir.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"opendir.vue","sourceRoot":"src/pages/system/maintain/systemFile","sourcesContent":["<template>\n    <div>\n        <div class=\"i-layout-page-header\">\n          <div class=\"i-layout-page-header\">\n            <span class=\"ivu-page-header-title\">{{$route.meta.title}}</span>\n          </div>\n        </div>\n        <Card :bordered=\"false\" dis-hover class=\"ivu-mt\">\n            <div class=\"backs\" @click=\"goBack\">\n                <Icon type=\"ios-folder-outline\" class=\"mr5\"/><span>返回上级</span>\n            </div>\n            <Table ref=\"selection\" :columns=\"columns4\" :data=\"tabList\" :loading=\"loading\"\n                   no-data-text=\"暂无数据\" highlight-row class=\"mt20\" @on-current-change=\"currentChange\"\n                   no-filtered-data-text=\"暂无筛选结果\">\n                <template slot-scope=\"{ row }\" slot=\"filename\">\n                    <Icon type=\"ios-folder-outline\" v-if=\"row.isDir\" class=\"mr5\"/>\n                    <Icon type=\"ios-document-outline\" v-else class=\"mr5\"/>\n                    <span>{{row.filename}}</span>\n                </template>\n                <template slot-scope=\"{ row }\" slot=\"isWritable\">\n                    <span v-text=\"row.isWritable?'是':'否'\"></span>\n                </template>\n                <template slot-scope=\"{ row, index }\" slot=\"action\">\n                    <a @click=\"open(row)\"   v-if=\"row.isDir\">打开</a>\n                    <a @click=\"edit(row)\"   v-else>编辑</a>\n                </template>\n            </Table>\n        </Card>\n        <Modal v-model=\"modals\"  scrollable  footer-hide closable :title=\"title\" :mask-closable=\"false\"  width=\"900\">\n            <Button type=\"primary\" id=\"savefile\" class=\"mr5 mb15\" @click=\"savefile\">保存</Button>\n            <Button id=\"undo\" class=\"mr5 mb15\" @click=\"undofile\">撤销</Button>\n<!--            <Button id=\"redo\" class=\"mr5 mb15\" @click=\"redofile\">回退</Button>-->\n<!--            <Button id=\"refresh\" class=\"mb15\" @click=\"refreshfile\">刷新</Button>-->\n            <textarea ref=\"mycode\" class=\"codesql public_text\" v-model=\"code\"></textarea>\n            <Spin size=\"large\" fix v-if=\"spinShow\"></Spin>\n        </Modal>\n    </div>\n</template>\n\n<script>\n    import { opendirListApi, openfileApi, savefileApi } from '@/api/system'\n    import CodeMirror from 'codemirror/lib/codemirror'\n    import 'codemirror/theme/ambiance.css'\n    require('codemirror/mode/javascript/javascript')\n    export default {\n        name: 'opendir',\n        data () {\n            return {\n                code: '',\n                modals: false,\n                spinShow: false,\n                loading: false,\n                tabList: [],\n                columns4: [\n                    {\n                        title: '文件/文件夹名',\n                        slot: 'filename',\n                        minWidth: 150,\n                        back: '返回上级'\n                    },\n                    {\n                        title: '文件/文件夹路径',\n                        key: 'real_path',\n                        minWidth: 150\n                    },\n                    {\n                        title: '文件/文件夹大小',\n                        key: 'size',\n                        minWidth: 100\n                    },\n                    {\n                        title: '是否可写',\n                        slot: 'isWritable',\n                        minWidth: 100\n                    },\n                    {\n                        title: '更新时间',\n                        key: 'mtime',\n                        minWidth: 150\n                    },\n                    {\n                        title: 'Action',\n                        slot: 'action',\n                        minWidth: 150\n                    }\n                ],\n                formItem: {\n                    dir: '',\n                    superior: 0,\n                    filedir: ''\n                },\n                rows: {},\n                pathname: '',\n                title: ''\n            }\n        },\n        mounted () {\n            this.editor = CodeMirror.fromTextArea(this.$refs.mycode, {\n                value: 'http://www.csyongyi.com', // 文本域默认显示的文本\n                mode: 'text/javascript',\n                theme: 'ambiance', // CSS样式选择\n                indentUnit: 4, // 缩进单位，默认2\n                smartIndent: true, // 是否智能缩进\n                tabSize: 4, // Tab缩进，默认4\n                readOnly: false, // 是否只读，默认false\n                showCursorWhenSelecting: true,\n                lineNumbers: true // 是否显示行号\n            })\n        },\n        created () {\n            this.getList()\n        },\n        methods: {\n            // 点击行\n            currentChange (currentRow) {\n                if (currentRow.isDir) {\n                    this.open(currentRow)\n                } else {\n                    this.edit(currentRow)\n                }\n                console.log(currentRow)\n            },\n            // 列表\n            getList () {\n                this.loading = true\n                opendirListApi(this.formItem).then(async res => {\n                    let data = res.data\n                    this.tabList = data.list\n                    this.dir = data.dir\n                    this.loading = false\n                }).catch(res => {\n                    this.loading = false\n                    this.$Message.error(res.msg)\n                })\n            },\n            // 返回上级\n            goBack () {\n                this.formItem = {\n                    dir: this.dir,\n                    superior: 1,\n                    filedir: ''\n                }\n                this.getList()\n            },\n            // 打开\n            open (row) {\n                this.rows = row\n                this.formItem = {\n                    dir: row.path,\n                    superior: 0,\n                    filedir: row.filename\n                }\n                this.getList()\n            },\n            // 编辑\n            edit (row) {\n                this.modals = true\n                this.spinShow = true\n                this.pathname = row.pathname\n                this.title = row.filename\n                openfileApi(row.pathname).then(async res => {\n                    let data = res.data\n                    this.code = data.content\n                    this.editor.setValue(this.code)\n                    this.spinShow = false\n                }).catch(res => {\n                    this.spinShow = false\n                    this.$Message.error(res.msg)\n                })\n            },\n            // 保存\n            savefile () {\n                let data = {\n                    comment: this.editor.getValue(),\n                    filepath: this.pathname\n                }\n                savefileApi(data).then(async res => {\n                    this.$Message.success(res.msg)\n                    this.modals = false\n                }).catch(res => {\n                    this.$Message.error(res.msg)\n                })\n            },\n            // 撤销\n            undofile () {\n                this.editor.undo()\n            },\n            redofile () {\n                this.editor.redo()\n            },\n            // 刷新\n            refreshfile () {\n                this.editor.refresh()\n            }\n        }\n    }\n</script>\n\n<style scoped lang=\"stylus\">\n    .mt20\n        >>>.ivu-icon-ios-folder-outline\n           font-size 14px !important\n        >>> .ivu-icon-ios-document-outline\n           font-size 18px !important\n        >>> .ivu-table-row\n           cursor pointer\n    .mr5\n       margin-right 5px\n    .backs\n       cursor pointer\n       display inline-block\n\n</style>\n"]}]}