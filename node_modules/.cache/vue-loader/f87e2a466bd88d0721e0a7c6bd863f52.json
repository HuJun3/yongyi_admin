{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/pages/finance/financialRecords/recharge/index.vue?vue&type=style&index=0&id=b3a28392&scoped=true&lang=stylus&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/pages/finance/financialRecords/recharge/index.vue","mtime":1610587844000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5pdnUtbXQgLnR5cGUgLml0ZW0KICAgIG1hcmdpbjozcHggMDsKLnRhYmZvcm0KICAgIG1hcmdpbi1ib3R0b20gMTBweAouUmVmcmVzaAogICAgZm9udC1zaXplIDEycHgKICAgIGNvbG9yICMxODkwRkYKICAgIGN1cnNvciBwb2ludGVyCi5pdnUtZm9ybS1pdGVtCiAgICBtYXJnaW4tYm90dG9tIDEwcHgKLnN0YXR1cyA+Pj4gLml0ZW1+Lml0ZW0KICAgIG1hcmdpbi1sZWZ0IDZweAouc3RhdHVzID4+PiAuc3RhdHVzVmFsCiAgICBtYXJnaW4tYm90dG9tIDdweAovKi5pdnUtbXQgPj4+IC5pdnUtdGFibGUtaGVhZGVyKi8KLyogICAgYm9yZGVyLXRvcDoxcHggZGFzaGVkICNkZGQhaW1wb3J0YW50Ki8K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/finance/financialRecords/recharge","sourcesContent":["<template>\n    <div>\n        <div class=\"i-layout-page-header\">\n            <div class=\"i-layout-page-header\">\n                <span class=\"ivu-page-header-title\">{{ $route.meta.title }}</span>\n            </div>\n        </div>\n        <Card :bordered=\"false\" dis-hover class=\"ivu-mt\">\n            <Form\n                ref=\"formValidate\"\n                :model=\"formValidate\"\n                :label-width=\"labelWidth\"\n                :label-position=\"labelPosition\"\n                class=\"tabform\"\n                @submit.native.prevent\n            >\n                <Row :gutter=\"24\" type=\"flex\" justify=\"end\">\n                    <Col span=\"24\" class=\"ivu-text-left\">\n                        <FormItem label=\"时间选择：\">\n                            <RadioGroup\n                                v-model=\"formValidate.data\"\n                                type=\"button\"\n                                @on-change=\"selectChange(formValidate.data)\"\n                                class=\"mr\"\n                            >\n                                <Radio\n                                    :label=\"item.val\"\n                                    v-for=\"(item, i) in fromList.fromTxt\"\n                                    :key=\"i\"\n                                    >{{ item.text }}</Radio\n                                >\n                            </RadioGroup>\n                            <DatePicker\n                                :editable=\"false\"\n                                @on-change=\"onchangeTime\"\n                                :value=\"timeVal\"\n                                format=\"yyyy/MM/dd\"\n                                type=\"daterange\"\n                                placement=\"bottom-end\"\n                                placeholder=\"自定义时间\"\n                                style=\"width: 200px;\"\n                            ></DatePicker>\n                        </FormItem>\n                    </Col>\n                    <Col span=\"24\" class=\"ivu-text-left\">\n                        <FormItem label=\"支付类型：\">\n                            <RadioGroup\n                                v-model=\"formValidate.paid\"\n                                type=\"button\"\n                                @on-change=\"selChange\"\n                            >\n                                <Radio label=\"\">全部</Radio>\n                                <Radio label=\"1\">已支付</Radio>\n                                <Radio label=\"0\">未支付</Radio>\n                            </RadioGroup>\n                        </FormItem>\n                    </Col>\n                    <Col span=\"24\" class=\"ivu-text-left\">\n                        <FormItem label=\"搜索：\">\n                            <Input\n                                search\n                                enter-button\n                                @on-search=\"selChange\"\n                                placeholder=\"请输入用户昵称、订单号\"\n                                element-id=\"name\"\n                                v-model=\"formValidate.nickname\"\n                                style=\"width: 30%;display: inline-table;\"\n                                class=\"mr\"\n                            />\n                            <Button\n                                v-auth=\"['export-userRecharge']\"\n                                class=\"mr\"\n                                icon=\"ios-share-outline\"\n                                @click=\"exports\"\n                                >导出</Button\n                            >\n                            <!--                            <span class=\"Refresh\">刷新</span><Icon type=\"ios-refresh\" />-->\n                        </FormItem>\n                    </Col>\n                </Row>\n            </Form>\n        </Card>\n        <cards-data :cardLists=\"cardLists\" v-if=\"cardLists.length >= 0\"></cards-data>\n        <Card :bordered=\"false\" dis-hover>\n            <div>充值记录列表</div>\n            <Table\n                ref=\"table\"\n                :columns=\"columns\"\n                :data=\"tabList\"\n                class=\"ivu-mt\"\n                :loading=\"loading\"\n                no-data-text=\"暂无数据\"\n                no-filtered-data-text=\"暂无筛选结果\"\n            >\n                <template slot-scope=\"{ row, index }\" slot=\"right\">\n                    <a\n                        href=\"javascript:void(0);\"\n                        v-if=\"row.refund_price <= 0 && row.paid\"\n                        @click=\"refund(row)\"\n                        >退款</a\n                    >\n                    <!--                    <Divider type=\"vertical\"  v-if=\"row.paid\"/>-->\n                    <a\n                        href=\"javascript:void(0);\"\n                        v-if=\"row.paid === 0\"\n                        @click=\"del(row, '此条充值记录', index)\"\n                        >删除</a\n                    >\n                </template>\n            </Table>\n            <div class=\"acea-row row-right page\">\n                <Page\n                    :total=\"total\"\n                    :current=\"formValidate.page\"\n                    show-elevator\n                    show-total\n                    @on-change=\"pageChange\"\n                    :page-size=\"formValidate.limit\"\n                />\n            </div>\n        </Card>\n        <!-- 退款表单-->\n        <edit-from ref=\"edits\" :FromData=\"FromData\" @submitFail=\"submitFail\"></edit-from>\n    </div>\n</template>\n<script>\nimport cardsData from \"@/components/cards/cards\";\nimport searchFrom from \"@/components/publicSearchFrom\";\nimport { mapState } from \"vuex\";\nimport {\n    rechargelistApi,\n    userRechargeApi,\n    refundEditApi,\n    exportUserRechargeApi\n} from \"@/api/finance\";\nimport editFrom from \"@/components/from/from\";\nexport default {\n    name: \"recharge\",\n    components: { cardsData, searchFrom, editFrom },\n    data() {\n        return {\n            FromData: null,\n            formValidate: {\n                data: \"\",\n                paid: \"\",\n                nickname: \"\",\n                excel: 0,\n                page: 1,\n                limit: 20\n            },\n            formValidate2: {\n                data: \"\",\n                paid: \"\",\n                nickname: \"\"\n            },\n            total: 0,\n            cardLists: [],\n            loading: false,\n            columns: [\n                {\n                    title: \"ID\",\n                    key: \"id\",\n                    sortable: true,\n                    width: 80\n                },\n                {\n                    title: \"头像\",\n                    key: \"avatar\",\n                    minWidth: 80,\n                    render: (h, params) => {\n                        return h(\"viewer\", [\n                            h(\n                                \"div\",\n                                {\n                                    style: {\n                                        width: \"36px\",\n                                        height: \"36px\",\n                                        borderRadius: \"4px\",\n                                        cursor: \"pointer\"\n                                    }\n                                },\n                                [\n                                    h(\"img\", {\n                                        attrs: {\n                                            src: params.row.avatar\n                                                ? params.row.avatar\n                                                : require(\"../../../../assets/images/moren.jpg\")\n                                        },\n                                        style: {\n                                            width: \"100%\",\n                                            height: \"100%\"\n                                        }\n                                    })\n                                ]\n                            )\n                        ]);\n                    }\n                },\n                {\n                    title: \"用户昵称\",\n                    key: \"nickname\",\n                    minWidth: 150\n                },\n                {\n                    title: \"订单号\",\n                    key: \"order_id\",\n                    minWidth: 150\n                },\n                {\n                    title: \"支付金额\",\n                    key: \"price\",\n                    minWidth: 110\n                },\n                {\n                    title: \"是否支付\",\n                    key: \"paid_type\",\n                    minWidth: 110\n                },\n                {\n                    title: \"充值类型\",\n                    key: \"_recharge_type\",\n                    minWidth: 100\n                },\n                {\n                    title: \"支付时间\",\n                    key: \"_pay_time\",\n                    minWidth: 120\n                },\n                {\n                    title: \"操作\",\n                    slot: \"right\",\n                    fixed: \"right\",\n                    minWidth: 100\n                }\n            ],\n            tabList: [],\n            fromList: {\n                title: \"选择时间\",\n                custom: true,\n                fromTxt: [\n                    { text: \"全部\", val: \"\" },\n                    { text: \"今天\", val: \"today\" },\n                    { text: \"昨天\", val: \"yesterday\" },\n                    { text: \"最近7天\", val: \"lately7\" },\n                    { text: \"最近30天\", val: \"lately30\" },\n                    { text: \"本月\", val: \"month\" },\n                    { text: \"本年\", val: \"year\" }\n                ]\n            },\n            timeVal: []\n        };\n    },\n    computed: {\n        ...mapState(\"media\", [\"isMobile\"]),\n        labelWidth() {\n            return this.isMobile ? undefined : 80;\n        },\n        labelPosition() {\n            return this.isMobile ? \"top\" : \"right\";\n        }\n    },\n    mounted() {\n        this.getList();\n        this.getUserRecharge();\n    },\n    methods: {\n        // 删除\n        del(row, tit, num) {\n            let delfromData = {\n                title: tit,\n                num: num,\n                url: `finance/recharge/${row.id}`,\n                method: \"DELETE\",\n                ids: \"\"\n            };\n            this.$modalSure(delfromData)\n                .then(res => {\n                    this.$Message.success(res.msg);\n                    this.tabList.splice(this.delfromData.num, 1);\n                })\n                .catch(res => {\n                    this.$Message.error(res.msg);\n                });\n        },\n        // 退款\n        refund(row) {\n            refundEditApi(row.id)\n                .then(async res => {\n                    if (res.data.status === false) {\n                        return this.$authLapse(res.data);\n                    }\n                    this.FromData = res.data;\n                    this.$refs.edits.modals = true;\n                })\n                .catch(res => {\n                    this.$Message.error(res.msg);\n                });\n        },\n        // 编辑提交成功\n        submitFail() {\n            this.getList();\n            this.getUserRecharge();\n        },\n        // 具体日期\n        onchangeTime(e) {\n            this.timeVal = e;\n            this.formValidate.data = this.timeVal.join(\"-\");\n            this.formValidate.page = 1;\n            this.getList();\n            this.getUserRecharge();\n        },\n        // 选择时间\n        selectChange(tab) {\n            this.formValidate.data = tab;\n            this.timeVal = [];\n            this.formValidate.page = 1;\n            this.getList();\n            this.getUserRecharge();\n        },\n        // 选择\n        selChange(x) {\n            this.formValidate.page = 1;\n            this.getList();\n            this.getUserRecharge();\n        },\n        // 列表\n        getList() {\n            this.loading = true;\n            rechargelistApi(this.formValidate)\n                .then(async res => {\n                    let data = res.data;\n                    this.tabList = data.list;\n                    this.total = data.count;\n                    this.loading = false;\n                })\n                .catch(res => {\n                    this.loading = false;\n                    this.$Message.error(res.msg);\n                });\n        },\n        pageChange(index) {\n            this.formValidate.page = index;\n            this.getList();\n        },\n        // 小方块\n        getUserRecharge() {\n            userRechargeApi({\n                data: this.formValidate.data,\n                paid: this.formValidate.paid,\n                nickname: this.formValidate.nickname\n            })\n                .then(async res => {\n                    let data = res.data;\n                    this.cardLists = data;\n                })\n                .catch(res => {\n                    this.$Message.error(res.msg);\n                });\n        },\n        // 导出\n        exports() {\n            let formValidate = this.formValidate;\n            let data = {\n                data: formValidate.data,\n                paid: formValidate.paid,\n                nickname: formValidate.nickname\n            };\n            exportUserRechargeApi(data)\n                .then(res => {\n                    location.href = res.data[0];\n                })\n                .catch(res => {\n                    this.$Message.error(res.msg);\n                });\n        }\n    }\n};\n</script>\n<style scoped lang=\"stylus\">\n.ivu-mt .type .item\n    margin:3px 0;\n.tabform\n    margin-bottom 10px\n.Refresh\n    font-size 12px\n    color #1890FF\n    cursor pointer\n.ivu-form-item\n    margin-bottom 10px\n.status >>> .item~.item\n    margin-left 6px\n.status >>> .statusVal\n    margin-bottom 7px\n/*.ivu-mt >>> .ivu-table-header*/\n/*    border-top:1px dashed #ddd!important*/\n</style>\n"]}]}