{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/pages/account/login/index.vue?vue&type=style&index=0&id=69bbf5f6&scoped=true&lang=stylus&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/pages/account/login/index.vue","mtime":1610587844000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoucGFnZS1hY2NvdW50IHsKICBkaXNwbGF5OiBmbGV4OwogIHdpZHRoOiAxMDAlOwogIGJhY2tncm91bmQtaW1hZ2U6IHVybCgnLi4vLi4vLi4vYXNzZXRzL2ltYWdlcy9iZy5qcGcnKTsKICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyOwogIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjsKICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgaGVpZ2h0OiAxMDB2aDsKICBvdmVyZmxvdzogYXV0bzsKfQoucGFnZS1hY2NvdW50IC5jb2RlIHsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7Cn0KCi5wYWdlLWFjY291bnQgLmNvZGUgLnBpY3RydWUgewogICAgaGVpZ2h0OiA0MHB4Owp9Cgouc3dpcGVyUHJvc3MgewogICAgYm9yZGVyLXJhZGl1czogNnB4IDBweCAwcHggNnB4Owp9Cgouc3dpcGVyUHJvc3MsIC5zd2lwZXJQaWMsIC5zd2lwZXJQaWMgaW1nIHsKICAgIHdpZHRoOiA1MTBweDsKICAgIGhlaWdodDogMTAwJTsKfQoKLnN3aXBlclBpYyBpbWcgewogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7Cn0KCi5jb250YWluZXIgewogIGhlaWdodDogNDAwcHghaW1wb3J0YW50OwogIHBhZGRpbmc6IDAhaW1wb3J0YW50OwogIGJvcmRlci1yYWRpdXM6IDZweDsKICB6LWluZGV4OiAxOwogIGRpc3BsYXk6IGZsZXg7Cn0KCi5jb250YWluZXJTYW1sbCB7CiAgICAvKndpZHRoOiA1NiUgIWltcG9ydGFudDsqLwogICAgYmFja2dyb3VuZDogI2ZmZiAhaW1wb3J0YW50Owp9CgouY29udGFpbmVyQmlnIHsKICAgIHdpZHRoOiBhdXRvICFpbXBvcnRhbnQ7CiAgICBiYWNrZ3JvdW5kOiAjZjdmN2Y3ICFpbXBvcnRhbnQ7Cn0KCi5pbmRleF9mcm9tIHsKICAgIHBhZGRpbmc6IDAgNDBweCAzMnB4IDQwcHg7CiAgICBoZWlnaHQ6IDQwMHB4OwogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKfQoKLnBhZ2UtYWNjb3VudC10b3AgewogICAgcGFkZGluZzogMjBweCAwICFpbXBvcnRhbnQ7CiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94ICFpbXBvcnRhbnQ7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7Cn0KCi5wYWdlLWFjY291bnQtY29udGFpbmVyIHsKICAgIGJvcmRlci1yYWRpdXM6IDBweCA2cHggNnB4IDBweDsKfQoKLmJ0biB7CiAgICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoOTBkZWcsIHJnYmEoMjUsIDE4MCwgMjQxLCAxKSAwJSwgcmdiYSgxNCwgMTE1LCAyMzIsIDEpIDEwMCUpICFpbXBvcnRhbnQ7Cn0KCi5jYXB0Y2hhQm94IHsKICAgIHdpZHRoOiAzMTBweDsKfQoKaW5wdXQgewogICAgZGlzcGxheTogYmxvY2s7CiAgICB3aWR0aDogMjkwcHg7CiAgICBsaW5lLWhlaWdodDogNDBweDsKICAgIG1hcmdpbjogMTBweCAwOwogICAgcGFkZGluZzogMCAxMHB4OwogICAgb3V0bGluZTogbm9uZTsKICAgIGJvcmRlcjogMXB4IHNvbGlkICNjOGNjY2Y7CiAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICBjb2xvcjogIzZhNmY3NzsKfQoKI21zZyB7CiAgICB3aWR0aDogMTAwJTsKICAgIGxpbmUtaGVpZ2h0OiA0MHB4OwogICAgZm9udC1zaXplOiAxNHB4OwogICAgdGV4dC1hbGlnbjogY2VudGVyOwp9CgphOmxpbmssIGE6dmlzaXRlZCwgYTpob3ZlciwgYTphY3RpdmUgewogICAgbWFyZ2luLWxlZnQ6IDEwMHB4OwogICAgY29sb3I6ICMwMzY2RDY7Cn0KCi5pbmRleF9mcm9tID4+PiAuaXZ1LWlucHV0LWxhcmdlCiAgICBmb250LXNpemU6MTRweCFpbXBvcnRhbnQKCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA","file":"index.vue","sourceRoot":"src/pages/account/login","sourcesContent":["<template>\n    <div class=\"page-account\">\n        <div class=\"container\" :class=\"[ fullWidth > 768 ? 'containerSamll':'containerBig']\">\n            <swiper :options=\"swiperOption\" class=\"swiperPross\" v-if=\"fullWidth>768\">\n                <swiper-slide class=\"swiperPic\" v-for=\"(item,index) in swiperList\" :key=\"index\">\n                    <img :src=\"item.slide\">\n                </swiper-slide>\n                <div class=\"swiper-pagination\" slot=\"pagination\"></div>\n            </swiper>\n            <div class=\"index_from page-account-container\">\n                <div class=\"page-account-top \">\n                    <div class=\"page-account-top-logo\">\n                        <img :src=\"login_logo\" alt=\"logo\" style=\"width:271px;height:74px;\">\n                    </div>\n                </div>\n                <Form ref=\"formInline\" :model=\"formInline\" :rules=\"ruleInline\"\n                      @keyup.enter=\"handleSubmit('formInline')\">\n                    <FormItem prop=\"username\">\n                        <Input type=\"text\" v-model=\"formInline.username\" prefix=\"ios-contact-outline\"\n                               placeholder=\"请输入用户名\" size=\"large\"/>\n                    </FormItem>\n                    <FormItem prop=\"password\">\n                        <Input type=\"password\" v-model=\"formInline.password\" prefix=\"ios-lock-outline\"\n                               placeholder=\"请输入密码\" size=\"large\"/>\n                    </FormItem>\n                    <FormItem prop=\"code\">\n                        <div class=\"code\">\n                            <Input type=\"text\" v-model=\"formInline.code\" prefix=\"ios-keypad-outline\"\n                                   placeholder=\"请输入验证码\" size=\"large\"/>\n                            <img :src=\"imgcode\" class=\"pictrue\" @click=\"captchas\"/>\n                        </div>\n                    </FormItem>\n                    <FormItem>\n                        <Button type=\"primary\" long size=\"large\" @click=\"handleSubmit('formInline')\" class=\"btn\">登录</Button>\n                    </FormItem>\n                </Form>\n            </div>\n        </div>\n        <Modal v-model=\"modals\" scrollable footer-hide closable title=\"请完成安全校验\" :mask-closable=\"false\" :z-index=\"2\"\n               width=\"342\">\n            <div class=\"captchaBox\">\n                <div id=\"captcha\" style=\"position: relative\" ref=\"captcha\"></div>\n                <div id=\"msg\"></div>\n            </div>\n        </Modal>\n    </div>\n</template>\n<script>\n    import { AccountLogin, loginInfoApi } from '@/api/account'\n    // import mixins from '../mixins'\n    import Setting from '@/setting'\n    import { setCookies } from '@/libs/util'\n    import '../../../assets/js/canvas-nest.min'\n    import '../../../assets/js/jigsaw.js'\n    export default {\n        // mixins: [mixins],\n        data () {\n            return {\n                fullWidth: document.documentElement.clientWidth,\n                swiperOption: {\n                    pagination: '.swiper-pagination',\n                    autoplay: true\n                },\n                modals: false,\n                autoLogin: true,\n                imgcode: '',\n                formInline: {\n                    username: '',\n                    password: '',\n                    code: ''\n                },\n                ruleInline: {\n                    username: [\n                        { required: true, message: '请输入用户名', trigger: 'blur' }\n                    ],\n                    password: [\n                        { required: true, message: '请输入密码', trigger: 'blur' }\n                    ],\n                    code: [\n                        { required: true, message: '请输入验证码', trigger: 'blur' }\n                    ]\n                },\n                errorNum: 0,\n                jigsaw: null,\n                login_logo: '',\n                swiperList: [],\n                defaultSwiperList: require('@/assets/images/sw.jpg')\n            }\n        },\n        created () {\n            var _this = this\n            top != window && (top.location.href = location.href)\n            document.onkeydown = function (e) {\n                if (_this.$route.name === 'login') {\n                    let key = window.event.keyCode\n                    if (key === 13) {\n                        _this.handleSubmit('formInline')\n                    }\n                }\n            }\n            window.addEventListener('resize', this.handleResize)\n        },\n        watch: {\n            fullWidth (val) {\n                // 为了避免频繁触发resize函数导致页面卡顿，使用定时器\n                if (!this.timer) {\n                    // 一旦监听到的screenWidth值改变，就将其重新赋给data里的screenWidth\n                    this.screenWidth = val\n                    this.timer = true\n                    let that = this\n                    setTimeout(function () {\n                        // 打印screenWidth变化的值\n                        that.timer = false\n                    }, 400)\n                }\n            },\n            $route (n) {\n                console.log(n)\n                this.captchas()\n            }\n        },\n        mounted: function () {\n            this.$nextTick(() => {\n                // /* eslint-disable */\n                let that = this\n                this.jigsaw = jigsaw.init({\n                    el: this.$refs.captcha,\n                    onSuccess () {\n                        that.modals = false\n                        that.closeModel()\n                    },\n                    onFail: this.closefail,\n                    onRefresh () {\n                    }\n                })\n                if (this.screenWidth < 768) {\n                    document.getElementsByTagName('canvas')[0].removeAttribute('class', 'index_bg')\n                } else {\n                    document.getElementsByTagName('canvas')[0].className = 'index_bg'\n                }\n                this.swiperData()\n            })\n            this.captchas()\n        },\n        methods: {\n            swiperData () {\n                loginInfoApi().then(res => {\n                    let data = res.data || {}\n                    this.login_logo = data.login_logo ? data.login_logo : require('@/assets/images/logo.png')\n                    this.swiperList = data.slide.length ? data.slide : [{ slide: this.defaultSwiperList }]\n                }).catch(err => {\n                    this.$Message.error(err)\n                  this.login_logo = require('@/assets/images/logo.png')\n                  this.swiperList =  [{ slide: this.defaultSwiperList }]\n                })\n            },\n            // 关闭模态框\n            closeModel () {\n                let msg = this.$Message.loading({\n                    content: '登录中...',\n                    duration: 0\n                })\n                AccountLogin({\n                    account: this.formInline.username,\n                    pwd: this.formInline.password,\n                    imgcode: this.formInline.code\n                }).then(async res => {\n                    msg()\n                    console.log('已登陆')\n                    let data = res.data\n                    let expires = this.getExpiresTime(data.expires_time)\n                    // 记录用户登陆信息\n                    setCookies('uuid', data.user_info.id, expires)\n                    setCookies('token', data.token, expires)\n                    setCookies('expires_time', data.expires_time, expires)\n\n                    this.$store.commit('userInfo/uniqueAuth', data.unique_auth)\n                    this.$store.commit('userInfo/userInfo', data.user_info)\n                    // 保存菜单信息\n                    this.$store.commit('menus/setopenMenus', [])\n                    this.$store.commit('menus/getmenusNav', data.menus)\n\n                    // 记录用户信息\n                    this.$store.commit('userInfo/name', data.user_info.account)\n                    this.$store.commit('userInfo/avatar', data.user_info.head_pic)\n                    this.$store.commit('userInfo/access', data.unique_auth)\n                    this.$store.commit('userInfo/logo', data.logo)\n                    this.$store.commit('userInfo/logoSmall', data.logo_square)\n                    this.$store.commit('userInfo/version', data.version)\n                    this.$store.commit('userInfo/newOrderAudioLink', data.newOrderAudioLink)\n\n                    if (this.jigsaw) this.jigsaw.reset()\n                    return this.$router.replace({ path: '/admin/home/' || '/admin/' })\n                }).catch(res => {\n                    msg()\n                    let data = res === undefined ? {} : res\n                    this.errorNum++\n                    this.captchas()\n                    this.$Message.error(data.msg || '登录失败')\n                    if (this.jigsaw) this.jigsaw.reset()\n                })\n            },\n            getExpiresTime (expiresTime) {\n                let nowTimeNum = Math.round(new Date() / 1000)\n                let expiresTimeNum = expiresTime - nowTimeNum\n                return parseFloat(parseFloat(parseFloat(expiresTimeNum / 60) / 60) / 24)\n            },\n            closefail () {\n                if (this.jigsaw) this.jigsaw.reset()\n                this.$Message.error('校验错误')\n            },\n            handleResize (event) {\n                this.fullWidth = document.documentElement.clientWidth\n                if (this.fullWidth < 768) {\n                    document.getElementsByTagName('canvas')[0].removeAttribute('class', 'index_bg')\n                } else {\n                    document.getElementsByTagName('canvas')[0].className = 'index_bg'\n                }\n            },\n            captchas: function () {\n                this.imgcode = Setting.apiBaseURL + '/captcha_pro?' + Date.parse(new Date())\n            },\n            handleSubmit (name) {\n                this.$refs[name].validate((valid) => {\n                    if (valid) {\n                        if (this.errorNum >= 2) {\n                            this.modals = true\n                        } else {\n                            this.closeModel()\n                        }\n                    }\n                })\n            }\n        },\n        beforeCreate () {\n            if (this.fullWidth < 768) {\n                document.getElementsByTagName('canvas')[0].removeAttribute('class', 'index_bg')\n            } else {\n                document.getElementsByTagName('canvas')[0].className = 'index_bg'\n            }\n        },\n        beforeDestroy: function () {\n            window.removeEventListener('resize', this.handleResize)\n            document.getElementsByTagName('canvas')[0].removeAttribute('class', 'index_bg')\n        }\n    }\n</script>\n<style scoped lang=\"stylus\">\n    .page-account {\n      display: flex;\n      width: 100%;\n      background-image: url('../../../assets/images/bg.jpg');\n      background-size: cover;\n      background-position: center;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n      height: 100vh;\n      overflow: auto;\n    }\n    .page-account .code {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n\n    .page-account .code .pictrue {\n        height: 40px;\n    }\n\n    .swiperPross {\n        border-radius: 6px 0px 0px 6px;\n    }\n\n    .swiperPross, .swiperPic, .swiperPic img {\n        width: 510px;\n        height: 100%;\n    }\n\n    .swiperPic img {\n        width: 100%;\n        height: 100%;\n    }\n\n    .container {\n      height: 400px!important;\n      padding: 0!important;\n      border-radius: 6px;\n      z-index: 1;\n      display: flex;\n    }\n\n    .containerSamll {\n        /*width: 56% !important;*/\n        background: #fff !important;\n    }\n\n    .containerBig {\n        width: auto !important;\n        background: #f7f7f7 !important;\n    }\n\n    .index_from {\n        padding: 0 40px 32px 40px;\n        height: 400px;\n        box-sizing: border-box;\n    }\n\n    .page-account-top {\n        padding: 20px 0 !important;\n        box-sizing: border-box !important;\n        display: flex;\n        justify-content: center;\n    }\n\n    .page-account-container {\n        border-radius: 0px 6px 6px 0px;\n    }\n\n    .btn {\n        background: linear-gradient(90deg, rgba(25, 180, 241, 1) 0%, rgba(14, 115, 232, 1) 100%) !important;\n    }\n\n    .captchaBox {\n        width: 310px;\n    }\n\n    input {\n        display: block;\n        width: 290px;\n        line-height: 40px;\n        margin: 10px 0;\n        padding: 0 10px;\n        outline: none;\n        border: 1px solid #c8cccf;\n        border-radius: 4px;\n        color: #6a6f77;\n    }\n\n    #msg {\n        width: 100%;\n        line-height: 40px;\n        font-size: 14px;\n        text-align: center;\n    }\n\n    a:link, a:visited, a:hover, a:active {\n        margin-left: 100px;\n        color: #0366D6;\n    }\n\n    .index_from >>> .ivu-input-large\n        font-size:14px!important\n\n</style>\n"]}]}