{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/pages/setting/setSystem/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/pages/setting/setSystem/index.vue","mtime":1610587844000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBmb3JtQ3JlYXRlIGZyb20gJ0Bmb3JtLWNyZWF0ZS9pdmlldycKaW1wb3J0IHsgaGVhZGVyTGlzdEFwaSwgZGF0YUZyb21BcGkgfSBmcm9tICdAL2FwaS9zZXR0aW5nJwppbXBvcnQgcmVxdWVzdCBmcm9tICdAL2xpYnMvcmVxdWVzdCcKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ3NldHRpbmdfc2V0U3lzdGVtJywKICAgIGNvbXBvbmVudHM6IHsgZm9ybUNyZWF0ZTogZm9ybUNyZWF0ZS4kZm9ybSgpIH0sCiAgICBkYXRhICgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBydWxlczogW10sCiAgICAgICAgICAgIG9wdGlvbjogewogICAgICAgICAgICAgICAgZm9ybTogewogICAgICAgICAgICAgICAgICAgIGxhYmVsV2lkdGg6IDE4NQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBzdWJtaXRCdG46ewogICAgICAgICAgICAgICAgICBjb2w6ewogICAgICAgICAgICAgICAgICAgIHNwYW46MywKICAgICAgICAgICAgICAgICAgICBwdXNoOjMKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBnbG9iYWw6IHsKICAgICAgICAgICAgICAgICAgICB1cGxvYWQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgcHJvcHM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU3VjY2VzcyAocmVzLCBmaWxlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLnVybCA9IHJlcy5kYXRhLnNyYwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJE1lc3NhZ2UuZXJyb3IocmVzLm1zZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBmcmFtZTp7CiAgICAgICAgICAgICAgICAgICAgcHJvcHM6ewogICAgICAgICAgICAgICAgICAgICAgY2xvc2VCdG46ZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICBva0J0bjpmYWxzZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBzcGluU2hvdzogZmFsc2UsCiAgICAgICAgICAgIEZyb21EYXRhOiBudWxsLAogICAgICAgICAgICBjdXJyZW50VGFiOiAnJywKICAgICAgICAgICAgaGVhZGVyTGlzdDogW10sCiAgICAgICAgICAgIGhlYWRlckNoaWxkcmVuTGlzdDogW10sCiAgICAgICAgICAgIGNoaWxkcmVuSWQ6ICcnLAogICAgICAgICAgICB0aXRsZTogJycKICAgICAgICB9CiAgICB9LAogICAgY3JlYXRlZCAoKSB7CiAgICAgICAgdGhpcy5nZXRBbGxEYXRhKCkKICAgIH0sCiAgICB3YXRjaDogewogICAgICAgICRyb3V0ZSAodG8sIGZyb20pIHsKICAgICAgICAgICAgdGhpcy5oZWFkZXJDaGlsZHJlbkxpc3QgPSBbXQogICAgICAgICAgICB0aGlzLmdldEFsbERhdGEoKQogICAgICAgIH0sCiAgICAgICAgY2hpbGRyZW5JZCAoKSB7CiAgICAgICAgICAgIHRoaXMuZ2V0RnJvbSgpCiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBjaGlsZHJlbkxpc3QgKCkgewogICAgICAgICAgICBsZXQgdGhhdCA9IHRoaXMKICAgICAgICAgICAgdGhhdC5oZWFkZXJMaXN0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgIGlmIChpdGVtLnZhbHVlLnRvU3RyaW5nKCkgPT09IHRoYXQuY3VycmVudFRhYikgewogICAgICAgICAgICAgICAgICBpZihpdGVtLmNoaWxkcmVuID09PSB1bmRlZmluZWQpewogICAgICAgICAgICAgICAgICAgIHRoYXQuY2hpbGRyZW5JZCA9IGl0ZW0uaWQ7CiAgICAgICAgICAgICAgICAgICAgdGhhdC5oZWFkZXJDaGlsZHJlbkxpc3Q9W107CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhhdC5oZWFkZXJDaGlsZHJlbkxpc3QgPSBpdGVtLmNoaWxkcmVuCiAgICAgICAgICAgICAgICAgICAgdGhhdC5jaGlsZHJlbklkID0gaXRlbS5jaGlsZHJlbi5sZW5ndGggPyBpdGVtLmNoaWxkcmVuWzBdLmlkLnRvU3RyaW5nKCkgOiAnJwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICAvLyDlpLTpg6h0YWIKICAgICAgICBnZXRIZWFkZXIgKCkgewogICAgICAgICAgICB0aGlzLnNwaW5TaG93ID0gdHJ1ZQogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgICAgICAgICAgbGV0IHRhYl9pZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy50YWJfaWQ7CiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiB0aGlzLiRyb3V0ZS5wYXJhbXMudHlwZSA/IHRoaXMuJHJvdXRlLnBhcmFtcy50eXBlIDogMCwKICAgICAgICAgICAgICAgICAgICBwaWQ6IHRhYl9pZCA/IHRhYl9pZCA6IDAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGhlYWRlckxpc3RBcGkoZGF0YSkudGhlbihhc3luYyByZXMgPT4gewogICAgICAgICAgICAgICAgICAgIGxldCBjb25maWcgPSByZXMuZGF0YS5jb25maWdfdGFiCiAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWFkZXJMaXN0ID0gY29uZmlnCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VGFiID0gY29uZmlnWzBdLnZhbHVlLnRvU3RyaW5nKCkKICAgICAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuTGlzdCgpCiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLmN1cnJlbnRUYWIpCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGluU2hvdyA9IGZhbHNlCiAgICAgICAgICAgICAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuc3BpblNob3cgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgIHRoaXMuJE1lc3NhZ2UuZXJyb3IoZXJyKQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIC8vIOihqOWNlQogICAgICAgIGdldEZyb20gKCkgewogICAgICAgICAgICB0aGlzLnNwaW5TaG93ID0gdHJ1ZQogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgICAgICAgICAgbGV0IGlkcyA9ICcnCiAgICAgICAgICAgICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLnR5cGUgPT09ICczJykgewogICAgICAgICAgICAgICAgICAgIGlkcyA9IHRoaXMuJHJvdXRlLnBhcmFtcy50YWJfaWQKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2hpbGRyZW5JZCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZHMgPSB0aGlzLmNoaWxkcmVuSWQKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBpZHMgPSB0aGlzLmN1cnJlbnRUYWIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICB0YWJfaWQ6IE51bWJlcihpZHMpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBsZXQgbG9naXN0aWNzID0gJ2ZyZWlnaHQvY29uZmlnL2VkaXRfYmFzaWNzJyxhZ2VudCA9ICdhZ2VudC9jb25maWcvZWRpdF9iYXNpY3MnLAogICAgICAgICAgICAgICAgICAgIGludGVncmFsID0gJ21hcmtldGluZy9pbnRlZ3JhbF9jb25maWcvZWRpdF9iYXNpY3MnLHNtcyA9ICdzZXJ2ZS9zbXNfY29uZmlnL2VkaXRfYmFzaWNzJywKICAgICAgICAgICAgICAgICAgICBjb25maWcgPSAnc2V0dGluZy9jb25maWcvZWRpdF9iYXNpY3MnOwogICAgICAgICAgICAgICAgbGV0IHVybCA9IHRoaXMuJHJvdXRlLm5hbWUgPT09ICdzZXR0aW5nX2xvZ2lzdGljcyc/bG9naXN0aWNzOnRoaXMuJHJvdXRlLm5hbWUgPT09ICdzZXR0aW5nX2Rpc3RyaWJ1dGlvblNldCc/CiAgICAgICAgICAgICAgICAgICAgYWdlbnQ6dGhpcy4kcm91dGUubmFtZSA9PT0gJ3NldHRpbmdfbWVzc2FnZSc/c21zOnRoaXMuJHJvdXRlLm5hbWUgPT09ICdzZXR0aW5nX3NldFN5c3RlbSc/Y29uZmlnOmludGVncmFsOwogICAgICAgICAgICAgICAgZGF0YUZyb21BcGkoZGF0YSx1cmwpLnRoZW4oYXN5bmMgcmVzID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNwaW5TaG93ID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzID09PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kYXV0aExhcHNlKHJlcy5kYXRhKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0aGlzLkZyb21EYXRhID0gcmVzLmRhdGEKICAgICAgICAgICAgICAgICAgICB0aGlzLnJ1bGVzID0gcmVzLmRhdGEucnVsZXMKICAgICAgICAgICAgICAgICAgICB0aGlzLnRpdGxlID0gcmVzLmRhdGEudGl0bGUKICAgICAgICAgICAgICAgIH0pLmNhdGNoKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGluU2hvdyA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcihyZXMubXNnKQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGFzeW5jIGdldEFsbERhdGEgKCkgewogICAgICAgICAgICBpZiAodGhpcy4kcm91dGUucGFyYW1zLnR5cGUgIT09ICczJykgewogICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5nZXRIZWFkZXIoKQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5oZWFkZXJMaXN0ID0gW10KICAgICAgICAgICAgICAgIHRoaXMuZ2V0RnJvbSgpCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIC8vIOmAieaLqQogICAgICAgIGNoYW5nZVRhYiAoKSB7CiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW5MaXN0KCkKICAgICAgICB9LAogICAgICAgIC8vIOS6jOe6p+mAieaLqQogICAgICAgIGNoYW5nZUNoaWxkcmVuVGFiIChuYW1lKSB7CiAgICAgICAgICAgIHRoaXMuY2hpbGRyZW5JZCA9IG5hbWUKICAgICAgICB9LAogICAgICAgIC8vIOaPkOS6pOihqOWNlSBncm91cAogICAgICAgIG9uU3VibWl0IChmb3JtRGF0YSkgewogICAgICAgICAgICByZXF1ZXN0KHsKICAgICAgICAgICAgICAgIHVybDogdGhpcy5Gcm9tRGF0YS5hY3Rpb24sCiAgICAgICAgICAgICAgICBtZXRob2Q6IHRoaXMuRnJvbURhdGEubWV0aG9kLAogICAgICAgICAgICAgICAgZGF0YTogZm9ybURhdGEKICAgICAgICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgdGhpcy4kTWVzc2FnZS5zdWNjZXNzKHJlcy5tc2cpCiAgICAgICAgICAgIH0pLmNhdGNoKHJlcyA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKHJlcy5tc2cpCiAgICAgICAgICAgIH0pCiAgICAgICAgfQogICAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/setting/setSystem","sourcesContent":["<template>\n    <div class=\"article-manager\">\n        <div class=\"i-layout-page-header\">\n          <div class=\"i-layout-page-header\">\n            <span class=\"ivu-page-header-title\">{{title}}</span>\n            <div>\n              <Tabs v-model=\"currentTab\" @on-click=\"changeTab\">\n                <TabPane :icon=\"item.icon\" :label=\"item.label\" :name=\"item.value.toString()\" v-for=\"(item,index) in headerList\" :key=\"index\"/>\n              </Tabs>\n            </div>\n          </div>\n        </div>\n        <Card :bordered=\"false\" dis-hover class=\"ivu-mt fromBox\">\n            <Tabs type=\"card\" v-model=\"childrenId\" v-if=\"headerChildrenList.length\" @on-click=\"changeChildrenTab\">\n                <TabPane :label=\"item.label\" :name=\"item.id.toString()\" v-for=\"(item,index) in headerChildrenList\" :key=\"index\"></TabPane>\n            </Tabs>\n            <form-create :option=\"option\"  :rule=\"rules\" @on-submit=\"onSubmit\" v-if=\"rules.length!==0\"></form-create>\n            <Spin size=\"large\" fix v-if=\"spinShow\"></Spin>\n        </Card>\n    </div>\n</template>\n\n<script>\n    import formCreate from '@form-create/iview'\n    import { headerListApi, dataFromApi } from '@/api/setting'\n    import request from '@/libs/request'\n    export default {\n        name: 'setting_setSystem',\n        components: { formCreate: formCreate.$form() },\n        data () {\n            return {\n                rules: [],\n                option: {\n                    form: {\n                        labelWidth: 185\n                    },\n                  submitBtn:{\n                      col:{\n                        span:3,\n                        push:3\n                      }\n                  },\n                    global: {\n                        upload: {\n                            props: {\n                                onSuccess (res, file) {\n                                    if (res.status === 200) {\n                                        file.url = res.data.src\n                                    } else {\n                                        this.$Message.error(res.msg)\n                                    }\n                                }\n                            }\n                        },\n                      frame:{\n                        props:{\n                          closeBtn:false,\n                          okBtn:false\n                        }\n                      }\n                    }\n                },\n                spinShow: false,\n                FromData: null,\n                currentTab: '',\n                headerList: [],\n                headerChildrenList: [],\n                childrenId: '',\n                title: ''\n            }\n        },\n        created () {\n            this.getAllData()\n        },\n        watch: {\n            $route (to, from) {\n                this.headerChildrenList = []\n                this.getAllData()\n            },\n            childrenId () {\n                this.getFrom()\n            }\n        },\n        methods: {\n            childrenList () {\n                let that = this\n                that.headerList.forEach(function (item) {\n                    if (item.value.toString() === that.currentTab) {\n                      if(item.children === undefined){\n                        that.childrenId = item.id;\n                        that.headerChildrenList=[];\n                      } else {\n                        that.headerChildrenList = item.children\n                        that.childrenId = item.children.length ? item.children[0].id.toString() : ''\n                      }\n                    }\n                })\n            },\n            // 头部tab\n            getHeader () {\n                this.spinShow = true\n                return new Promise((resolve, reject) => {\n                    let tab_id = this.$route.params.tab_id;\n                    let data = {\n                        type: this.$route.params.type ? this.$route.params.type : 0,\n                        pid: tab_id ? tab_id : 0\n                    }\n                    headerListApi(data).then(async res => {\n                        let config = res.data.config_tab\n                        this.headerList = config\n                        this.currentTab = config[0].value.toString()\n                        this.childrenList()\n                        resolve(this.currentTab)\n                        this.spinShow = false\n                    }).catch(err => {\n                        this.spinShow = false\n                        this.$Message.error(err)\n                    })\n                })\n            },\n            // 表单\n            getFrom () {\n                this.spinShow = true\n                return new Promise((resolve, reject) => {\n                    let ids = ''\n                    if (this.$route.params.type === '3') {\n                        ids = this.$route.params.tab_id\n                    } else {\n                        if (this.childrenId) {\n                            ids = this.childrenId\n                        } else {\n                            ids = this.currentTab\n                        }\n                    }\n                    let data = {\n                        tab_id: Number(ids)\n                    }\n                    let logistics = 'freight/config/edit_basics',agent = 'agent/config/edit_basics',\n                        integral = 'marketing/integral_config/edit_basics',sms = 'serve/sms_config/edit_basics',\n                        config = 'setting/config/edit_basics';\n                    let url = this.$route.name === 'setting_logistics'?logistics:this.$route.name === 'setting_distributionSet'?\n                        agent:this.$route.name === 'setting_message'?sms:this.$route.name === 'setting_setSystem'?config:integral;\n                    dataFromApi(data,url).then(async res => {\n                        this.spinShow = false\n                        if (res.data.status === false) {\n                            return this.$authLapse(res.data)\n                        }\n                        this.FromData = res.data\n                        this.rules = res.data.rules\n                        this.title = res.data.title\n                    }).catch(res => {\n                        this.spinShow = false\n                        this.$Message.error(res.msg)\n                    })\n                })\n            },\n            async getAllData () {\n                if (this.$route.params.type !== '3') {\n                    await this.getHeader()\n                } else {\n                    this.headerList = []\n                    this.getFrom()\n                }\n            },\n            // 选择\n            changeTab () {\n                this.childrenList()\n            },\n            // 二级选择\n            changeChildrenTab (name) {\n                this.childrenId = name\n            },\n            // 提交表单 group\n            onSubmit (formData) {\n                request({\n                    url: this.FromData.action,\n                    method: this.FromData.method,\n                    data: formData\n                }).then(res => {\n                    this.$Message.success(res.msg)\n                }).catch(res => {\n                    this.$Message.error(res.msg)\n                })\n            }\n        }\n    }\n</script>\n\n<style scoped lang=\"stylus\">\n  .ivu-tabs{\n    margin-bottom: 18px;\n  }\n.fromBox{\n    min-height 600px;\n}\n</style>\n"]}]}