{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/components/goodsList/index.vue?vue&type=style&index=0&id=db32e292&scoped=true&lang=stylus&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/components/goodsList/index.vue","mtime":1610587842000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZm9vdGVyCiAgICBtYXJnaW4gMTVweCAwOwoudGFiQm94X2ltZwogICAgd2lkdGggMzZweAogICAgaGVpZ2h0IDM2cHgKICAgIGJvcmRlci1yYWRpdXM6IDRweAogICAgY3Vyc29yIHBvaW50ZXIKICAgIGltZwogICAgICAgIHdpZHRoIDEwMCUKICAgICAgICBoZWlnaHQgMTAwJQoKLnRhYmZvcm0KICAgID4+PiAuaXZ1LWZvcm0taXRlbQogICAgICAgIG1hcmdpbi1ib3R0b20gMTZweCAhaW1wb3J0YW50CgouYnRuCiAgICBtYXJnaW4tdG9wIDIwcHgKICAgIGZsb2F0IHJpZ2h0Ci5nb29kTGlzdAogICAgPj4+IHRhYmxlCiAgICAgICAgd2lkdGggMTAwJSAhaW1wb3J0YW50Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/goodsList","sourcesContent":["<template>\n    <div class=\"goodList\">\n        <Form ref=\"formValidate\" :model=\"formValidate\" :label-width=\"120\" label-position=\"right\"\n              class=\"tabform\">\n            <Row type=\"flex\" :gutter=\"24\">\n                <Col v-bind=\"grid\" v-if=\"!liveStatus\">\n                    <FormItem label=\"商品分类：\" label-for=\"pid\">\n                        <Select v-model=\"formValidate.cate_id\" style=\"width:200px\" clearable @on-change=\"userSearchs\">\n                            <Option v-for=\"item in treeSelect\" :value=\"item.id\" :key=\"item.id\">{{ item.html +\n                                item.cate_name }}\n                            </Option>\n                        </Select>\n                    </FormItem>\n                </Col>\n                <Col v-bind=\"grid\">\n                    <FormItem label=\"商品搜索：\" label-for=\"store_name\">\n                        <Input search enter-button placeholder=\"请输入商品名称,关键字,编号\" v-model=\"formValidate.store_name\"\n                               style=\"width:80%;\" @on-search=\"userSearchs\"/>\n                    </FormItem>\n                </Col>\n            </Row>\n        </Form>\n        <Table ref=\"table\" no-data-text=\"暂无数据\" @on-selection-change=\"changeCheckbox\" no-filtered-data-text=\"暂无筛选结果\" max-height=\"400\" :columns=\"liveStatus == false ? columns4 :columns5\"\n               :data=\"tableList\" :loading=\"loading\">\n            <template slot-scope=\"{ row, index }\" slot=\"image\">\n                <div class=\"tabBox_img\" v-viewer>\n                    <img v-lazy=\"row.image\">\n                </div>\n            </template>\n        </Table>\n        <div class=\"acea-row row-right page\">\n            <Page :total=\"total\" show-elevator show-total @on-change=\"pageChange\"\n                  :page-size=\"formValidate.limit\"/>\n        </div>\n        <div class=\"footer\" slot=\"footer\" v-if=\"many==='many'&& !diy\">\n            <Button type=\"primary\" size=\"large\" :loading=\"modal_loading\" long  @click=\"ok\">提交</Button>\n        </div>\n    </div>\n</template>\n\n<script>\n    import { mapState } from 'vuex'\n    import { treeListApi, changeListApi } from '@/api/product'\n    import { liveGoods } from '@/api/live'\n    export default {\n        name: 'index',\n        props:{\n            is_new:{\n                type:String,\n                default:''\n            },\n            diy:{\n                type:Boolean,\n                default:false\n            },\n            ischeckbox:{\n                type:Boolean,\n                default:false\n            },\n            liveStatus:{\n                type:Boolean,\n                default:false\n            },\n            isLive:{\n                type:Boolean,\n                default: false\n            },\n            datas:{\n                type:Object,\n                default:function () {\n                    return {}\n                }\n            }\n        },\n        data () {\n            return {\n                modal_loading: false,\n                treeSelect: [],\n                formValidate: {\n                    page: 1,\n                    limit: 15,\n                    cate_id: '',\n                    store_name: '',\n                    is_new: this.is_new\n                },\n                total: 0,\n                modals: false,\n                loading: false,\n                grid: {\n                    xl: 10,\n                    lg: 10,\n                    md: 12,\n                    sm: 24,\n                    xs: 24\n                },\n                tableList: [],\n                currentid: 0,\n                productRow: {},\n                columns4: [\n                    {\n                        title: '商品ID',\n                        key: 'id'\n                    },\n                    {\n                        title: '图片',\n                        slot: 'image'\n                    },\n                    {\n                        title: '商品名称',\n                        key: 'store_name',\n                        minWidth: 250\n                    },\n                    {\n                        title: '商品分类',\n                        key: 'cate_name',\n                        minWidth: 150\n                    }\n                ],\n                columns5: [\n                    {\n                        title: '商品ID',\n                        key: 'id'\n                    },\n                    {\n                        title: '图片',\n                        slot: 'image'\n                    },\n                    {\n                        title: '商品名称',\n                        key: 'name',\n                        minWidth: 250\n                    }\n                ],\n                images: [],\n                many: ''\n            }\n        },\n        computed: {\n        },\n        created () {\n            let radio = {\n                width: 60,\n                align: 'center',\n                render: (h, params) => {\n                    let id = params.row.id\n                    let flag = false\n                    if (this.currentid === id) {\n                        flag = true\n                    } else {\n                        flag = false\n                    }\n                    let self = this\n                    return h('div', [\n                        h('Radio', {\n                            props: {\n                                value: flag\n                            },\n                            on: {\n                                'on-change': () => {\n                                    self.currentid = id\n                                    this.productRow = params.row\n                                    this.$emit('getProductId', this.productRow)\n                                    if (this.productRow.id) {\n                                        if (this.$route.query.fodder === 'image') {\n                                            /* eslint-disable */\n                                                let imageObject = {\n                                                    image: this.productRow.image,\n                                                    product_id: this.productRow.id\n                                                };\n                                                form_create_helper.set('image', imageObject);\n                                                form_create_helper.close('image');\n                                            }\n                                        } else {\n                                            this.$Message.warning('请先选择商品');\n                                        }\n                                    }\n                                }\n                            })\n                        ])\n                    }\n                };\n\n            let checkbox =  {\n                type: 'selection',\n                width: 60,\n                align: 'center'\n            };\n            let many = ''\n            if(this.ischeckbox){\n                many = 'many'\n            }else{\n                many = this.$route.query.type;\n            }\n            this.many = many;\n            if(many === 'many'){\n                this.columns4.unshift(checkbox);\n                this.columns5.unshift(checkbox);\n            }else {\n                this.columns4.unshift(radio);\n                this.columns5.unshift(radio);\n            }\n        },\n        mounted() {\n            this.goodsCategory();\n            this.getList();\n        },\n        methods: {\n            changeCheckbox(selection) {\n                let images = [];\n                selection.forEach(function (item){\n                    let imageObject = { image:item.image,product_id:item.id};\n                    images.push(imageObject)\n                });\n                this.images = images;\n                this.$emit('getProductDiy',selection)\n            },\n            // 商品分类；\n            goodsCategory() {\n                treeListApi(1).then(res => {\n                    this.treeSelect = res.data;\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                })\n            },\n            pageChange(index) {\n                this.formValidate.page = index;\n                this.getList();\n            },\n            // 列表\n            getList() {\n                this.loading = true;\n                if(!this.liveStatus){\n                    if(this.isLive){\n                        this.formValidate.is_live = 1;\n                    }\n                    changeListApi(this.formValidate).then(async res => {\n                        let data = res.data;\n                        this.tableList = data.list;\n                        this.total = res.data.count;\n                        this.loading = false;\n                    }).catch(res => {\n                        this.loading = false;\n                        this.$Message.error(res.msg);\n                    })\n                }else{\n                    liveGoods({\n                        is_show:'1',\n                        status:'1',\n                        live_id:this.datas.id,\n                        kerword:this.formValidate.store_name,\n                        page: this.formValidate.page,\n                        limit: this.formValidate.limit\n                    }).then(async res => {\n                        let data = res.data;\n                        data.list.forEach(el=>{\n                            el.image = el.cover_img\n                        })\n                        this.tableList = data.list;\n                        this.total = res.data.count;\n                        this.loading = false;\n                    }).catch(res => {\n                        this.loading = false;\n                        this.$Message.error(res.msg);\n                    })\n                }\n\n            },\n            ok () {\n                if(this.images.length>0){\n                    if(this.$route.query.fodder === 'image') {\n                        console.log('this.images');\n                        console.log(this.images);\n                        let imageValue=form_create_helper.get('image');\n                        form_create_helper.set('image', imageValue.concat(this.images));\n                        form_create_helper.close('image');\n                    }else{\n                        this.$emit('getProductId', this.images);\n                    }\n                }else {\n                    this.$Message.warning('请先选择商品');\n                }\n            },\n            // 表格搜索\n            userSearchs() {\n                this.formValidate.page = 1;\n                this.getList();\n            },\n            clear() {\n                this.productRow.id = '';\n                this.currentid = '';\n            }\n        }\n    }\n</script>\n\n<style scoped lang=\"stylus\">\n    .footer\n        margin 15px 0;\n    .tabBox_img\n        width 36px\n        height 36px\n        border-radius: 4px\n        cursor pointer\n        img\n            width 100%\n            height 100%\n\n    .tabform\n        >>> .ivu-form-item\n            margin-bottom 16px !important\n\n    .btn\n        margin-top 20px\n        float right\n    .goodList\n        >>> table\n            width 100% !important\n</style>\n"]}]}