{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/components/freightTemplate/city.vue?vue&type=style&index=0&id=d1092626&scoped=true&lang=stylus&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/components/freightTemplate/city.vue","mtime":1610587842000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5tb2RhbCAuaXRlbXttYXJnaW4tYm90dG9tOjIwcHg7fQoubW9kYWwgLml0ZW0gLmNpdHl7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDo5O3RvcDoxN3B4O3dpZHRoOjEwMCU7cGFkZGluZy10b3A6MThweDt9Ci5tb2RhbCAuaXRlbSAuY2l0eSAuY2hlY2tCb3h7d2lkdGg6OTclO3BhZGRpbmc6MTBweDtib3JkZXI6MXB4IHNvbGlkICNlZWU7YmFja2dyb3VuZC1jb2xvcjojZmZmO21heC1oZWlnaHQ6MTAwcHg7b3ZlcmZsb3cteDpoaWRkZW47b3ZlcmZsb3cteTphdXRvO30KLm1vZGFsIC5pdGVtIC5jaXR5IC5jaGVja0JveCAuYXJyb3d7cG9zaXRpb246IGFic29sdXRlO3RvcDozcHg7d2lkdGg6IDA7aGVpZ2h0OiAwOwogICAgYm9yZGVyOiA4cHggc29saWQgdHJhbnNwYXJlbnQ7Ym9yZGVyLWJvdHRvbS1jb2xvcjojZGRkO30KLm1vZGFsIC5pdGVtIC5jaXR5IC5jaGVja0JveCAuYXJyb3c6YmVmb3Jle3Bvc2l0aW9uOiBhYnNvbHV0ZTtib3R0b206IC04cHg7cmlnaHQ6IC03cHg7Y29udGVudDogIiI7d2lkdGg6IDA7aGVpZ2h0OiAwO2JvcmRlcjogN3B4IHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1ib3R0b20tY29sb3I6ICNmZmY7fQoubW9kYWwgLml0ZW0gLmNpdHkgLmNoZWNrQm94IC5pdGVtbnttYXJnaW4tYm90dG9tOjEwcHg7fQoucmFkaW97cGFkZGluZzogNXB4IDA7Zm9udC1zaXplOjE0cHghaW1wb3J0YW50O30KLnJlZHtjb2xvcjojZmYwMDAwO30KLmVtcHR5e2N1cnNvcjogcG9pbnRlcjt9Cg=="},{"version":3,"sources":["city.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"city.vue","sourceRoot":"src/components/freightTemplate","sourcesContent":["<template>\n    <div>\n        <Modal\n                v-model=\"addressModal\"\n                title=\"选择可配送区域\"\n                width=\"50%\"\n                class=\"modal\"\n                :mask=\"true\"\n        >\n            <Row :gutter=\"24\" type=\"flex\">\n                <Col :xl=\"24\" :lg=\"24\" :md=\"24\" :sm=\"24\" :xs=\"24\" class=\"item\">\n                    <div class=\"acea-row row-right row-middle\">\n                        <Checkbox v-model=\"iSselect\" @on-change=\"allCheckbox\">全选</Checkbox>\n                        <div class=\"empty\" @click=\"empty\">清空</div>\n                    </div>\n                </Col>\n            </Row>\n                <Row :gutter=\"24\" type=\"flex\" :loading=\"loading\">\n                    <Col :xl=\"6\" :lg=\"6\" :md=\"6\" :sm=\"8\" :xs=\"6\" class=\"item\" v-for=\"(item,index) in cityList\" :key=\"index\">\n                        <div @mouseenter=\"enter(index)\" @mouseleave=\"leave()\">\n                            <Checkbox v-model=\"item.checked\" :label=\"item.name\" @on-change=\"checkedClick(index)\">{{item.name}}</Checkbox><span class=\"red\">({{(item.count || 0) + '/' + item.children.length}})</span>\n                            <div class=\"city\" v-show=\"activeCity===index\">\n                                <div class=\"checkBox\">\n                                    <div class=\"arrow\"></div>\n                                        <div>\n                                            <Checkbox v-model=\"city.checked\" :label=\"city.name\" @on-change=\"primary(index,indexn)\" class=\"itemn\" v-for=\"(city,indexn) in item.children\" :key=\"indexn\">{{city.name}}</Checkbox>\n                                        </div>\n                                </div>\n                            </div>\n                        </div>\n                    </Col>\n                </Row>\n            <div slot=\"footer\">\n                <Button @click=\"close\">取消</Button>\n                <Button type=\"primary\" @click=\"confirm\">确定</Button>\n            </div>\n            <Spin size=\"large\" fix v-if=\"loading\"></Spin>\n        </Modal>\n    </div>\n</template>\n\n<script>\n    import { mapState } from 'vuex'\n    import { templatesCityListApi } from '@/api/setting'\n    export default {\n        name: 'city',\n        props: {\n            type: {\n                type: Number,\n                default: 0\n            }\n        },\n        data () {\n            return {\n                iSselect: false,\n                addressModal: false,\n                cityList: [],\n                activeCity: -1,\n                loading: false\n            }\n        },\n        computed: {\n        },\n        methods: {\n            enter (index) {\n                this.activeCity = index\n            },\n            leave () {\n                this.activeCity = null\n            },\n            getCityList () {\n                this.loading = true\n                templatesCityListApi().then(res => {\n                    this.loading = false\n                    this.cityList = res.data\n                })\n            },\n            /**\n             * 全选或者反选\n             * @param checked\n             */\n            allCheckbox: function () {\n                let that = this, checked = this.iSselect\n                that.cityList.forEach(function (item, key) {\n                    that.$set(that.cityList[key], 'checked', checked)\n                    if (checked) {\n                        that.$set(that.cityList[key], 'count', that.cityList[key].children.length)\n                    } else {\n                        that.$set(that.cityList[key], 'count', 0)\n                    }\n                    that.cityList[key].children.forEach(function (val, k) {\n                        that.$set(that.cityList[key].children[k], 'checked', checked)\n                    })\n                })\n                // this.render();\n            },\n            // 清空；\n            empty () {\n                let that = this\n                that.cityList.forEach(function (item, key) {\n                    that.$set(that.cityList[key], 'checked', false)\n                    that.cityList[key].children.forEach(function (val, k) {\n                        that.$set(that.cityList[key].children[k], 'checked', false)\n                    })\n                    that.$set(that.cityList[key], 'count', 0)\n                })\n                this.iSselect = false\n            },\n            /**\n             * 点击省\n             * @param index\n             */\n            checkedClick: function (index) {\n                let that = this\n                if (that.cityList[index].checked) {\n                    that.$set(that.cityList[index], 'count', that.cityList[index].children.length)\n                    that.cityList[index].children.forEach(function (item, key) {\n                        that.$set(that.cityList[index].children[key], 'checked', true)\n                    })\n                } else {\n                    that.$set(that.cityList[index], 'count', 0)\n                    that.$set(that.cityList[index], 'checked', false)\n                    that.cityList[index].children.forEach(function (item, key) {\n                        that.$set(that.cityList[index].children[key], 'checked', false)\n                    })\n                    that.iSselect = false\n                }\n                // this.render();\n            },\n            /**\n             * 点击市区\n             * @param index\n             * @param ind\n             */\n            primary: function (index, ind) {\n                let checked = false, count = 0\n                this.cityList[index].children.forEach(function (item, key) {\n                    if (item.checked) {\n                        checked = true\n                        count++\n                    }\n                })\n                this.$set(this.cityList[index], 'count', count)\n                this.$set(this.cityList[index], 'checked', checked)\n                // this.render();\n            },\n            // 确定;\n            confirm () {\n                let that = this\n                // 被选中的省市；\n                let selectList = []\n                that.cityList.forEach(function (item, key) {\n                    let data = {}\n                    if (item.checked) {\n                        data = {\n                            name: item.name,\n                            city_id: item.city_id,\n                            children: []\n                        }\n                    }\n                    that.cityList[key].children.forEach(function (i, k) {\n                        if (i.checked) {\n                            data.children.push({\n                                city_id: i.city_id\n                            })\n                        }\n                    })\n                    if (data.city_id !== undefined) {\n                        selectList.push(data)\n                    }\n                })\n                console.log(selectList)\n                if (selectList.length === 0) {\n                    return that.$Message.error('至少选择一个省份或者城市')\n                } else {\n                    this.$emit('selectCity', selectList, this.type)\n                    that.addressModal = false\n                    this.cityList = []\n                }\n                // parent.selectCity(selectList,type);\n                // var index = parent.layer.getFrameIndex(window.name);\n                // parent.layer.close(index);\n                // console.log(selectList);\n            },\n            close () {\n                this.addressModal = false\n                this.cityList = []\n            }\n        },\n        mounted () {\n            // this.getCityList();\n        }\n    }\n</script>\n\n<style scoped lang=\"stylus\">\n    .modal .item{margin-bottom:20px;}\n    .modal .item .city{position:absolute;z-index:9;top:17px;width:100%;padding-top:18px;}\n    .modal .item .city .checkBox{width:97%;padding:10px;border:1px solid #eee;background-color:#fff;max-height:100px;overflow-x:hidden;overflow-y:auto;}\n    .modal .item .city .checkBox .arrow{position: absolute;top:3px;width: 0;height: 0;\n        border: 8px solid transparent;border-bottom-color:#ddd;}\n    .modal .item .city .checkBox .arrow:before{position: absolute;bottom: -8px;right: -7px;content: \"\";width: 0;height: 0;border: 7px solid transparent;border-bottom-color: #fff;}\n    .modal .item .city .checkBox .itemn{margin-bottom:10px;}\n    .radio{padding: 5px 0;font-size:14px!important;}\n    .red{color:#ff0000;}\n    .empty{cursor: pointer;}\n</style>\n"]}]}