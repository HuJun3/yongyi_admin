{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/pages/notify/smsConfig/components/forgetPhone.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/pages/notify/smsConfig/components/forgetPhone.vue","mtime":1610587844000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGNhcHRjaGFBcGksIGNvbmZpZ0FwaSwgc2VydmVNb2RpZnlBcGksIHVwZGF0ZUhvbmVBcGkgfSBmcm9tICdAL2FwaS9zZXR0aW5nJzsKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ2ZvcmdldFBob25lJywKICAgIHByb3BzOiB7CiAgICAgICAgaXNJbmRleDogewogICAgICAgICAgICB0eXBlOiBCb29sZWFuLAogICAgICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgICAgIH0KICAgIH0sCiAgICBkYXRhICgpIHsKICAgICAgICBjb25zdCB2YWxpZGF0ZVBob25lID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICAgICAgICBpZiAoIXZhbHVlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2sobmV3IEVycm9yKCfor7floavlhpnmiYvmnLrlj7cnKSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoIS9eMVszNDU2Nzg5XVxkezl9JC8udGVzdCh2YWx1ZSkpIHsKICAgICAgICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign5omL5py65Y+35qC85byP5LiN5q2j56GuIScpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIHZhciB2YWxpZGF0ZVBhc3MgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHsKICAgICAgICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign6K+36L6T5YWl5a+G56CBJykpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKHRoaXMuZm9ybUlubGluZS5jaGVja1Bhc3MgIT09ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5mb3JtSW5saW5lLnZhbGlkYXRlRmllbGQoJ2NoZWNrUGFzcycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGN1dE5VbTogJ+iOt+WPlumqjOivgeeggScsCiAgICAgICAgICAgIGNhbkNsaWNrOiB0cnVlLAogICAgICAgICAgICBjdXJyZW50OiAwLAogICAgICAgICAgICBmb3JtSW5saW5lOiB7CiAgICAgICAgICAgICAgICBhY2NvdW50OiAnJywKICAgICAgICAgICAgICAgIHBob25lOiAnJywKICAgICAgICAgICAgICAgIHZlcmlmeV9jb2RlOiAnJywKICAgICAgICAgICAgICAgIHBhc3N3b3JkOiAnJywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcnVsZUlubGluZTogewogICAgICAgICAgICAgICAgcGhvbmU6IFsKICAgICAgICAgICAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCB2YWxpZGF0b3I6IHZhbGlkYXRlUGhvbmUsIHRyaWdnZXI6ICdibHVyJyB9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgdmVyaWZ5X2NvZGU6IFsKICAgICAgICAgICAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl6aqM6K+B56CBJywgdHJpZ2dlcjogJ2JsdXInIH0KICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICBwYXNzd29yZDogWwogICAgICAgICAgICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXlr4bnoIEnLCB0cmlnZ2VyOiAnYmx1cicgfQogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIGFjY291bnQ6IFsKICAgICAgICAgICAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCB2YWxpZGF0b3I6IHZhbGlkYXRlUGhvbmUsIHRyaWdnZXI6ICdibHVyJyB9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICAvLyDnn63kv6Hpqozor4HnoIEKICAgICAgICBjdXREb3duICgpIHsKICAgICAgICAgICAgaWYgKHRoaXMuZm9ybUlubGluZS5waG9uZSkgewogICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhbkNsaWNrKSByZXR1cm47CiAgICAgICAgICAgICAgICB0aGlzLmNhbkNsaWNrID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLmN1dE5VbSA9IDYwOwogICAgICAgICAgICAgICAgbGV0IGRhdGEgPSB7CiAgICAgICAgICAgICAgICAgICAgcGhvbmU6IHRoaXMuZm9ybUlubGluZS5waG9uZQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGNhcHRjaGFBcGkoZGF0YSkudGhlbihhc3luYyByZXMgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuJE1lc3NhZ2Uuc3VjY2VzcyhyZXMubXNnKTsKICAgICAgICAgICAgICAgIH0pLmNhdGNoKHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcihyZXMubXNnKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICBsZXQgdGltZSA9IHNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmN1dE5VbS0tOwogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1dE5VbSA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1dE5VbSA9ICfojrflj5bpqozor4HnoIEnOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbkNsaWNrID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIDEwMDApCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLiRNZXNzYWdlLndhcm5pbmcoJ+ivt+Whq+WGmeaJi+acuuWPtyEnKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgaGFuZGxlU3VibWl0MSAobmFtZSkgewogICAgICAgICAgICB0aGlzLiRyZWZzW25hbWVdLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgICAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVTdWJtaXQobmFtZSwxKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgaGFuZGxlU3VibWl0MihuYW1lKSB7CiAgICAgICAgICAgIHRoaXMuJHJlZnNbbmFtZV0udmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgICAgICAgICAgICB1cGRhdGVIb25lQXBpKHRoaXMuZm9ybUlubGluZSkudGhlbihhc3luYyByZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRNZXNzYWdlLnN1Y2Nlc3MocmVzLm1zZykKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50ID0gMjsKICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIC8v55m75b2VCiAgICAgICAgaGFuZGxlU3VibWl0IChuYW1lLG51bSkgewogICAgICAgICAgICB0aGlzLiRyZWZzW25hbWVdLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgICAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICAgICAgICAgICAgY29uZmlnQXBpKHsKICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudDogdGhpcy5mb3JtSW5saW5lLmFjY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLmZvcm1JbmxpbmUucGFzc3dvcmQKICAgICAgICAgICAgICAgICAgICB9KS50aGVuKGFzeW5jIHJlcyA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIG51bT09PTE/dGhpcy4kTWVzc2FnZS5zdWNjZXNzKCLljp/miYvmnLrlj7flr4bnoIHmraPnoa4iKTp0aGlzLiRNZXNzYWdlLnN1Y2Nlc3MoIueZu+W9leaIkOWKnyIpOwogICAgICAgICAgICAgICAgICAgICAgICBudW09PT0xP3RoaXMuY3VycmVudCA9IDE6dGhpcy4kZW1pdCgnb24tTG9naW4nKTsKICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIHJldHVybnMgKCkgewogICAgICAgICAgICB0aGlzLmN1cnJlbnQgPT09IDAgPyB0aGlzLiRlbWl0KCdnb2JhY2tQaG9uZScpOiB0aGlzLmN1cnJlbnQgPSAwCiAgICAgICAgfQogICAgfQp9Cg=="},{"version":3,"sources":["forgetPhone.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"forgetPhone.vue","sourceRoot":"src/pages/notify/smsConfig/components","sourcesContent":["<template>\n    <Row type=\"flex\" justify=\"center\" align=\"middle\">\n        <Col span=\"20\" style=\"margin-top: 70px;\" class=\"mb50\">\n            <Steps :current=\"current\">\n                <Step title=\"验证账号信息\"></Step>\n                <Step title=\"修改手机号码\"></Step>\n                <Step title=\"登录\"></Step>\n            </Steps>\n        </Col>\n        <Col span=\"24\">\n            <div class=\"index_from page-account-container\">\n                <Form ref=\"formInline\" :model=\"formInline\" :rules=\"ruleInline\" @submit.native.prevent>\n                    <template v-if=\"current === 0\">\n                        <FormItem prop=\"account\" class=\"maxInpt\">\n                            <Input type=\"text\" v-model=\"formInline.account\" prefix=\"ios-contact-outline\"\n                                   placeholder=\"请输入当前手机号\" size=\"large\"/>\n                        </FormItem>\n                        <FormItem prop=\"password\" class=\"maxInpt\">\n                            <Input type=\"password\" v-model=\"formInline.password\" prefix=\"ios-lock-outline\"\n                                   placeholder=\"请输入密码\"/>\n                        </FormItem>\n                    </template>\n                    <template v-if=\"current === 1\">\n                        <FormItem prop=\"phone\" class=\"maxInpt\">\n                            <Input type=\"text\" v-model=\"formInline.phone\" prefix=\"ios-lock-outline\"\n                                   placeholder=\"请输入新手机号\" size=\"large\"/>\n                        </FormItem>\n                        <FormItem prop=\"verify_code\" class=\"maxInpt\">\n                            <div class=\"code\">\n                                <Input type=\"text\" v-model=\"formInline.verify_code\" prefix=\"ios-keypad-outline\"\n                                       placeholder=\"请输入验证码\" size=\"large\" />\n                                <Button :disabled=!this.canClick @click=\"cutDown\" size=\"large\">{{cutNUm}}</Button>\n                            </div>\n                        </FormItem>\n                    </template>\n                    <template v-if=\"current === 2\">\n                        <FormItem prop=\"phone\" class=\"maxInpt\">\n                            <Input type=\"text\" v-model=\"formInline.phone\" prefix=\"ios-contact-outline\"\n                                   placeholder=\"请输入手机号\"/>\n                        </FormItem>\n                        <FormItem prop=\"password\" class=\"maxInpt\">\n                            <Input type=\"password\" v-model=\"formInline.password\" prefix=\"ios-lock-outline\"\n                                   placeholder=\"请输入密码\"/>\n                        </FormItem>\n                    </template>\n                    <FormItem class=\"maxInpt\">\n                        <Button v-if=\"current === 0\" type=\"primary\" long size=\"large\" @click=\"handleSubmit1('formInline',current)\" class=\"mb20\">下一步</Button>\n                        <Button  v-if=\"current === 1\" type=\"primary\" long size=\"large\" @click=\"handleSubmit2('formInline',current)\" class=\"mb20\">提交</Button>\n                        <Button  v-if=\"current === 2\" type=\"primary\" long size=\"large\" @click=\"handleSubmit('formInline',current)\" class=\"mb20\">登录</Button>\n                        <Button long size=\"large\" @click=\"returns('formInline')\" class=\"btn\">返回\n                        </Button>\n                    </FormItem>\n                </Form>\n            </div>\n        </Col>\n    </Row>\n</template>\n\n<script>\n    import { captchaApi, configApi, serveModifyApi, updateHoneApi } from '@/api/setting';\n    export default {\n        name: 'forgetPhone',\n        props: {\n            isIndex: {\n                type: Boolean,\n                default: false\n            }\n        },\n        data () {\n            const validatePhone = (rule, value, callback) => {\n                if (!value) {\n                    return callback(new Error('请填写手机号'));\n                } else if (!/^1[3456789]\\d{9}$/.test(value)) {\n                    callback(new Error('手机号格式不正确!'));\n                } else {\n                    callback();\n                }\n            };\n            var validatePass = (rule, value, callback) => {\n                if (value === '') {\n                    callback(new Error('请输入密码'));\n                } else {\n                    if (this.formInline.checkPass !== '') {\n                        this.$refs.formInline.validateField('checkPass');\n                    }\n                    callback();\n                }\n            };\n\n            return {\n                cutNUm: '获取验证码',\n                canClick: true,\n                current: 0,\n                formInline: {\n                    account: '',\n                    phone: '',\n                    verify_code: '',\n                    password: '',\n                },\n                ruleInline: {\n                    phone: [\n                        { required: true, validator: validatePhone, trigger: 'blur' }\n                    ],\n                    verify_code: [\n                        { required: true, message: '请输入验证码', trigger: 'blur' }\n                    ],\n                    password: [\n                        { required: true, message: '请输入密码', trigger: 'blur' }\n                    ],\n                    account: [\n                        { required: true, validator: validatePhone, trigger: 'blur' }\n                    ],\n                }\n            }\n        },\n        methods: {\n            // 短信验证码\n            cutDown () {\n                if (this.formInline.phone) {\n                    if (!this.canClick) return;\n                    this.canClick = false;\n                    this.cutNUm = 60;\n                    let data = {\n                        phone: this.formInline.phone\n                    };\n                    captchaApi(data).then(async res => {\n                        this.$Message.success(res.msg);\n                    }).catch(res => {\n                        this.$Message.error(res.msg);\n                    })\n                    let time = setInterval(() => {\n                        this.cutNUm--;\n                        if (this.cutNUm === 0) {\n                            this.cutNUm = '获取验证码';\n                            this.canClick = true;\n                            clearInterval(time)\n                        }\n                    }, 1000)\n                } else {\n                    this.$Message.warning('请填写手机号!');\n                }\n            },\n            handleSubmit1 (name) {\n                this.$refs[name].validate((valid) => {\n                    if (valid) {\n                        this.handleSubmit(name,1);\n                    } else {\n                        return false;\n                    }\n                })\n            },\n            handleSubmit2(name) {\n                this.$refs[name].validate((valid) => {\n                    if (valid) {\n                        updateHoneApi(this.formInline).then(async res => {\n                            this.$Message.success(res.msg)\n                            this.current = 2;\n                        }).catch(res => {\n                            this.$Message.error(res.msg);\n                        })\n                    } else {\n                        return false;\n                    }\n                })\n            },\n            //登录\n            handleSubmit (name,num) {\n                this.$refs[name].validate((valid) => {\n                    if (valid) {\n                        configApi({\n                            account: this.formInline.account,\n                            password: this.formInline.password\n                        }).then(async res => {\n                            num===1?this.$Message.success(\"原手机号密码正确\"):this.$Message.success(\"登录成功\");\n                            num===1?this.current = 1:this.$emit('on-Login');\n                        }).catch(res => {\n                            this.$Message.error(res.msg);\n                        })\n                    } else {\n                        return false;\n                    }\n                })\n            },\n            returns () {\n                this.current === 0 ? this.$emit('gobackPhone'): this.current = 0\n            }\n        }\n    }\n</script>\n\n<style scoped lang=\"less\">\n    .maxInpt{\n        max-width:400px;\n        margin-left:auto;\n        margin-right:auto;\n    }\n    .code {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n</style>"]}]}