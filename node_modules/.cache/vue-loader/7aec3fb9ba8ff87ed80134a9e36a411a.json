{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/components/freightTemplate/index.vue?vue&type=style&index=0&id=6c602140&lang=stylus&scoped=true&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/components/freightTemplate/index.vue","mtime":1610587842000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLml2dS10YWJsZS13cmFwcGVyewogIGJvcmRlci1sZWZ0OiAxcHggc29saWQgI2RjZGVlMjsKICBib3JkZXItdG9wOiAxcHggc29saWQgI2RjZGVlMjsKfQogIC5pdnUtdGFibGUtYm9yZGVyIHRoLCAuaXZ1LXRhYmxlLWJvcmRlciB0ZHsKICAgICAgcGFkZGluZzogMCAxMHB4ICFpbXBvcnRhbnQ7CiAgfQogIC5hZGRUb3B7bWFyZ2luLXRvcDogMTVweDt9CiAgLnJhZGlve3BhZGRpbmc6IDVweCAwO30KICAuaXZ1LWlucHV0LW51bWJlcgogICAgICB3aWR0aCAxMDAlCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8fA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/freightTemplate","sourcesContent":["<template>\n    <div>\n        <Modal\n                v-model=\"isTemplate\"\n                title=\"运费模版\"\n                width=\"70%\"\n                if=\"isTemplate\"\n                @on-cancel=\"cancel\"\n        >\n            <div class=\"Modals\">\n                <Form  class=\"form\" ref=\"formData\" :label-width=\"120\" label-position=\"right\">\n                    <Row :gutter=\"24\" type=\"flex\">\n                        <Col :xl=\"18\" :lg=\"18\" :md=\"18\" :sm=\"24\" :xs=\"24\">\n                            <FormItem label=\"模板名称：\" prop=\"name\">\n                                <Input type=\"text\" placeholder=\"请输入模板名称\" :maxlength='20' v-model=\"formData.name\"/>\n                            </FormItem>\n                        </Col>\n                    </Row>\n                    <Row :gutter=\"24\" type=\"flex\">\n                        <Col :xl=\"18\" :lg=\"18\" :md=\"18\" :sm=\"24\" :xs=\"24\">\n                            <FormItem label=\"计费方式：\" props=\"state\" label-for=\"state\">\n                                <RadioGroup class=\"radio\" v-model=\"formData.type\" @on-change=\"changeRadio\" element-id=\"state\">\n                                    <Radio :label=\"1\">按件数</Radio>\n                                    <Radio :label=\"2\">按重量</Radio>\n                                    <Radio :label=\"3\">按体积</Radio>\n                                </RadioGroup>\n                            </FormItem>\n                        </Col>\n                    </Row>\n                    <Row :gutter=\"24\" type=\"flex\">\n                        <Col :xl=\"24\" :lg=\"24\" :md=\"24\" :sm=\"24\" :xs=\"24\">\n                            <FormItem class=\"label\" label=\"配送区域及运费：\" props=\"state\" label-for=\"state\">\n                                <Table\n                                        ref=\"table\"\n                                        :columns=\"columns\"\n                                        :data=\"templateList\"\n                                        class=\"ivu-mt\"\n                                        no-data-text=\"暂无数据\"\n                                        border\n                                >\n                                    <template slot-scope=\"{ row, index }\" slot=\"action\">\n                                        <a v-if=\"row.regionName!=='默认全国'\" @click=\"delCity(row,'配送区域',index,1)\">删除</a>\n                                    </template>\n                                </Table>\n                                <Row type=\"flex\" class=\"addTop\">\n                                    <Col>\n                                        <Button type=\"primary\" icon=\"md-add\" @click=\"addCity(1)\">单独添加配送区域</Button>\n                                    </Col>\n                                </Row>\n                            </FormItem>\n                        </Col>\n                    </Row>\n                    <Row :gutter=\"24\" type=\"flex\">\n                        <Col :xl=\"24\" :lg=\"24\" :md=\"24\" :sm=\"24\" :xs=\"24\">\n                            <FormItem label=\"指定包邮：\" prop=\"store_name\" label-for=\"store_name\">\n                                <Radio-group class=\"radio\" v-model=\"formData.appoint_check\">\n                                    <Radio :label=\"1\">开启</Radio>\n                                    <Radio :label=\"0\">关闭</Radio>\n                                </Radio-group>\n                                <Table\n                                        ref=\"table\"\n                                        :columns=\"columns2\"\n                                        :data=\"appointList\"\n                                        class=\"addTop ivu-mt\"\n                                        no-data-text=\"暂无数据\"\n                                        border\n                                        v-if=\"formData.appoint_check === 1\"\n                                >\n                                    <template slot-scope=\"{ row, index }\" slot=\"action\">\n                                        <a v-if=\"row.regionName!=='默认全国'\" @click=\"delCity(row,'配送区域',index,2)\">删除</a>\n                                    </template>\n                                </Table>\n                                <Row type=\"flex\" class=\"addTop\" v-if=\"formData.appoint_check === 1\">\n                                    <Col>\n                                        <Button type=\"primary\" icon=\"md-add\" @click=\"addCity(2)\">单独指定包邮</Button>\n                                    </Col>\n                                </Row>\n                            </FormItem>\n                        </Col>\n                    </Row>\n                    <Row :gutter=\"24\" type=\"flex\">\n                        <Col :xl=\"18\" :lg=\"18\" :md=\"18\" :sm=\"24\" :xs=\"24\">\n                            <FormItem label=\"排序：\" prop=\"store_name\" label-for=\"store_name\">\n                                <InputNumber :min=\"0\" placeholder=\"输入值越大越靠前\" v-model=\"formData.sort\" ></InputNumber>\n                            </FormItem>\n                        </Col>\n                    </Row>\n                    <Row :gutter=\"24\" type=\"flex\">\n                        <Col>\n                            <FormItem prop=\"store_name\" label-for=\"store_name\">\n                                <Button type=\"primary\" @click=\"handleSubmit\">{{id ? '立即修改':'立即提交'}}</Button>\n                            </FormItem>\n                        </Col>\n                    </Row>\n                </Form>\n            </div>\n            <div slot=\"footer\"></div>\n        </Modal>\n        <city ref=\"city\" @selectCity=\"selectCity\" :type=\"type\"></city>\n    </div>\n</template>\n\n<script>\n    import { mapState } from 'vuex'\n    import city from '@/components/freightTemplate/city'\n    import { templatesSaveApi, shipTemplatesApi } from '@/api/setting'\n    export default {\n        name: 'freightTemplate',\n        components: { city },\n        props: {\n        },\n        data () {\n            let that = this\n            return {\n                isTemplate: false,\n                columns: [\n                    {\n                        title: '可配送区域',\n                        key: 'regionName',\n                        minWidth: 100,\n                        render: (h, params) => {\n                            return h('Input', {\n                                props: {\n                                    type: 'text',\n                                    readonly: true,\n                                    size: 'small',\n                                    value: that.templateList[params.index].regionName\n                                }\n                            })\n                        }\n                    },\n                    {\n                        title: '首件',\n                        key: 'first',\n                        minWidth: 70,\n                        render: (h, params) => {\n                            return h('Input', {\n                                props: {\n                                    type: 'number',\n                                    size: 'small',\n                                    value: that.templateList[params.index].first // 此处如何让数据双向绑定\n                                },\n                                on: {\n                                    'on-change': (event) => {\n                                        that.templateList[params.index].first = event.target.value\n                                    }\n                                }\n                            })\n                        }\n                    },\n                    {\n                        title: '运费（元）',\n                        key: 'price',\n                        minWidth: 70,\n                        render: (h, params) => {\n                            return h('Input', {\n                                props: {\n                                    type: 'number',\n                                    size: 'small',\n                                    value: that.templateList[params.index].price // 此处如何让数据双向绑定\n                                },\n                                on: {\n                                    'on-change': (event) => {\n                                        that.templateList[params.index].price = event.target.value\n                                    }\n                                }\n                            })\n                        }\n                    },\n                    {\n                        title: '续件',\n                        key: 'continue',\n                        minWidth: 70,\n                        render: (h, params) => {\n                            return h('Input', {\n                                props: {\n                                    type: 'number',\n                                    size: 'small',\n                                    value: that.templateList[params.index].continue // 此处如何让数据双向绑定\n                                },\n                                on: {\n                                    'on-change': (event) => {\n                                        that.templateList[params.index].continue = event.target.value\n                                    }\n                                }\n                            })\n                        }\n                    },\n                    {\n                        title: '续费（元）',\n                        key: 'continue_price',\n                        minWidth: 70,\n                        render: (h, params) => {\n                            return h('Input', {\n                                props: {\n                                    type: 'number',\n                                    size: 'small',\n                                    value: that.templateList[params.index].continue_price // 此处如何让数据双向绑定\n                                },\n                                on: {\n                                    'on-change': (event) => {\n                                        that.templateList[params.index].continue_price = event.target.value\n                                    }\n                                }\n                            })\n                        }\n                    },\n                    {\n                        title: '操作',\n                        slot: 'action',\n                        minWidth: 70\n                    }\n                ],\n                columns2: [\n                    {\n                        title: '选择地区',\n                        key: 'placeName',\n                        minWidth: 250,\n                        render: (h, params) => {\n                            return h('Input', {\n                                props: {\n                                    type: 'text',\n                                    readonly: true,\n                                    size: 'small',\n                                    value: that.appointList[params.index].placeName\n                                }\n                            })\n                        }\n                    },\n                    {\n                        title: '包邮件数',\n                        key: 'a_num',\n                        minWidth: 100,\n                        render: (h, params) => {\n                            return h('Input', {\n                                props: {\n                                    type: 'number',\n                                    size: 'small',\n                                    value: that.appointList[params.index].a_num // 此处如何让数据双向绑定\n                                },\n                                on: {\n                                    'on-change': (event) => {\n                                        that.appointList[params.index].a_num = event.target.value\n                                    }\n                                }\n                            })\n                        }\n                    },\n                    {\n                        title: '包邮金额（元）',\n                        key: 'a_price',\n                        minWidth: 100,\n                        render: (h, params) => {\n                            return h('Input', {\n                                props: {\n                                    type: 'number',\n                                    size: 'small',\n                                    value: that.appointList[params.index].a_price // 此处如何让数据双向绑定\n                                },\n                                on: {\n                                    'on-change': (event) => {\n                                        that.appointList[params.index].a_price = event.target.value\n                                    }\n                                }\n                            })\n                        }\n                    },\n                    {\n                        title: '操作',\n                        slot: 'action',\n                        minWidth: 100\n                    }\n                ],\n                templateList: [\n                    {\n                        region: [\n                            {\n                                name: '默认全国',\n                                city_id: 0\n                            }\n                        ],\n                        regionName: '默认全国',\n                        first: 1,\n                        price: 0,\n                        continue: 1,\n                        continue_price: 0\n                    }\n                ],\n                appointList: [],\n                type: 1,\n                formData: {\n                    type: 1,\n                    sort: 0,\n                    name: '',\n                    appoint_check: 0\n                },\n                id: 0,\n\n                addressModal: false,\n                indeterminate: true,\n                checkAll: false,\n                checkAllGroup: [],\n                activeCity: -1,\n                provinceAllGroup: [],\n                index: -1,\n                displayData: '',\n                currentProvince: ''\n            }\n        },\n        computed: {\n        },\n        methods: {\n            editFrom (id) {\n                this.id = id\n                shipTemplatesApi(id).then(res => {\n                    let formData = res.data.formData\n                    this.templateList = res.data.templateList\n                    this.appointList = res.data.appointList\n                    this.formData = {\n                        type: formData.type,\n                        sort: formData.sort,\n                        name: formData.name,\n                        appoint_check: formData.appoint_check\n                    };\n                    this.headerType();\n                })\n            },\n            selectCity: function (data, type) {\n                let cityName = data.map(function (item) {\n                    return item.name\n                }).join(';')\n                switch (type) {\n                case 1:\n                    this.templateList.push({\n                        region: data,\n                        regionName: cityName,\n                        first: 1,\n                        price: 0,\n                        continue: 1,\n                        continue_price: 0\n                    })\n                    break\n                case 2:\n                    this.appointList.push({\n                        place: data,\n                        placeName: cityName,\n                        a_num: 0,\n                        a_price: 0\n                    })\n                    break\n                }\n            },\n            // 单独添加配送区域\n            addCity (type) {\n                this.$refs.city.addressModal = true\n                this.type = type\n                this.$refs.city.getCityList()\n            },\n            changeRadio () {\n                this.headerType();\n            },\n            headerType () {\n                let that = this;\n                if (this.formData.type === 2) {\n                    that.columns[1].title = '首件重量(KG)'\n                    that.columns[3].title = '续件重量(KG)'\n                    that.columns2[1].title = '包邮重量(KG)'\n                } else if (this.formData.type === 3) {\n                    that.columns[1].title = '首件体积(m³)'\n                    that.columns[3].title = '续件体积(m³)'\n                    that.columns2[1].title = '包邮体积(m³)'\n                } else {\n                    that.columns[1].title = '首件'\n                    that.columns[3].title = '续件'\n                    that.columns2[1].title = '包邮件数'\n                }\n            },\n            // 提交\n            handleSubmit: function () {\n                let that = this\n                if (!that.formData.name.trim().length) {\n                    return that.$Message.error('请填写模板名称')\n                }\n                for (let i = 0; i < that.templateList.length; i++) {\n                    if (that.templateList[i].first <= 0) {\n                        return that.$Message.error('首件/重量/体积应大于0')\n                    }\n                    if (that.templateList[i].price < 0) {\n                        return that.$Message.error('运费应大于等于0')\n                    }\n                    if (that.templateList[i].continue <= 0) {\n                        return that.$Message.error('续件/重量/体积应大于0')\n                    }\n                    if (that.templateList[i].continue_price < 0) {\n                        return that.$Message.error('续费应大于等于0')\n                    }\n                }\n                if (that.formData.appoint_check === 1) {\n                    for (let i = 0; i < that.appointList.length; i++) {\n                        if (that.appointList[i].a_num <= 0) {\n                            return that.$Message.error('包邮件数应大于0')\n                        }\n                        if (that.appointList[i].a_price < 0) {\n                            return that.$Message.error('包邮金额应大于等于0')\n                        }\n                    }\n                }\n                let data = {\n                    appoint_info: that.appointList,\n                    region_info: that.templateList,\n                    sort: that.formData.sort,\n                    type: that.formData.type,\n                    name: that.formData.name,\n                    appoint: that.formData.appoint_check\n                }\n                templatesSaveApi(that.id, data).then(res => {\n                    this.isTemplate = false\n                    this.$parent.getList()\n                    this.formData = {\n                        type: 1,\n                        sort: 0,\n                        name: '',\n                        appoint_check: 0\n                    }\n                    this.appointList = []\n                    this.addressModal = false\n                    this.templateList = [\n                        {\n                            region: [\n                                {\n                                    name: '默认全国',\n                                    city_id: 0\n                                }\n                            ],\n                            regionName: '默认全国',\n                            first: 1,\n                            price: 0,\n                            continue: 1,\n                            continue_price: 0\n                        }\n                    ]\n                    this.$Message.success(res.msg);\n                })\n            },\n            // 删除\n            delCity (row, tit, num, type) {\n                let delfromData = {\n                    title: tit,\n                    num: num,\n                    url: `setting/shipping_templates/del/${row.id}`,\n                    method: 'DELETE',\n                    ids: ''\n                }\n                this.$modalSure(delfromData).then((res) => {\n                    this.$Message.success(res.msg)\n                    if (type === 1) {\n                        this.templateList.splice(num, 1)\n                    } else {\n                        this.appointList.splice(num, 1)\n                    }\n                }).catch(res => {\n                    this.$Message.error(res.msg)\n                })\n            },\n            // 关闭\n            cancel () {\n                this.formData = {\n                    type: 1,\n                    sort: 0,\n                    name: '',\n                    appoint_check: 0\n                }\n                this.appointList = []\n                this.addressModal = false\n                this.templateList = [\n                    {\n                        region: [\n                            {\n                                name: '默认全国',\n                                city_id: 0\n                            }\n                        ],\n                        regionName: '默认全国',\n                        first: 0,\n                        price: 0,\n                        continue: 0,\n                        continue_price: 0\n                    }\n                ]\n            },\n\n            address () {\n                this.addressModal = true\n            },\n            enter (index) {\n                this.activeCity = index\n            },\n            leave () {\n                this.activeCity = null\n            }\n\n        },\n        mounted () {\n            console.log(123)\n            console.log(this.templateList)\n            // console.log(this.provinceAllGroup)\n        }\n    }\n</script>\n<style lang=\"stylus\" scoped>\n  .ivu-table-wrapper{\n    border-left: 1px solid #dcdee2;\n    border-top: 1px solid #dcdee2;\n  }\n    .ivu-table-border th, .ivu-table-border td{\n        padding: 0 10px !important;\n    }\n    .addTop{margin-top: 15px;}\n    .radio{padding: 5px 0;}\n    .ivu-input-number\n        width 100%\n</style>\n"]}]}