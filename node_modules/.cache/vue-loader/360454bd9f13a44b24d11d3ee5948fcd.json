{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/pages/system/configTab/list.vue?vue&type=style&index=0&id=b9286974&scoped=true&lang=stylus&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/pages/system/configTab/list.vue","mtime":1610587844000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoudGFic05hbWUKICBtYXJnaW4tYm90dG9tIDE1cHgKLnZhbEJveAogICAgbWFyZ2luIDEwcHggMAoudmFsUGljYm94CiAgICBib3JkZXI6IDFweCBzb2xpZCAjZTdlYWVjOwoudmFsUGljYm94X3BpYwogICAgd2lkdGggMjAwcHgKICAgIGhlaWdodCAxMDBweAogICAgZGlzcGxheSBmbGV4CiAgICBhbGlnbi1pdGVtcyBjZW50ZXIKICAgIGp1c3RpZnktY29udGVudCBjZW50ZXIKICAgIGltZwogICAgICB3aWR0aCAxMDAlCiAgICAgIGhlaWdodCAxMDAlCiAgICA+Pj4gLml2dS1pY29uLW1kLWRvY3VtZW50CiAgICAgICAgZm9udC1zaXplOiA3MHB4OwogICAgICAgIGNvbG9yOiAjZGFkYWRhOwoudmFsUGljYm94X3NwCiAgICBkaXNwbGF5IGJsb2NrCiAgICBmb250LXNpemUgMTJweAogICAgd2lkdGggMjAwcHgKICAgIHBhZGRpbmcgN3B4CiAgICBib3gtc2l6aW5nIGJvcmRlci1ib3gKICAgIGJvcmRlci10b3A6IDFweCBzb2xpZCAjZTdlYWVjOwo="},{"version":3,"sources":["list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/pages/system/configTab","sourcesContent":["<template>\n    <div>\n        <div class=\"i-layout-page-header\">\n          <div class=\"i-layout-page-header\">\n            <span class=\"ivu-page-header-title\">{{$route.meta.title}}</span>\n          </div>\n        </div>\n        <Card :bordered=\"false\" dis-hover class=\"ivu-mt\">\n            <Row type=\"flex\">\n                <Col v-bind=\"grid\">\n                    <Button type=\"primary\" @click=\"goIndex\" class=\"mr20\">配置分类</Button>\n                    <Button type=\"primary\" icon=\"md-add\" @click=\"configureAdd\">添加配置</Button>\n                </Col>\n            </Row>\n            <Divider dashed />\n            <Table :columns=\"columns1\" :data=\"classList\" ref=\"table\"\n                   :loading=\"loading\"\n                   no-userFrom-text=\"暂无数据\"\n                   no-filtered-userFrom-text=\"暂无筛选结果\">\n                <template slot-scope=\"{ row, index }\" slot=\"values\">\n                    <span v-if=\" row.type === 'text' || row.type ==='textarea' ||  row.type ==='radio' || row.type ==='checkbox'\">{{row.value}}</span>\n                    <div class=\"valBox acea-row\" v-if=\" row.type ==='upload' && row.upload_type === 3 \">\n                        <div v-if=\"row.value instanceof Array\">\n                            <div class=\"valPicbox acea-row row-column-around\"  v-for=\"(item, index) in row.value\" :key=\"index\">\n                                <div class=\"valPicbox_pic\"><Icon type=\"md-document\" /></div>\n                                <span class=\"valPicbox_sp\">{{item.filename}}</span>\n                            </div>\n                        </div>\n<!--                        <div v-else>-->\n<!--                            <div class=\"valPicbox acea-row row-column-around\">-->\n<!--                                <div class=\"valPicbox_pic\"><Icon type=\"md-document\" /></div>-->\n<!--                                <span class=\"valPicbox_sp\">{{row.filename}}</span>-->\n<!--                            </div>-->\n<!--                        </div>-->\n                    </div>\n                    <div class=\"valBox acea-row\" v-if=\" row.type ==='upload' && row.upload_type !== 3\">\n                        <div v-if=\"row.value instanceof Array\">\n                            <div class=\"valPicbox acea-row row-column-around\"  v-for=\"(item, index) in row.value\" :key=\"index\">\n                                <div class=\"valPicbox_pic\"><img v-lazy=\"item.filepath\"></div>\n                                <span class=\"valPicbox_sp\">{{item.filename}}</span>\n                            </div>\n                        </div>\n<!--                        <div v-else>-->\n<!--                            <div class=\"valPicbox acea-row row-column-around\">-->\n<!--                                <div class=\"valPicbox_pic\"><img :src=\"row.filepath ? row.filepath : require('../../../assets/images/moren.jpg')\"></div>-->\n<!--                                <span class=\"valPicbox_sp\">{{row.filename}}</span>-->\n<!--                            </div>-->\n<!--                        </div>-->\n                    </div>\n                </template>\n                <template slot-scope=\"{ row, index }\" slot=\"statuss\">\n                    <i-switch v-model=\"row.status\" :value=\"row.status\" :true-value=\"1\" :false-value=\"0\" @on-change=\"onchangeIsShow(row)\" size=\"large\">\n                        <span slot=\"open\">显示</span>\n                        <span slot=\"close\">隐藏</span>\n                    </i-switch>\n                </template>\n                <template slot-scope=\"{ row, index }\" slot=\"action\">\n                    <a @click=\"edit(row)\">编辑</a>\n                    <Divider type=\"vertical\" />\n                    <a @click=\"del(row,'删除分类',index)\">删除</a>\n                </template>\n            </Table>\n<!--            <div class=\"acea-row row-right page\">-->\n<!--                <Page :total=\"total\" show-elevator show-total @on-change=\"pageChange\"-->\n<!--                      :page-size=\"formValidate.limit\"/>-->\n<!--            </div>-->\n        </Card>\n\n        <!-- 新建 表单-->\n        <Modal v-model=\"modals2\"  scrollable  footer-hide closable  title=\"添加配置字段\" :mask-closable=\"false\" :z-index=\"1\" width=\"700\">\n            <Tabs v-model=\"typeFrom.type\" @on-click=\"onhangeTab\" class=\"tabsName\">\n                <TabPane label=\"文本框 \" name=\"0\"></TabPane>\n                <TabPane label=\"多行文本框\" name=\"1\"></TabPane>\n                <TabPane label=\"单选框\" name=\"2\"></TabPane>\n                <TabPane label=\"文件上传\" name=\"3\"></TabPane>\n                <TabPane label=\"多选框\" name=\"4\"></TabPane>\n                <TabPane label=\"下拉框\" name=\"5\"></TabPane>\n            </Tabs>\n            <form-create v-if=\"rules.length!=0\"  :rule=\"rules\" @on-submit=\"onSubmit\"  class=\"formBox\" ref=\"fc\" handleIcon=\"false\"></form-create>\n        </Modal>\n        <!-- 编辑表单-->\n        <edit-from ref=\"edits\" :FromData=\"FromData\" @submitFail=\"submitFail\"></edit-from>\n     </div>\n</template>\n\n<script>\n    import { configTabListApi, configTabAddApi, configTabEditApi, configSetStatusApi } from '@/api/system'\n    import formCreate from '@form-create/iview'\n    import editFrom from '@/components/from/from'\n    import request from '@/libs/request'\n    export default {\n        name: 'list',\n        components: { formCreate: formCreate.$form(), editFrom },\n        data () {\n            return {\n                modals2: false,\n                grid: {\n                    xl: 7,\n                    lg: 7,\n                    md: 12,\n                    sm: 24,\n                    xs: 24\n                },\n                loading: false,\n                formValidate: {\n                    tab_id: 0,\n                    page: 1,\n                    limit: 20\n                },\n                total: 0,\n                columns1: [\n                    {\n                        title: 'ID',\n                        key: 'id',\n                        width: 80\n                    },\n                    {\n                        title: '配置名称',\n                        key: 'info',\n                        minWidth: 130\n                    },\n                    {\n                        title: '字段变量',\n                        key: 'menu_name',\n                        minWidth: 140\n                    },\n                    {\n                        title: '字段类型',\n                        key: 'type',\n                        minWidth: 90\n                    },\n                    {\n                        title: '值',\n                        slot: 'values',\n                        minWidth: 230\n                    },\n                    {\n                        title: '是否显示',\n                        slot: 'statuss',\n                        minWidth: 90\n                    },\n                    {\n                        title: '操作',\n                        slot: 'action',\n                        fixed: 'right',\n                        minWidth: 120\n                    }\n                ],\n                FromData: null,\n                FromRequestData: {},\n                modalTitleSs: '',\n                classList: [],\n                num: 0,\n                typeFrom: {\n                    type: 0,\n                    tab_id: this.$route.params.id\n                },\n                rules: []\n            }\n        },\n        watch: {\n            $route: {\n                handler: function (val, oldVal) {\n                    this.getList()\n                },\n                // 深度观察监听\n                deep: true\n            }\n        },\n        mounted () {\n            this.getList()\n        },\n        methods: {\n            // 点击tab\n            onhangeTab (name) {\n                this.typeFrom.type = name\n                this.classAdd()\n            },\n            // 新增表单\n            classAdd () {\n                configTabAddApi(this.typeFrom).then(async res => {\n                    if (res.data.status === false) {\n                        return this.$authLapse(res.data)\n                    }\n                    let data = res.data || {}\n                    this.FromRequestData = { action: data.action, method: data.method }\n                    this.rules = data.rules\n                    this.modals2 = true\n                }).catch(res => {\n                    this.$Message.error(res.msg)\n                })\n            },\n            // 编辑表单\n            edit (row) {\n                configTabEditApi(row.id).then(async res => {\n                    if (res.data.status === false) {\n                        return this.$authLapse(res.data)\n                    }\n                    let data = res.data || {}\n                    this.FromRequestData = { action: data.action, method: data.method }\n                    this.rules = data.rules\n                    this.$refs.edits.modals = true\n                    this.modals2 = true\n                }).catch(res => {\n                    this.$Message.error(res.msg)\n                })\n            },\n            // 提交表单\n            onSubmit (formData) {\n                request({\n                    url: this.FromRequestData.action,\n                    method: this.FromRequestData.method,\n                    data: formData\n                }).then(res => {\n                    this.$Message.success(res.msg)\n                    setTimeout(() => {\n                        this.modals2 = false\n                    }, 1000)\n                    setTimeout(() => {\n                        this.getList()\n                    }, 1500)\n                }).catch(res => {\n                    this.$Message.error(res.msg)\n                })\n            },\n            // 修改成功\n            submitFail () {\n                this.getList()\n            },\n            // 跳转到配置分类页面\n            goIndex () {\n                this.$router.push({ path: '/admin/system/config/system_config_tab/index' })\n            },\n            // 添加配置\n            configureAdd () {\n                // this.modals2 = true;\n                this.classAdd()\n            },\n            // 列表\n            getList () {\n                this.loading = true\n                this.formValidate.tab_id = this.$route.params.id\n                configTabListApi(this.formValidate).then(async res => {\n                    let data = res.data\n                    this.classList = data.list\n                    this.total = data.count\n                    this.loading = false\n                }).catch(res => {\n                    this.loading = false\n                    this.$Message.error(res.msg)\n                })\n            },\n            pageChange (index) {\n                this.formValidate.page = index\n                this.getList()\n            },\n            // 删除\n            del (row, tit, num) {\n                let delfromData = {\n                    title: tit,\n                    num: num,\n                    url: `/setting/config/${row.id}`,\n                    method: 'DELETE',\n                    ids: ''\n                }\n                this.$modalSure(delfromData).then((res) => {\n                    this.$Message.success(res.msg)\n                    this.classList.splice(num, 1)\n                }).catch(res => {\n                    this.$Message.error(res.msg)\n                })\n            },\n            // 修改是否显示\n            onchangeIsShow (row) {\n                configSetStatusApi(row.id, row.status).then(async res => {\n                    this.$Message.success(res.msg)\n                }).catch(res => {\n                    this.$Message.error(res.msg)\n                })\n            }\n        }\n    }\n</script>\n<style scoped lang=\"stylus\">\n    .tabsName\n      margin-bottom 15px\n    .valBox\n        margin 10px 0\n    .valPicbox\n        border: 1px solid #e7eaec;\n    .valPicbox_pic\n        width 200px\n        height 100px\n        display flex\n        align-items center\n        justify-content center\n        img\n          width 100%\n          height 100%\n        >>> .ivu-icon-md-document\n            font-size: 70px;\n            color: #dadada;\n    .valPicbox_sp\n        display block\n        font-size 12px\n        width 200px\n        padding 7px\n        box-sizing border-box\n        border-top: 1px solid #e7eaec;\n</style>\n"]}]}