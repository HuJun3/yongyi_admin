{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/components/freightTemplate/city.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/components/freightTemplate/city.vue","mtime":1610587842000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCcKaW1wb3J0IHsgdGVtcGxhdGVzQ2l0eUxpc3RBcGkgfSBmcm9tICdAL2FwaS9zZXR0aW5nJwpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAnY2l0eScsCiAgICBwcm9wczogewogICAgICAgIHR5cGU6IHsKICAgICAgICAgICAgdHlwZTogTnVtYmVyLAogICAgICAgICAgICBkZWZhdWx0OiAwCiAgICAgICAgfQogICAgfSwKICAgIGRhdGEgKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGlTc2VsZWN0OiBmYWxzZSwKICAgICAgICAgICAgYWRkcmVzc01vZGFsOiBmYWxzZSwKICAgICAgICAgICAgY2l0eUxpc3Q6IFtdLAogICAgICAgICAgICBhY3RpdmVDaXR5OiAtMSwKICAgICAgICAgICAgbG9hZGluZzogZmFsc2UKICAgICAgICB9CiAgICB9LAogICAgY29tcHV0ZWQ6IHsKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgZW50ZXIgKGluZGV4KSB7CiAgICAgICAgICAgIHRoaXMuYWN0aXZlQ2l0eSA9IGluZGV4CiAgICAgICAgfSwKICAgICAgICBsZWF2ZSAoKSB7CiAgICAgICAgICAgIHRoaXMuYWN0aXZlQ2l0eSA9IG51bGwKICAgICAgICB9LAogICAgICAgIGdldENpdHlMaXN0ICgpIHsKICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgICAgICAgICB0ZW1wbGF0ZXNDaXR5TGlzdEFwaSgpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgICAgICB0aGlzLmNpdHlMaXN0ID0gcmVzLmRhdGEKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIC8qKgogICAgICAgICAqIOWFqOmAieaIluiAheWPjemAiQogICAgICAgICAqIEBwYXJhbSBjaGVja2VkCiAgICAgICAgICovCiAgICAgICAgYWxsQ2hlY2tib3g6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgbGV0IHRoYXQgPSB0aGlzLCBjaGVja2VkID0gdGhpcy5pU3NlbGVjdAogICAgICAgICAgICB0aGF0LmNpdHlMaXN0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGtleSkgewogICAgICAgICAgICAgICAgdGhhdC4kc2V0KHRoYXQuY2l0eUxpc3Rba2V5XSwgJ2NoZWNrZWQnLCBjaGVja2VkKQogICAgICAgICAgICAgICAgaWYgKGNoZWNrZWQpIHsKICAgICAgICAgICAgICAgICAgICB0aGF0LiRzZXQodGhhdC5jaXR5TGlzdFtrZXldLCAnY291bnQnLCB0aGF0LmNpdHlMaXN0W2tleV0uY2hpbGRyZW4ubGVuZ3RoKQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGF0LiRzZXQodGhhdC5jaXR5TGlzdFtrZXldLCAnY291bnQnLCAwKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhhdC5jaXR5TGlzdFtrZXldLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKHZhbCwgaykgewogICAgICAgICAgICAgICAgICAgIHRoYXQuJHNldCh0aGF0LmNpdHlMaXN0W2tleV0uY2hpbGRyZW5ba10sICdjaGVja2VkJywgY2hlY2tlZCkKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC8vIHRoaXMucmVuZGVyKCk7CiAgICAgICAgfSwKICAgICAgICAvLyDmuIXnqbrvvJsKICAgICAgICBlbXB0eSAoKSB7CiAgICAgICAgICAgIGxldCB0aGF0ID0gdGhpcwogICAgICAgICAgICB0aGF0LmNpdHlMaXN0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGtleSkgewogICAgICAgICAgICAgICAgdGhhdC4kc2V0KHRoYXQuY2l0eUxpc3Rba2V5XSwgJ2NoZWNrZWQnLCBmYWxzZSkKICAgICAgICAgICAgICAgIHRoYXQuY2l0eUxpc3Rba2V5XS5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uICh2YWwsIGspIHsKICAgICAgICAgICAgICAgICAgICB0aGF0LiRzZXQodGhhdC5jaXR5TGlzdFtrZXldLmNoaWxkcmVuW2tdLCAnY2hlY2tlZCcsIGZhbHNlKQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIHRoYXQuJHNldCh0aGF0LmNpdHlMaXN0W2tleV0sICdjb3VudCcsIDApCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHRoaXMuaVNzZWxlY3QgPSBmYWxzZQogICAgICAgIH0sCiAgICAgICAgLyoqCiAgICAgICAgICog54K55Ye755yBCiAgICAgICAgICogQHBhcmFtIGluZGV4CiAgICAgICAgICovCiAgICAgICAgY2hlY2tlZENsaWNrOiBmdW5jdGlvbiAoaW5kZXgpIHsKICAgICAgICAgICAgbGV0IHRoYXQgPSB0aGlzCiAgICAgICAgICAgIGlmICh0aGF0LmNpdHlMaXN0W2luZGV4XS5jaGVja2VkKSB7CiAgICAgICAgICAgICAgICB0aGF0LiRzZXQodGhhdC5jaXR5TGlzdFtpbmRleF0sICdjb3VudCcsIHRoYXQuY2l0eUxpc3RbaW5kZXhdLmNoaWxkcmVuLmxlbmd0aCkKICAgICAgICAgICAgICAgIHRoYXQuY2l0eUxpc3RbaW5kZXhdLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGtleSkgewogICAgICAgICAgICAgICAgICAgIHRoYXQuJHNldCh0aGF0LmNpdHlMaXN0W2luZGV4XS5jaGlsZHJlbltrZXldLCAnY2hlY2tlZCcsIHRydWUpCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhhdC4kc2V0KHRoYXQuY2l0eUxpc3RbaW5kZXhdLCAnY291bnQnLCAwKQogICAgICAgICAgICAgICAgdGhhdC4kc2V0KHRoYXQuY2l0eUxpc3RbaW5kZXhdLCAnY2hlY2tlZCcsIGZhbHNlKQogICAgICAgICAgICAgICAgdGhhdC5jaXR5TGlzdFtpbmRleF0uY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwga2V5KSB7CiAgICAgICAgICAgICAgICAgICAgdGhhdC4kc2V0KHRoYXQuY2l0eUxpc3RbaW5kZXhdLmNoaWxkcmVuW2tleV0sICdjaGVja2VkJywgZmFsc2UpCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgdGhhdC5pU3NlbGVjdCA9IGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gdGhpcy5yZW5kZXIoKTsKICAgICAgICB9LAogICAgICAgIC8qKgogICAgICAgICAqIOeCueWHu+W4guWMugogICAgICAgICAqIEBwYXJhbSBpbmRleAogICAgICAgICAqIEBwYXJhbSBpbmQKICAgICAgICAgKi8KICAgICAgICBwcmltYXJ5OiBmdW5jdGlvbiAoaW5kZXgsIGluZCkgewogICAgICAgICAgICBsZXQgY2hlY2tlZCA9IGZhbHNlLCBjb3VudCA9IDAKICAgICAgICAgICAgdGhpcy5jaXR5TGlzdFtpbmRleF0uY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwga2V5KSB7CiAgICAgICAgICAgICAgICBpZiAoaXRlbS5jaGVja2VkKSB7CiAgICAgICAgICAgICAgICAgICAgY2hlY2tlZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICBjb3VudCsrCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmNpdHlMaXN0W2luZGV4XSwgJ2NvdW50JywgY291bnQpCiAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmNpdHlMaXN0W2luZGV4XSwgJ2NoZWNrZWQnLCBjaGVja2VkKQogICAgICAgICAgICAvLyB0aGlzLnJlbmRlcigpOwogICAgICAgIH0sCiAgICAgICAgLy8g56Gu5a6aOwogICAgICAgIGNvbmZpcm0gKCkgewogICAgICAgICAgICBsZXQgdGhhdCA9IHRoaXMKICAgICAgICAgICAgLy8g6KKr6YCJ5Lit55qE55yB5biC77ybCiAgICAgICAgICAgIGxldCBzZWxlY3RMaXN0ID0gW10KICAgICAgICAgICAgdGhhdC5jaXR5TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBrZXkpIHsKICAgICAgICAgICAgICAgIGxldCBkYXRhID0ge30KICAgICAgICAgICAgICAgIGlmIChpdGVtLmNoZWNrZWQpIHsKICAgICAgICAgICAgICAgICAgICBkYXRhID0gewogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgIGNpdHlfaWQ6IGl0ZW0uY2l0eV9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW46IFtdCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhhdC5jaXR5TGlzdFtrZXldLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGksIGspIHsKICAgICAgICAgICAgICAgICAgICBpZiAoaS5jaGVja2VkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuY2hpbGRyZW4ucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaXR5X2lkOiBpLmNpdHlfaWQKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgaWYgKGRhdGEuY2l0eV9pZCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZWN0TGlzdC5wdXNoKGRhdGEpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGVjdExpc3QpCiAgICAgICAgICAgIGlmIChzZWxlY3RMaXN0Lmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoYXQuJE1lc3NhZ2UuZXJyb3IoJ+iHs+WwkemAieaLqeS4gOS4quecgeS7veaIluiAheWfjuW4gicpCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdzZWxlY3RDaXR5Jywgc2VsZWN0TGlzdCwgdGhpcy50eXBlKQogICAgICAgICAgICAgICAgdGhhdC5hZGRyZXNzTW9kYWwgPSBmYWxzZQogICAgICAgICAgICAgICAgdGhpcy5jaXR5TGlzdCA9IFtdCiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gcGFyZW50LnNlbGVjdENpdHkoc2VsZWN0TGlzdCx0eXBlKTsKICAgICAgICAgICAgLy8gdmFyIGluZGV4ID0gcGFyZW50LmxheWVyLmdldEZyYW1lSW5kZXgod2luZG93Lm5hbWUpOwogICAgICAgICAgICAvLyBwYXJlbnQubGF5ZXIuY2xvc2UoaW5kZXgpOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhzZWxlY3RMaXN0KTsKICAgICAgICB9LAogICAgICAgIGNsb3NlICgpIHsKICAgICAgICAgICAgdGhpcy5hZGRyZXNzTW9kYWwgPSBmYWxzZQogICAgICAgICAgICB0aGlzLmNpdHlMaXN0ID0gW10KICAgICAgICB9CiAgICB9LAogICAgbW91bnRlZCAoKSB7CiAgICAgICAgLy8gdGhpcy5nZXRDaXR5TGlzdCgpOwogICAgfQp9Cg=="},{"version":3,"sources":["city.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"city.vue","sourceRoot":"src/components/freightTemplate","sourcesContent":["<template>\n    <div>\n        <Modal\n                v-model=\"addressModal\"\n                title=\"选择可配送区域\"\n                width=\"50%\"\n                class=\"modal\"\n                :mask=\"true\"\n        >\n            <Row :gutter=\"24\" type=\"flex\">\n                <Col :xl=\"24\" :lg=\"24\" :md=\"24\" :sm=\"24\" :xs=\"24\" class=\"item\">\n                    <div class=\"acea-row row-right row-middle\">\n                        <Checkbox v-model=\"iSselect\" @on-change=\"allCheckbox\">全选</Checkbox>\n                        <div class=\"empty\" @click=\"empty\">清空</div>\n                    </div>\n                </Col>\n            </Row>\n                <Row :gutter=\"24\" type=\"flex\" :loading=\"loading\">\n                    <Col :xl=\"6\" :lg=\"6\" :md=\"6\" :sm=\"8\" :xs=\"6\" class=\"item\" v-for=\"(item,index) in cityList\" :key=\"index\">\n                        <div @mouseenter=\"enter(index)\" @mouseleave=\"leave()\">\n                            <Checkbox v-model=\"item.checked\" :label=\"item.name\" @on-change=\"checkedClick(index)\">{{item.name}}</Checkbox><span class=\"red\">({{(item.count || 0) + '/' + item.children.length}})</span>\n                            <div class=\"city\" v-show=\"activeCity===index\">\n                                <div class=\"checkBox\">\n                                    <div class=\"arrow\"></div>\n                                        <div>\n                                            <Checkbox v-model=\"city.checked\" :label=\"city.name\" @on-change=\"primary(index,indexn)\" class=\"itemn\" v-for=\"(city,indexn) in item.children\" :key=\"indexn\">{{city.name}}</Checkbox>\n                                        </div>\n                                </div>\n                            </div>\n                        </div>\n                    </Col>\n                </Row>\n            <div slot=\"footer\">\n                <Button @click=\"close\">取消</Button>\n                <Button type=\"primary\" @click=\"confirm\">确定</Button>\n            </div>\n            <Spin size=\"large\" fix v-if=\"loading\"></Spin>\n        </Modal>\n    </div>\n</template>\n\n<script>\n    import { mapState } from 'vuex'\n    import { templatesCityListApi } from '@/api/setting'\n    export default {\n        name: 'city',\n        props: {\n            type: {\n                type: Number,\n                default: 0\n            }\n        },\n        data () {\n            return {\n                iSselect: false,\n                addressModal: false,\n                cityList: [],\n                activeCity: -1,\n                loading: false\n            }\n        },\n        computed: {\n        },\n        methods: {\n            enter (index) {\n                this.activeCity = index\n            },\n            leave () {\n                this.activeCity = null\n            },\n            getCityList () {\n                this.loading = true\n                templatesCityListApi().then(res => {\n                    this.loading = false\n                    this.cityList = res.data\n                })\n            },\n            /**\n             * 全选或者反选\n             * @param checked\n             */\n            allCheckbox: function () {\n                let that = this, checked = this.iSselect\n                that.cityList.forEach(function (item, key) {\n                    that.$set(that.cityList[key], 'checked', checked)\n                    if (checked) {\n                        that.$set(that.cityList[key], 'count', that.cityList[key].children.length)\n                    } else {\n                        that.$set(that.cityList[key], 'count', 0)\n                    }\n                    that.cityList[key].children.forEach(function (val, k) {\n                        that.$set(that.cityList[key].children[k], 'checked', checked)\n                    })\n                })\n                // this.render();\n            },\n            // 清空；\n            empty () {\n                let that = this\n                that.cityList.forEach(function (item, key) {\n                    that.$set(that.cityList[key], 'checked', false)\n                    that.cityList[key].children.forEach(function (val, k) {\n                        that.$set(that.cityList[key].children[k], 'checked', false)\n                    })\n                    that.$set(that.cityList[key], 'count', 0)\n                })\n                this.iSselect = false\n            },\n            /**\n             * 点击省\n             * @param index\n             */\n            checkedClick: function (index) {\n                let that = this\n                if (that.cityList[index].checked) {\n                    that.$set(that.cityList[index], 'count', that.cityList[index].children.length)\n                    that.cityList[index].children.forEach(function (item, key) {\n                        that.$set(that.cityList[index].children[key], 'checked', true)\n                    })\n                } else {\n                    that.$set(that.cityList[index], 'count', 0)\n                    that.$set(that.cityList[index], 'checked', false)\n                    that.cityList[index].children.forEach(function (item, key) {\n                        that.$set(that.cityList[index].children[key], 'checked', false)\n                    })\n                    that.iSselect = false\n                }\n                // this.render();\n            },\n            /**\n             * 点击市区\n             * @param index\n             * @param ind\n             */\n            primary: function (index, ind) {\n                let checked = false, count = 0\n                this.cityList[index].children.forEach(function (item, key) {\n                    if (item.checked) {\n                        checked = true\n                        count++\n                    }\n                })\n                this.$set(this.cityList[index], 'count', count)\n                this.$set(this.cityList[index], 'checked', checked)\n                // this.render();\n            },\n            // 确定;\n            confirm () {\n                let that = this\n                // 被选中的省市；\n                let selectList = []\n                that.cityList.forEach(function (item, key) {\n                    let data = {}\n                    if (item.checked) {\n                        data = {\n                            name: item.name,\n                            city_id: item.city_id,\n                            children: []\n                        }\n                    }\n                    that.cityList[key].children.forEach(function (i, k) {\n                        if (i.checked) {\n                            data.children.push({\n                                city_id: i.city_id\n                            })\n                        }\n                    })\n                    if (data.city_id !== undefined) {\n                        selectList.push(data)\n                    }\n                })\n                console.log(selectList)\n                if (selectList.length === 0) {\n                    return that.$Message.error('至少选择一个省份或者城市')\n                } else {\n                    this.$emit('selectCity', selectList, this.type)\n                    that.addressModal = false\n                    this.cityList = []\n                }\n                // parent.selectCity(selectList,type);\n                // var index = parent.layer.getFrameIndex(window.name);\n                // parent.layer.close(index);\n                // console.log(selectList);\n            },\n            close () {\n                this.addressModal = false\n                this.cityList = []\n            }\n        },\n        mounted () {\n            // this.getCityList();\n        }\n    }\n</script>\n\n<style scoped lang=\"stylus\">\n    .modal .item{margin-bottom:20px;}\n    .modal .item .city{position:absolute;z-index:9;top:17px;width:100%;padding-top:18px;}\n    .modal .item .city .checkBox{width:97%;padding:10px;border:1px solid #eee;background-color:#fff;max-height:100px;overflow-x:hidden;overflow-y:auto;}\n    .modal .item .city .checkBox .arrow{position: absolute;top:3px;width: 0;height: 0;\n        border: 8px solid transparent;border-bottom-color:#ddd;}\n    .modal .item .city .checkBox .arrow:before{position: absolute;bottom: -8px;right: -7px;content: \"\";width: 0;height: 0;border: 7px solid transparent;border-bottom-color: #fff;}\n    .modal .item .city .checkBox .itemn{margin-bottom:10px;}\n    .radio{padding: 5px 0;font-size:14px!important;}\n    .red{color:#ff0000;}\n    .empty{cursor: pointer;}\n</style>\n"]}]}