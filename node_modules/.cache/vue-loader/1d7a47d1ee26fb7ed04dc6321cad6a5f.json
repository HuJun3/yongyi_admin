{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/pages/user/list/index.vue?vue&type=style&index=0&id=54fabd91&scoped=true&lang=stylus&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/pages/user/list/index.vue","mtime":1610682376000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoucGljQm94CiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAudXBMb2FkCiAgICAgICAgd2lkdGg6IDU4cHg7CiAgICAgICAgaGVpZ2h0OiA1OHB4OwogICAgICAgIGxpbmUtaGVpZ2h0OiA1OHB4OwogICAgICAgIGJvcmRlcjogMXB4IGRvdHRlZCByZ2JhKDAsIDAsIDAsIDAuMSk7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4OwogICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4wMik7CiAgICAucGljdHJ1ZQogICAgICAgIHdpZHRoOiA2MHB4OwogICAgICAgIGhlaWdodDogNjBweDsKICAgICAgICBib3JkZXI6IDFweCBkb3R0ZWQgcmdiYSgwLCAwLCAwLCAwLjEpOwogICAgICAgIG1hcmdpbi1yaWdodDogMTBweDsKICAgICAgICBpbWcKICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgIGhlaWdodDogMTAwJTsKLnVzZXJGcm9tCiAgICA+Pj4gLml2dS1mb3JtLWl0ZW0tY29udGVudAogICAgICAgIG1hcmdpbi1sZWZ0OiAwcHggIWltcG9ydGFudAoudXNlckFsZXJ0CiAgICBtYXJnaW4tdG9wIDIwcHgKLnVzZXJJCiAgICBjb2xvciAjMTg5MEZGCiAgICBmb250LXN0eWxlIG5vcm1hbAppbWd7aGVpZ2h0OjM2cHg7ZGlzcGxheTpibG9jazt9Ci50YWJCb3hfaW1nCiAgICB3aWR0aCAzNnB4CiAgICBoZWlnaHQgMzZweAogICAgYm9yZGVyLXJhZGl1czo0cHg7CiAgICBjdXJzb3IgcG9pbnRlcgogICAgaW1nCiAgICAgICAgd2lkdGggMTAwJQogICAgICAgIGhlaWdodCAxMDAlCi50YWJCb3hfdGl0CiAgICB3aWR0aCA2MCUKICAgIGZvbnQtc2l6ZSAxMnB4ICFpbXBvcnRhbnQKICAgIG1hcmdpbiAwIDJweCAwIDEwcHgKICAgIGxldHRlci1zcGFjaW5nOiAxcHg7CiAgICBwYWRkaW5nOiA1cHggMDsKICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7Ci5tb2RlbEJveAogICAgPj4+IC5pdnUtbW9kYWwtYm9keQogICAgICAgIHBhZGRpbmcgMCAxNnB4IDE2cHggMTZweCAhaW1wb3J0YW50Ci52aXBOYW1lCiAgICBjb2xvcjogI2RhYjE3NgoubGlzdGJveAogICAgPj4+Lml2dS1kaXZpZGVyLWhvcml6b250YWwKICAgICAgICBtYXJnaW4gMCAhaW1wb3J0YW50Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAm1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/user/list","sourcesContent":["<template>\n    <div>\n        <div class=\"i-layout-page-header\">\n            <div class=\"i-layout-page-header\">\n                <span class=\"ivu-page-header-title\">用户管理</span>\n                <div>\n                    <Tabs @on-click=\"onClickTab\">\n                        <TabPane :label=\"item.name\" :name=\"item.type\" v-for=\"(item,index) in headeNum\" :key=\"index\"/>\n                    </Tabs>\n                </div>\n            </div>\n        </div>\n        <Card :bordered=\"false\" dis-hover class=\"ivu-mt listbox\">\n            <Form ref=\"userFrom\" :model=\"userFrom\"  :label-width=\"labelWidth\" :label-position=\"labelPosition\" @submit.native.prevent>\n                <Row :gutter=\"16\">\n                    <Col  span=\"18\">\n                        <Col span=\"24\">\n                            <Col v-bind=\"grid\">\n                                <FormItem label=\"用户搜索：\"  label-for=\"nickname\">\n                                  <Input v-model=\"userFrom.nickname\" placeholder=\"请输入\" element-id=\"nickname\" clearable >\n                                    <Select v-model=\"field_key\" slot=\"prepend\" style=\"width: 80px\">\n                                      <Option value=\"all\">全部</Option>\n                                      <Option value=\"uid\">UID</Option>\n                                      <Option value=\"phone\">手机号</Option>\n                                      <Option value=\"nickname\">用户昵称</Option>\n                                    </Select>\n                                  </Input>\n                                </FormItem>\n                            </Col>\n                        </Col>\n                    </Col>\n                    <template v-if=\"collapse\">\n                        <Col span=\"18\">\n                            <Col v-bind=\"grid\">\n                                <FormItem label=\"用户等级：\"  label-for=\"level\">\n                                    <Select v-model=\"level\" placeholder=\"请选择\" element-id=\"level\" clearable>\n                                        <Option value=\"all\">全部</Option>\n                                        <Option :value=\"item.id\" v-for=\"(item, index) in levelList\" :key=\"index\">{{item.name}}</Option>\n                                    </Select>\n                                </FormItem>\n                            </Col>\n                            <Col v-bind=\"grid\">\n                                <FormItem label=\"用户分组：\"  label-for=\"group_id\">\n                                    <Select v-model=\"group_id\" placeholder=\"请选择\" element-id=\"group_id\" clearable>\n                                        <Option value=\"all\">全部</Option>\n                                        <Option :value=\"item.id\" v-for=\"(item, index) in groupList\" :key=\"index\">{{item.group_name}}</Option>\n                                    </Select>\n                                </FormItem>\n                            </Col>\n                            <Col v-bind=\"grid\">\n                                <FormItem label=\"用户标签：\"  label-for=\"label_id\">\n                                    <Select v-model=\"label_id\" placeholder=\"请选择\" element-id=\"label_id\" clearable>\n                                        <Option value=\"all\">全部</Option>\n                                        <Option :value=\"item.id\" v-for=\"(item, index) in labelLists\" :key=\"index\">{{item.label_name}}</Option>\n                                    </Select>\n                                </FormItem>\n                            </Col>\n                        </Col>\n                        <Col span=\"18\">\n                            <Col v-bind=\"grid\">\n                                <FormItem label=\"国家：\"  label-for=\"country\">\n                                    <Select v-model=\"userFrom.country\" placeholder=\"请选择\" element-id=\"country\" clearable @on-change=\"changeCountry\">\n                                        <Option value=\"domestic\">中国</Option>\n                                        <Option value=\"abroad\">外国</Option>\n                                    </Select>\n                                </FormItem>\n                            </Col>\n                            <Col v-bind=\"grid\" v-if=\"userFrom.country ==='domestic'\">\n                                <FormItem label=\"省份：\">\n                                    <Cascader :data=\"addresData\" :value=\"address\" v-model=\"address\" @on-change=\"handleChange\"></Cascader>\n                                </FormItem>\n                            </Col>\n                        </Col>\n                        <Col span=\"18\">\n                            <Col v-bind=\"grid\">\n                                <FormItem label=\"性别：\"  label-for=\"sex\">\n                                    <RadioGroup v-model=\"userFrom.sex\" type=\"button\">\n                                        <Radio label=\"\">\n                                            <span>全部</span>\n                                        </Radio>\n                                        <Radio label=\"1\">\n                                            <span>男</span>\n                                        </Radio>\n                                        <Radio label=\"2\">\n                                            <span>女</span>\n                                        </Radio>\n                                        <Radio label=\"0\">\n                                            <span>保密</span>\n                                        </Radio>\n                                    </RadioGroup>\n                                </FormItem>\n                            </Col>\n                            <Col v-bind=\"grid\">\n                                <FormItem label=\"身份：\"  label-for=\"is_promoter\">\n                                    <RadioGroup v-model=\"userFrom.is_promoter\" type=\"button\">\n                                        <Radio label=\"\">\n                                            <span>全部</span>\n                                        </Radio>\n                                        <Radio label=\"1\">\n                                            <span>推广员</span>\n                                        </Radio>\n                                        <Radio label=\"0\">\n                                            <span>普通用户</span>\n                                        </Radio>\n                                    </RadioGroup>\n                                </FormItem>\n                            </Col>\n                        </Col>\n                        <Col span=\"18\">\n                            <Col v-bind=\"grid\">\n                                <FormItem label=\"访问情况：\"  label-for=\"user_time_type\">\n                                    <Select v-model=\"user_time_type\" placeholder=\"请选择\" element-id=\"user_time_type\" clearable>\n                                        <Option value=\"all\">全部</Option>\n                                        <Option value=\"visitno\">时间段未访问</Option>\n                                        <Option value=\"visit\">时间段访问过</Option>\n                                        <Option value=\"add_time\">首次访问</Option>\n                                    </Select>\n                                </FormItem>\n                            </Col>\n                            <Col v-bind=\"grid\">\n                                <FormItem label=\"下单次数：\"  label-for=\"pay_count\">\n                                    <Select v-model=\"pay_count\" placeholder=\"请选择\" element-id=\"pay_count\" clearable>\n                                        <Option value=\"all\">全部</Option>\n                                        <Option value=\"-1\">0次</Option>\n                                        <Option value=\"0\">1次以上</Option>\n                                        <Option value=\"1\">2次以上</Option>\n                                        <Option value=\"2\">3次以上</Option>\n                                        <Option value=\"3\">4次以上</Option>\n                                        <Option value=\"4\">5次以上</Option>\n                                    </Select>\n                                </FormItem>\n                            </Col>\n                        </Col>\n                        <Col span=\"18\">\n                            <Col v-bind=\"grid\">\n                                <FormItem label=\"选择时间：\"  label-for=\"user_time\">\n                                    <!--<DatePicker clearable @on-change=\"onchangeTime\" v-model=\"timeVal\" :value=\"timeVal\"  format=\"yyyy/MM/dd\" type=\"daterange\" placement=\"bottom-end\" placeholder=\"选择时间\" v-width=\"'100%'\"></DatePicker>-->\n                                    <DatePicker :editable=\"false\" @on-change=\"onchangeTime\" :value=\"timeVal\" format=\"yyyy/MM/dd\"\n                                                type=\"datetimerange\" placement=\"bottom-start\" placeholder=\"自定义时间\"\n                                                style=\"width: 300px;\" class=\"mr20\" :options=\"options\"></DatePicker>\n                                </FormItem>\n                            </Col>\n                        </Col>\n                    </template>\n                    <Col span=\"6\" class=\"ivu-text-right userFrom\">\n                        <FormItem>\n                            <Button type=\"primary\" icon=\"ios-search\" label=\"default\" class=\"mr15\"  @click=\"userSearchs\">搜索</Button>\n                            <Button class=\"ResetSearch\" @click=\"reset('userFrom')\">重置</Button>\n                            <a class=\"ivu-ml-8 font14 ml10\" @click=\"collapse = !collapse\">\n                                <template v-if=\"!collapse\">\n                                    展开 <Icon type=\"ios-arrow-down\" />\n                                </template>\n                                <template v-else>\n                                    收起 <Icon type=\"ios-arrow-up\" />\n                                </template>\n                            </a>\n                        </FormItem>\n                    </Col>\n                </Row>\n            </Form>\n            <Divider dashed />\n            <Row type=\"flex\" justify=\"space-between\" class=\"mt20\">\n                <Col span=\"24\">\n                    <Button v-auth=\"['admin-user-save']\" type=\"primary\" class=\"mr20\" @click=\"save\">添加用户</Button>\n                    <Button v-auth=\"['admin-user-coupon']\" class=\"mr20\" @click=\"onSend\">发送优惠券</Button>\n                    <Button v-auth=\"['admin-wechat-news']\" class=\"greens mr20\" size=\"default\" @click=\"onSendPic\" v-if=\"userFrom.user_type === 'wechat'\">\n                        <Icon type=\"md-list\"></Icon>\n                        发送图文消息\n                    </Button>\n                    <Button v-auth=\"['admin-user-group_set']\" class=\"mr20\" @click=\"setGroup\">批量设置分组</Button>\n                    <Button v-auth=\"['admin-user-set_label']\" class=\"mr20\" @click=\"setLabel\">批量设置标签</Button>\n\n                    <Button v-auth=\"['admin-user-synchro']\" class=\"mr20\" @click=\"synchro\">同步公众号用户</Button>\n                </Col>\n                <Col span=\"24\" class=\"userAlert\" v-if=\"selectionList.length\">\n                    <Alert show-icon> 已选择<i class=\"userI\"> {{selectionList.length}} </i>项</Alert>\n                </Col>\n            </Row>\n            <Table :columns=\"columns\" :data=\"userLists\" class=\"mt25\"\n                   ref=\"table\" highlight-row\n                   :loading=\"loading\"\n                   no-userFrom-text=\"暂无数据\"\n                   no-filtered-userFrom-text=\"暂无筛选结果\"\n                   @on-selection-change=\"onSelectTab\"\n                   @on-sort-change=\"sortChanged\"\n            >\n                <template slot-scope=\"{ row, index }\" slot=\"avatars\">\n                    <div class=\"tabBox_img\" v-viewer>\n                        <img v-lazy=\"row.avatar\">\n                    </div>\n                </template>\n                <template slot-scope=\"{ row, index }\" slot=\"nickname\">\n                    <div class=\"acea-row\">\n                        <Icon type=\"md-male\" v-show=\"row.sex==='男'\" color=\"#2db7f5\" size=\"15\" class=\"mr5\"/>\n                        <Icon type=\"md-female\" v-show=\"row.sex==='女'\" color=\"#ed4014\" size=\"15\" class=\"mr5\"/>\n                        <div v-text=\"row.nickname\"></div>\n                    </div>\n                </template>\n                <template slot-scope=\"{ row, index }\" slot=\"isMember\">\n                    <div>{{row.isMember?'是':'否'}}</div>\n                </template>\n                <template slot-scope=\"{ row, index }\" slot=\"action\">\n                    <a @click=\"edit(row)\">编辑</a>\n                    <Divider type=\"vertical\" />\n                    <template>\n                        <Dropdown @on-click=\"changeMenu(row,$event,index)\">\n                            <a href=\"javascript:void(0)\">\n                                更多\n                                <Icon type=\"ios-arrow-down\"></Icon>\n                            </a>\n                            <DropdownMenu slot=\"list\">\n                                <DropdownItem name=\"1\">账户详情</DropdownItem>\n                                <DropdownItem name=\"2\">积分余额</DropdownItem>\n                                <DropdownItem name=\"5\">设置分组</DropdownItem>\n                                <DropdownItem name=\"6\">设置标签</DropdownItem>\n                                <DropdownItem name=\"7\">修改上级推广人</DropdownItem>\n                                <DropdownItem name=\"8\" v-if=\"row.spread_uid\">清除上级推广人</DropdownItem>\n                            </DropdownMenu>\n                        </Dropdown>\n                    </template>\n                </template>\n            </Table>\n            <div class=\"acea-row row-right page\">\n                <Page :total=\"total\" :current=\"userFrom.page\" show-elevator show-total @on-change=\"pageChange\"\n                      :page-size=\"userFrom.limit\"  /></div>\n        </Card>\n        <!-- 编辑表单 积分余额-->\n        <edit-from ref=\"edits\" :FromData=\"FromData\" @submitFail=\"submitFail\"></edit-from>\n        <!-- 发送优惠券-->\n        <send-from ref=\"sends\" :userIds=\"user_ids\"></send-from>\n        <!-- 会员详情-->\n        <user-details ref=\"userDetails\"></user-details>\n        <!--发送图文消息 -->\n        <Modal v-model=\"modal13\" scrollable title=\"发送消息\" width=\"1200\" height=\"800\" footer-hide class=\"modelBox\">\n            <news-category v-if=\"modal13\" :isShowSend=\"isShowSend\" :userIds=\"user_ids\" :scrollerHeight=\"scrollerHeight\" :contentTop=\"contentTop\" :contentWidth=\"contentWidth\" :maxCols=\"maxCols\"></news-category>\n        </Modal>\n        <!--修改推广人-->\n        <Modal v-model=\"promoterShow\" scrollable title=\"修改推广人\" class=\"order_box\" :closable=\"false\">\n            <Form ref=\"formInline\" :model=\"formInline\" :label-width=\"100\" @submit.native.prevent>\n                <FormItem label=\"用户头像：\" prop=\"image\">\n                    <div class=\"picBox\" @click=\"customer\">\n                        <div class=\"pictrue\" v-if=\"formInline.image\"><img v-lazy=\"formInline.image\"></div>\n                        <div class=\"upLoad acea-row row-center-wrapper\" v-else>\n                            <Icon type=\"ios-camera-outline\" size=\"26\"/>\n                        </div>\n                    </div>\n                </FormItem>\n            </Form>\n            <div slot=\"footer\">\n                <Button type=\"primary\" @click=\"putSend('formInline')\">提交</Button>\n                <Button @click=\"cancel('formInline')\">取消</Button>\n            </div>\n        </Modal>\n        <Modal v-model=\"customerShow\" scrollable title=\"请选择商城用户\" :closable=\"false\" width=\"50%\">\n            <customerInfo @imageObject=\"imageObject\"></customerInfo>\n        </Modal>\n        <Modal v-model=\"labelShow\" scrollable title=\"请选择用户标签\" :closable=\"false\" width=\"320\" :footer-hide=\"true\">\n            <userLabel :uid=\"labelActive.uid\" @close=\"labelClose\"></userLabel>\n        </Modal>\n\n    </div>\n</template>\n\n<script>\n    import userLabel from \"../../../components/userLabel\";\n    import { mapState } from 'vuex';\n    import expandRow from './tableExpand.vue';\n    import { userList, getUserData, isShowApi, editOtherApi, giveLevelApi, userSetGroup, userGroupApi, levelListApi, userSetLabelApi, userLabelApi, userSynchro,getUserSaveForm,giveLevelTimeApi } from '@/api/user';\n    import { agentSpreadApi } from '@/api/agent'\n    import editFrom from '../../../components/from/from';\n    import sendFrom from '@/components/sendCoupons/index';\n    import userDetails from './handle/userDetails';\n    import newsCategory from '@/components/newsCategory/index';\n    import city from '@/utils/city';\n    import customerInfo from '@/components/customerInfo'\n    export default {\n        name: 'user_list',\n        components: { expandRow, editFrom, sendFrom, userDetails, newsCategory, customerInfo,userLabel },\n        data () {\n            return {\n                labelShow:false,\n                customerShow: false,\n                promoterShow: false,\n                labelActive:{\n                  uid:0\n                },\n                formInline: {\n                    uid:0,\n                    spread_uid:0,\n                    image:''\n                },\n                options: {\n                    shortcuts: [\n                        {\n                            text: '今天',\n                            value () {\n                                const end = new Date();\n                                const start = new Date();\n                                start.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate()));\n                                return [start, end];\n                            }\n                        },\n                        {\n                            text: '昨天',\n                            value () {\n                                const end = new Date();\n                                const start = new Date();\n                                start.setTime(start.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate() - 1)));\n                                end.setTime(end.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate() - 1)));\n                                return [start, end];\n                            }\n                        },\n                        {\n                            text: '最近7天',\n                            value () {\n                                const end = new Date();\n                                const start = new Date();\n                                start.setTime(start.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate() - 6)));\n                                return [start, end];\n                            }\n                        },\n                        {\n                            text: '最近30天',\n                            value () {\n                                const end = new Date();\n                                const start = new Date();\n                                start.setTime(start.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate() - 29)));\n                                return [start, end];\n                            }\n                        },\n                        {\n                            text: '本月',\n                            value () {\n                                const end = new Date();\n                                const start = new Date();\n                                start.setTime(start.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), 1)));\n                                return [start, end];\n                            }\n                        },\n                        {\n                            text: '本年',\n                            value () {\n                                const end = new Date();\n                                const start = new Date();\n                                start.setTime(start.setTime(new Date(new Date().getFullYear(), 0, 1)));\n                                return [start, end];\n                            }\n                        }\n                    ]\n                },\n                collapse: false,\n                headeNum: [\n                    { 'type': '', 'name': '全部' },\n                    { 'type': 'wechat', 'name': '微信公众号' },\n                    { 'type': 'routine', 'name': '微信小程序' },\n                    { 'type': 'h5', 'name': 'H5' },\n                    { 'type': 'pc', 'name': 'PC' }\n                ],\n                address: [],\n                addresData: city,\n                isShowSend: true,\n                modal13: false,\n                maxCols: 4,\n                scrollerHeight: '600',\n                contentTop: '130',\n                contentWidth: '98%',\n                grid: {\n                    xl: 8,\n                    lg: 8,\n                    md: 12,\n                    sm: 24,\n                    xs: 24\n                },\n                grid2: {\n                    xl: 18,\n                    lg: 16,\n                    md: 12,\n                    sm: 24,\n                    xs: 24\n                },\n                loading: false,\n                total: 0,\n                userFrom: {\n                    label_id: '',\n                    user_type: '',\n                    status: '',\n                    sex: '',\n                    is_promoter: '',\n                    country: '',\n                    isMember: '',\n                    pay_count: '',\n                    user_time_type: '',\n                    user_time: '',\n                    nickname: '',\n                    province: '',\n                    city: '',\n                    page: 1,\n                    limit: 15,\n                    level: '',\n                    group_id: '',\n                    field_key:'',\n                },\n                field_key: '',\n                level: '',\n                group_id: '',\n                label_id:'',\n                user_time_type:'',\n                pay_count:'',\n                columns: [\n                    {\n                        type: 'expand',\n                        width: 40,\n                        render: (h, params) => {\n                            return h(expandRow, {\n                                props: {\n                                    row: params.row\n                                }\n                            })\n                        }\n                    },\n                    {\n                        type: 'selection',\n                        width: 60,\n                        align: 'center'\n                    },\n                    {\n                        title: 'ID',\n                        key: 'uid',\n                        width: 80\n                    },\n                    {\n                        title: '头像',\n                        slot: 'avatars',\n                        minWidth: 60\n                    },\n                    {\n                        title: '姓名',\n                        slot: 'nickname',\n                        minWidth: 150\n                    },\n                    {\n                        title: '用户等级',\n                        key: 'level',\n                        minWidth: 90\n                    },\n                    {\n                        title: '分组',\n                        key: 'group_id',\n                        minWidth: 100\n                    },\n                    {\n                        title: '手机号',\n                        key: 'phone',\n                        minWidth: 100\n                    },\n                    {\n                        title: '用户类型',\n                        key: 'user_type',\n                        minWidth: 100\n                    },\n                    {\n                        title: '余额',\n                        key: 'now_money',\n                        sortable: 'custom',\n                        minWidth: 100\n                    },\n                    {\n                        title: '操作',\n                        slot: 'action',\n                        fixed: 'right',\n                        minWidth: 120\n                    }\n                ],\n                userLists: [],\n                FromData: null,\n                selectionList: [],\n                user_ids: '',\n                selectedData: [],\n                timeVal: [],\n                array_ids: [],\n                groupList: [],\n                levelList: [],\n                labelFrom: {\n                    page: 1,\n                    limit: ''\n                },\n                labelLists: []\n            }\n        },\n        computed: {\n            ...mapState('media', [\n                'isMobile'\n            ]),\n            labelWidth () {\n                return this.isMobile ? undefined : 100;\n            },\n            labelPosition () {\n                return this.isMobile ? 'top' : 'right';\n            }\n        },\n        created () {\n            this.getList();\n        },\n        mounted () {\n            this.userGroup();\n            this.levelLists();\n            this.groupLists();\n        },\n        methods: {\n            // 标签弹窗关闭\n            labelClose(){\n              this.labelShow = false\n            },\n            // 提交\n            putSend (name) {\n                this.$refs[name].validate((valid) => {\n                    if (valid) {\n                        if(!this.formInline.spread_uid){\n                            return this.$Message.error('请上传用户');\n                        }\n                        agentSpreadApi(this.formInline).then(res => {\n                            this.promoterShow = false;\n                            this.$Message.success(res.msg);\n                            this.getList();\n                            this.$refs[name].resetFields();\n                        }).catch(res => {\n                            this.$Message.error(res.msg);\n                        })\n                    }\n                })\n            },\n            save () {\n                this.$modalForm(getUserSaveForm()).then(() => this.$refs.sends.getList());\n            },\n            synchro () {\n                userSynchro().then(res => {\n                    this.$Message.success(res.msg);\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                })\n            },\n            // 分组列表\n            groupLists () {\n                this.loading = true;\n                userLabelApi(this.labelFrom).then(async res => {\n                    let data = res.data;\n                    this.labelLists = data.list;\n                }).catch(res => {\n                    this.loading = false;\n                    this.$Message.error(res.msg);\n                })\n            },\n            onClickTab (type) {\n                this.userFrom.page = 1;\n                this.userFrom.user_type = type;\n                this.getList();\n            },\n            userGroup () {\n                let data = {\n                    page: 1,\n                    limit: ''\n                };\n                userGroupApi(data).then(res => {\n                    this.groupList = res.data.list;\n                })\n            },\n            levelLists () {\n                let data = {\n                    page: 1,\n                    limit: '',\n                    title: '',\n                    is_show: 1\n                };\n                levelListApi(data).then(res => {\n                    this.levelList = res.data.list;\n                })\n            },\n            // 批量设置分组；\n            setGroup () {\n                if (this.selectionList.length === 0) {\n                    this.$Message.warning('请选择要设置分组的用户');\n                } else {\n                    let uids = { uids: this.array_ids };\n                    this.$modalForm(userSetGroup(uids)).then(() => this.$refs.sends.getList());\n                }\n            },\n            // 批量设置标签；\n            setLabel () {\n                if (this.selectionList.length === 0) {\n                    this.$Message.warning('请选择要设置标签的用户');\n                } else {\n                    let uids = { uids: this.array_ids };\n                    this.$modalForm(userSetLabelApi(uids)).then(() => this.$refs.sends.getList());\n                }\n            },\n            // 选择国家\n            changeCountry () {\n                if (this.userFrom.country === 'abroad' || !this.userFrom.country) {\n                    this.selectedData = [];\n                    this.userFrom.province = '';\n                    this.userFrom.city = '';\n                    this.address = [];\n                }\n            },\n            // 选择地址\n            handleChange (value, selectedData) {\n                this.selectedData = selectedData.map(o => o.label);\n                this.userFrom.province = this.selectedData[0];\n                this.userFrom.city = this.selectedData[1];\n            },\n            // 具体日期\n            onchangeTime (e) {\n                this.timeVal = e;\n                this.userFrom.user_time = this.timeVal.join('-');\n            },\n            // 操作\n            changeMenu (row, name, index) {\n                let uid = [];\n                uid.push(row.uid);\n                let uids = { uids: uid };\n                switch (name) {\n                    case '1':\n                        this.$refs.userDetails.modals = true;\n                        this.$refs.userDetails.getDetails(row.uid);\n                        break;\n                    case '2':\n                        this.getOtherFrom(row.uid);\n                        break;\n                    case '4':\n                        this.del(row, '清除 【 ' + row.nickname + ' 】的会员等级', index,'user')\n                        break;\n                    case '5':\n                        this.$modalForm(userSetGroup(uids)).then(() => this.$refs.sends.getList());\n                        break;\n                    case '6':\n                        this.openLabel(row)\n                        break;\n                    case '7':\n                        this.editS(row)\n                        break\n                    default:\n                        this.del(row, '解除【 ' + row.nickname + ' 】的上级推广人', index,'tuiguang')\n                }\n            },\n            openLabel(row){\n                this.labelShow = true\n                this.labelActive.uid = row.uid\n            },\n            editS (row) {\n                this.promoterShow = true;\n                this.formInline.uid = row.uid;\n            },\n            customer () {\n                this.customerShow = true\n            },\n            imageObject (e) {\n                this.customerShow = false;\n                this.formInline.spread_uid = e.uid;\n                this.formInline.image = e.image;\n            },\n            cancel (name) {\n                this.promoterShow = false;\n                this.$refs[name].resetFields();\n            },\n            // 赠送会员等级\n            giveLevel (id) {\n                giveLevelApi(id).then(async res => {\n                    if (res.data.status === false) {\n                        return this.$authLapse(res.data);\n                    }\n                    this.FromData = res.data;\n                    this.$refs.edits.modals = true;\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                })\n            },\n            // 赠送会员等级\n            giveLevelTime (id) {\n                giveLevelTimeApi(id).then(async res => {\n                    if (res.data.status === false) {\n                        return this.$authLapse(res.data);\n                    }\n                    this.FromData = res.data;\n                    this.$refs.edits.modals = true;\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                })\n            },\n            // 删除\n            del (row, tit, num, name) {\n                let delfromData = {\n                    title: tit,\n                    num: num,\n                    url: name==='user'?`user/del_level/${row.uid}`:`agent/stair/delete_spread/${row.uid}`,\n                    method: name==='user'?'DELETE':'PUT',\n                    ids: ''\n                }\n                this.$modalSure(delfromData).then((res) => {\n                    this.$Message.success(res.msg);\n                    this.getList();\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                });\n            },\n            // 清除会员删除成功\n            submitModel () {\n                this.getList();\n            },\n            // 会员列表\n            getList () {\n                this.userFrom.user_type = this.userFrom.user_type || '';\n                this.userFrom.status = this.userFrom.status || '';\n                this.userFrom.sex = this.userFrom.sex || '';\n                this.userFrom.is_promoter = this.userFrom.is_promoter || '';\n                this.userFrom.country = this.userFrom.country || '';\n                this.userFrom.pay_count = this.pay_count === 'all'?'':this.pay_count;\n                this.userFrom.user_time_type = this.user_time_type === 'all'?'':this.user_time_type;\n                this.userFrom.label_id = this.label_id === 'all'?'':this.label_id;\n                this.userFrom.field_key = this.field_key === 'all'?'':this.field_key;\n                this.userFrom.level = this.level === 'all'?'':this.level;\n                this.userFrom.group_id = this.group_id === 'all'?'':this.group_id;\n                this.loading = true;\n                userList(this.userFrom).then(async res => {\n                    let data = res.data;\n                    this.userLists = data.list;\n                    this.total = data.count;\n                    this.loading = false;\n                }).catch(res => {\n                    this.loading = false;\n                    this.$Message.error(res.msg);\n                })\n            },\n            pageChange (index) {\n                this.selectionList = [];\n                this.userFrom.page = index\n                this.getList();\n            },\n            // 搜索\n            userSearchs () {\n                this.userFrom.page = 1;\n                this.getList();\n            },\n            // 重置\n            reset (name) {\n                this.userFrom = {\n                    user_type: '',\n                    status: '',\n                    sex: '',\n                    is_promoter: '',\n                    country: '',\n                    pay_count: '',\n                    user_time_type: '',\n                    user_time: '',\n                    nickname: '',\n                    field_key:'',\n                    level:'',\n                    group_id:'',\n                    label_id:'',\n                    page: 1, // 当前页\n                    limit: 20 // 每页显示条数\n                };\n                this.field_key = '';\n                this.level = '';\n                this.group_id = '';\n                this.label_id = '';\n                this.user_time_type = '';\n                this.pay_count = '';\n                this.timeVal = [];\n                this.getList();\n            },\n            // 获取编辑表单数据\n            getUserFrom (id) {\n                getUserData(id).then(async res => {\n                    if (res.data.status === false) {\n                        return this.$authLapse(res.data);\n                    }\n                    this.FromData = res.data;\n                    this.$refs.edits.modals = true;\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                })\n            },\n            // 获取积分余额表单\n            getOtherFrom (id) {\n                editOtherApi(id).then(async res => {\n                    if (res.data.status === false) {\n                        return this.$authLapse(res.data);\n                    }\n                    this.FromData = res.data;\n                    this.$refs.edits.modals = true;\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                })\n            },\n            // 修改状态\n            onchangeIsShow (row) {\n                let data = {\n                    id: row.uid,\n                    status: row.status\n                }\n                isShowApi(data).then(async res => {\n                    this.$Message.success(res.msg);\n                }).catch(res => {\n                    this.$Message.error(res.msg);\n                })\n            },\n            // 全选\n            onSelectTab (selection) {\n                this.selectionList = selection;\n                let data = [];\n                this.selectionList.map((item) => {\n                    data.push(item.uid)\n                });\n                this.array_ids = data;\n                this.user_ids = data.join(',');\n            },\n            // 点击发送优惠券\n            onSend () {\n                if (this.selectionList.length === 0) {\n                    this.$Message.warning('请选择要发送优惠券的用户');\n                } else {\n                    this.$refs.sends.modals = true;\n                    this.$refs.sends.getList()\n                }\n            },\n            // 发送图文消息\n            onSendPic () {\n                if (this.selectionList.length === 0) {\n                    this.$Message.warning('请选择要发送图文消息的用户');\n                } else {\n                    this.modal13 = true;\n                }\n            },\n            // 编辑\n            edit (row) {\n                this.getUserFrom(row.uid);\n            },\n            // 修改成功\n            submitFail () {\n                this.getList();\n            },\n            // 排序\n            sortChanged (e) {\n                this.userFrom[e.key] = e.order\n                this.getList();\n            }\n        }\n    }\n</script>\n\n<style scoped lang=\"stylus\">\n    .picBox\n        display: inline-block;\n        cursor: pointer;\n        .upLoad\n            width: 58px;\n            height: 58px;\n            line-height: 58px;\n            border: 1px dotted rgba(0, 0, 0, 0.1);\n            border-radius: 4px;\n            background: rgba(0, 0, 0, 0.02);\n        .pictrue\n            width: 60px;\n            height: 60px;\n            border: 1px dotted rgba(0, 0, 0, 0.1);\n            margin-right: 10px;\n            img\n                width: 100%;\n                height: 100%;\n    .userFrom\n        >>> .ivu-form-item-content\n            margin-left: 0px !important\n    .userAlert\n        margin-top 20px\n    .userI\n        color #1890FF\n        font-style normal\n    img{height:36px;display:block;}\n    .tabBox_img\n        width 36px\n        height 36px\n        border-radius:4px;\n        cursor pointer\n        img\n            width 100%\n            height 100%\n    .tabBox_tit\n        width 60%\n        font-size 12px !important\n        margin 0 2px 0 10px\n        letter-spacing: 1px;\n        padding: 5px 0;\n        box-sizing: border-box;\n    .modelBox\n        >>> .ivu-modal-body\n            padding 0 16px 16px 16px !important\n    .vipName\n        color: #dab176\n    .listbox\n        >>>.ivu-divider-horizontal\n            margin 0 !important\n</style>\n"]}]}