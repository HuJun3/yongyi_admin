{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/pages/kefu/appChat/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/pages/kefu/appChat/index.vue","mtime":1619614782000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAiZW1vamktYXdlc29tZS9kaXN0L2Nzcy9nb29nbGUubWluLmNzcyI7CmltcG9ydCBlbW9qaUxpc3QgZnJvbSAiQC91dGlscy9lbW9qaSI7CmltcG9ydCB7U29ja2V0fSBmcm9tICJAL2xpYnMvc29ja2V0IjsKaW1wb3J0IFNldHRpbmcgZnJvbSAiQC9zZXR0aW5nIjsKaW1wb3J0IENvb2tpZXMgZnJvbSAnanMtY29va2llJzsKaW1wb3J0IHsgY2hhdExpc3RBcGksIHNlcnZpY2VMaXN0QXBpLCBnZXRBZHZBcGksIHNlcnZpY2VMaXN0LCBnZXRPcmRlckFwaSxwcm9kdWN0QXBpIH0gZnJvbSAnQC9hcGkva2VmdSc7CmltcG9ydCBmZWVkQmFjayBmcm9tICcuL2ZlZWRiYWNrJzsKY29uc3QgY2h1bmsgPSBmdW5jdGlvbihhcnIsIG51bSkgewogICAgbnVtID0gbnVtICogMSB8fCAxOwogICAgdmFyIHJldCA9IFtdOwogICAgYXJyLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaSkgewogICAgICAgIGlmIChpICUgbnVtID09PSAwKSB7CiAgICAgICAgICAgIHJldC5wdXNoKFtdKTsKICAgICAgICB9CiAgICAgICAgcmV0W3JldC5sZW5ndGggLSAxXS5wdXNoKGl0ZW0pOwogICAgfSk7CiAgICByZXR1cm4gcmV0Owp9OwpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAiQ2hhdFJvb20iLAogICAgYXV0aDogZmFsc2UsCiAgICBjb21wb25lbnRzOnsKICAgICAgICBmZWVkQmFjawogICAgfSwKICAgIHByb3BzOiB7CiAgICAgICAgY2hhdE9wdGlvbnM6IHsKICAgICAgICAgICAgdHlwZTogT2JqZWN0LAogICAgICAgICAgICBkZWZhdWx0OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIHNob3c6IGZhbHNlLAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSwKICAgICAgICB9LAogICAgfSwKICAgIGRpcmVjdGl2ZXM6IHsKICAgICAgICBkcmFnOiB7CiAgICAgICAgICAgIGluc2VydGVkOiBmdW5jdGlvbiAoZWwpIHsKICAgICAgICAgICAgICAgIGxldCB4ID0gMDsKICAgICAgICAgICAgICAgIGxldCB5ID0gMDsKICAgICAgICAgICAgICAgIGxldCBsID0gMDsKICAgICAgICAgICAgICAgIGxldCB0ID0gMDsKICAgICAgICAgICAgICAgIGxldCBpc0Rvd24gPSBmYWxzZTsKICAgICAgICAgICAgICAgIGVsLm9ubW91c2Vkb3duID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICB4ID0gZS5jbGllbnRYOwogICAgICAgICAgICAgICAgICAgIHkgPSBlLmNsaWVudFk7CiAgICAgICAgICAgICAgICAgICAgbCA9IGVsLnBhcmVudE5vZGUub2Zmc2V0TGVmdDsKICAgICAgICAgICAgICAgICAgICB0ID0gZWwucGFyZW50Tm9kZS5vZmZzZXRUb3A7CiAgICAgICAgICAgICAgICAgICAgaXNEb3duID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICBlbC5zdHlsZS5jdXJzb3IgPSAibW92ZSI7CiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm9ubW91c2Vtb3ZlID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzRG93biA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBueCA9IGUuY2xpZW50WDsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG55ID0gZS5jbGllbnRZOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmwgPSBueCAtICh4IC0gbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBudCA9IG55IC0gKHkgLSB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgZWwucGFyZW50Tm9kZS5zdHlsZS5sZWZ0ID0gbmwgKyAicHgiOwogICAgICAgICAgICAgICAgICAgICAgICBlbC5wYXJlbnROb2RlLnN0eWxlLnRvcCA9IG50ICsgInB4IjsKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vbm1vdXNldXAgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlzRG93biA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICBlbC5zdHlsZS5jdXJzb3IgPSAiZGVmYXVsdCI7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vbm1vdXNlbW92ZSA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vbm1vdXNldXAgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSwKICAgICAgICB9LAogICAgfSwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgbG9jYXRpb25zOiBgJHtsb2NhdGlvbi5vcmlnaW59YCwKICAgICAgICAgICAgY2hhbmdlOiBmYWxzZSwKICAgICAgICAgICAgZW1vamlHcm91cDogY2h1bmsoZW1vamlMaXN0LCAyMCksIC8vIOihqOaDheWIl+ihqAogICAgICAgICAgICBlbW9qaUxpc3Q6IGVtb2ppTGlzdCwKICAgICAgICAgICAgZW1vamlTaG93OiBmYWxzZSwKICAgICAgICAgICAgcmVjb3JkTGlzdDogW10sCiAgICAgICAgICAgIGxpbWl0OiAyMCwKICAgICAgICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgICAgICAgIGZpbmlzaGVkOiBmYWxzZSwKICAgICAgICAgICAgY2hhdENvbnQ6ICIiLAogICAgICAgICAgICBzZXJ2aWNlOiBudWxsLAogICAgICAgICAgICBzZXJ2aWNlRGF0YToge30sCiAgICAgICAgICAgIHVwbG9hZEFjdGlvbjogJycsCiAgICAgICAgICAgIG5vdGljZTogIiIsCiAgICAgICAgICAgIGF1ZGlvOiBudWxsLAogICAgICAgICAgICBtdXRlZDogZmFsc2UsCiAgICAgICAgICAgIGF1ZGlvU3JjOiAnJywKICAgICAgICAgICAgdXBwZXJJZDogMCwKICAgICAgICAgICAgdXBsb2FkRGF0YToge30sCiAgICAgICAgICAgIGlzX3RvdXJpc3Q6IDEsIC8vIDDnmbvlvZXnirbmgIHvvIwx5pyq55m75b2V54q25oCB5ri45a6iCiAgICAgICAgICAgIHRleHQ6JycsCiAgICAgICAgICAgIGlzTG9hZDogZmFsc2UsCiAgICAgICAgICAgIHBhZ2U6IDEsCiAgICAgICAgICAgIHRvdXJpc3RfYXZhdGFyOiAnJywgLy/muLjlrqLlpLTlg48KICAgICAgICAgICAgdG91cmlzdF91aWQ6ICcnLCAvL+a4uOWuomlkCiAgICAgICAgICAgIHRvVWlkOiAnJywgLy/lrqLmnI1pZAogICAgICAgICAgICBrdWZ1VG9rZW46ICcnIC8vIHRva2VuCiAgICAgICAgfTsKICAgIH0sCiAgICB3YXRjaDogewogICAgICAgIG11dGVkKHZhbHVlKSB7CiAgICAgICAgICAgIHRoaXMuYXVkaW8ubXV0ZWQgPSB2YWx1ZTsKICAgICAgICB9CiAgICB9LAogICAgY29tcHV0ZWQ6IHsKICAgICAgICByZWNvcmRzKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5yZWNvcmRMaXN0Lm1hcCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgIGlmIChpbmRleCkgewogICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgbmV3IERhdGUoaXRlbS5hZGRfdGltZSkgLQogICAgICAgICAgICAgICAgICAgICAgICBuZXcgRGF0ZSh0aGlzLnJlY29yZExpc3RbaW5kZXggLSAxXS5hZGRfdGltZSkgPj0KICAgICAgICAgICAgICAgICAgICAgICAgMzAwMDAwCiAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2hvdyA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zaG93ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpdGVtLnNob3cgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBpdGVtOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgfSwKICAgIGNyZWF0ZWQoKSB7CiAgICAgICAgaWYobG9jYXRpb24uaHJlZi5pbmRleE9mKCdrZWZ1JykhPS0xKSB0aGlzLnVwbG9hZEFjdGlvbiA9IFNldHRpbmcuYXBpQmFzZVVSTC5yZXBsYWNlKC9hZG1pbmFwaS8sICJrZWZ1YXBpIikrJy90b3VyaXN0L3VwbG9hZCc7CiAgICAgICAgbGV0IHRva2VuID0gQ29va2llcy5nZXQoJ2F1dGguX3Rva2VuLmxvY2FsMScpOwogICAgICAgIHRoaXMua3VmdVRva2VuID0gdG9rZW4/dG9rZW4uc3BsaXQoIkJlYXJlciAiKVsxXTogJyc7CiAgICB9LAogICAgbW91bnRlZCgpIHsKICAgICAgICBsZXQgdGhhdCA9IHRoaXMKICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRoYXQuZW1vamlTaG93ID0gZmFsc2UKICAgICAgICB9KTsKICAgICAgICBpZiAodGhpcy4kd2VjaGF0Ll9pc01vYmlsZSgpKSB0aGlzLiRyb3V0ZXIucmVwbGFjZSgnL2tlZnUvbW9iaWxlX3VzZXJfY2hhdCcpOwogICAgICAgIHRoaXMuZ2V0Tm90aWNlKCk7CiAgICAgICAgU29ja2V0LnRoZW4od3M9PnsKICAgICAgICAgICAgaWYodGhpcy5rdWZ1VG9rZW4pewogICAgICAgICAgICAgICAgd3Muc2VuZCh7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2xvZ2luJywKICAgICAgICAgICAgICAgICAgICBkYXRhOiB0aGlzLmt1ZnVUb2tlbgogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLmdldFNlcnZpY2UoKTsKICAgICAgICAgICAgd3MuJG9uKFsicmVwbHkiLCAiY2hhdCJdLCBkYXRhID0+IHsKICAgICAgICAgICAgICAgIGlmKGRhdGEubXNuX3R5cGUgPT0gMSl7CiAgICAgICAgICAgICAgICAgICAgZGF0YS5tc24gPSB0aGlzLnJlcGxhY2VfZW0oZGF0YS5tc24pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLnJlY29yZExpc3QucHVzaChkYXRhKQogICAgICAgICAgICAgICAgc2V0VGltZW91dChyZXM9PnsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbsKgKCnCoHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5yZWNvcmQuc2Nyb2xsVG9wwqA9IHRoaXMuJHJlZnMucmVjb3JkLnNjcm9sbEhlaWdodMKgLcKgdGhpcy4kcmVmcy5yZWNvcmQuY2xpZW50SGVpZ2h0OwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSwzMDApCgogICAgICAgICAgICB9KTsKICAgICAgICAgICAgLy8g55uR5ZCs5a6i5pyN6L2s5o6lCiAgICAgICAgICAgIHdzLiRvbigndG9fdHJhbnNmZXInLCBkYXRhID0+IHsKICAgICAgICAgICAgICAgIHRoaXMudG9VaWQgPSBkYXRhLnRvVWlkOwogICAgICAgICAgICAgICAgd3Muc2VuZCh7CiAgICAgICAgICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgICAgICAgICBpZDogdGhpcy50b1VpZAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RvX2NoYXQnCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHdzLiRvbigic29ja2V0X2Vycm9yIiwgKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcign6L+e5o6l5aSx6LSlJykKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHdzLiRvbigiZXJyX3RpcCIsIGRhdGEgPT4gewogICAgICAgICAgICAgICAgdGhpcy4kTWVzc2FnZS5lcnJvcihkYXRhLm1zZykKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHdzLiRvbigic3VjY2VzcyIsIGRhdGEgPT4gewogICAgICAgICAgICAgICAgdGhpcy5pc190b3VyaXN0ID0gMDsKICAgICAgICAgICAgfSk7CgogICAgICAgIH0pOwogICAgICAgIHRoaXMudGV4dCA9IHRoaXMucmVwbGFjZV9lbSgnW2VtLXNtaWxpbmdfaW1wXScpCiAgICB9LAogICAgYmVmb3JlRGVzdHJveSgpIHsKICAgICAgICB0aGlzLnNvY2tldC5jbG9zZSgpOwogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBvbkxvb2soaWQpewogICAgICAgICAgICB3aW5kb3cub3BlbihgJHtsb2NhdGlvbi5vcmlnaW59L2hvbWUvZ29vZHNfZGV0YWlsLyR7aWR9YCk7CiAgICAgICAgfSwKICAgICAgICAvLyDlhbPpl60KICAgICAgICBjbG9zZUNoYW5nZShtc2cpewogICAgICAgICAgICB0aGlzLmNoYW5nZSA9IG1zZzsKICAgICAgICB9LAogICAgICAgIC8vIOe7n+S4gOWPkemAgeWkhOeQhgogICAgICAgIHNlbmRNc2cobXNuLHR5cGUpIHsKICAgICAgICAgICAgbGV0IG9iaiA9IHsKICAgICAgICAgICAgICAgIHR5cGU6J2NoYXQnLAogICAgICAgICAgICAgICAgZGF0YTp7CiAgICAgICAgICAgICAgICAgICAgbXNuLAogICAgICAgICAgICAgICAgICAgIHR5cGUsCiAgICAgICAgICAgICAgICAgICAgaXNfdG91cmlzdDogdGhpcy5pc190b3VyaXN0LAogICAgICAgICAgICAgICAgICAgIHRvX3VpZDogdGhpcy50b1VpZCwKICAgICAgICAgICAgICAgICAgICB0b3VyaXN0X3VpZDogdGhpcy50b3VyaXN0X3VpZCwKICAgICAgICAgICAgICAgICAgICB0b3VyaXN0X2F2YXRhcjogdGhpcy50b3VyaXN0X2F2YXRhciwKICAgICAgICAgICAgICAgICAgICBmb3JtX3R5cGU6IHRoaXMuJHdlY2hhdC5pc1dlaXhpbigpID8gMSA6IDMsCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgU29ja2V0LnRoZW4od3M9PiB7CiAgICAgICAgICAgICAgICB3cy5zZW5kKG9iaikKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIC8vIOmaj+acuuWuouacjQogICAgICAgIGdldFNlcnZpY2UoKSB7CiAgICAgICAgICAgIHNlcnZpY2VMaXN0QXBpKHt0b2tlbjogdGhpcy5rdWZ1VG9rZW4gfHwgJyd9KS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuc2VydmljZURhdGEgPSByZXMuZGF0YTsKICAgICAgICAgICAgICAgIHRoaXMudXBwZXJJZCA9IDAKICAgICAgICAgICAgICAgIHRoaXMudG9VaWQgPSByZXMuZGF0YS51aWQ7CiAgICAgICAgICAgICAgICB0aGlzLnRvdXJpc3RfdWlkID0gcmVzLmRhdGEudG91cmlzdF91aWQ7CiAgICAgICAgICAgICAgICB0aGlzLnRvdXJpc3RfYXZhdGFyID0gcmVzLmRhdGEudG91cmlzdF9hdmF0YXI7CiAgICAgICAgICAgICAgICBsZXQgb2JqID0gewogICAgICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHJlcy5kYXRhLnVpZCwKICAgICAgICAgICAgICAgICAgICAgICAgdG91cmlzdF91aWQ6IHRoaXMudG91cmlzdF91aWQKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICd0b19jaGF0JwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgU29ja2V0LnRoZW4od3M9PiB7CiAgICAgICAgICAgICAgICAgICAgd3Muc2VuZChvYmopCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgaWYodGhpcy5rdWZ1VG9rZW4pewogICAgICAgICAgICAgICAgICAgdGhpcy5nZXRSZWNvcmRMaXN0KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuJE1lc3NhZ2UuZXJyb3IoZXJyLm1zZyk7CiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZSA9IHRydWU7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgcm9vbUNsaWNrKGV2ZW50KSB7CiAgICAgICAgICAgIC8vIGlmICgKICAgICAgICAgICAgLy8gICAgICFldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCJlbW9qaS1wYW5lbCIpICYmCiAgICAgICAgICAgIC8vICAgICAhZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygiZW1vamktYnRuIikgJiYKICAgICAgICAgICAgLy8gICAgICFldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCJpY29uLWJpYW9xaW5nIikgJiYKICAgICAgICAgICAgLy8gICAgIHRoaXMuZW1vamlTaG93CiAgICAgICAgICAgIC8vICkgewogICAgICAgICAgICAvLyAgICAgdGhpcy5lbW9qaVNob3cgPSBmYWxzZTsKICAgICAgICAgICAgLy8gfQogICAgICAgIH0sCiAgICAgICAgLy8gZW50ZXIg5Y+R6YCBCiAgICAgICAgY3RybEVudGVyKGUpIHsKICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAxMykgewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0aGlzLmNoYXRDb250LnRyaW0oKSkgewogICAgICAgICAgICAgICAgdGhpcy5zZW5kTWVzc2FnZSgpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAvLyDlhbPpl63ogYrlpKnnqpflj6MKICAgICAgICBjbG9zZSgpIHsKICAgICAgICAgICAgdGhpcy4kZW1pdCgiY2hhdC1jbG9zZSIpOwogICAgICAgIH0sCiAgICAgICAgLy8g6YCJ5oup6KGo5oOFCiAgICAgICAgc2VsZWN0RW1vamkoZGF0YSkgewogICAgICAgICAgICBsZXQgdmFsID0gYFske2RhdGF9XWAKICAgICAgICAgICAgdGhpcy5jaGF0Q29udCArPSB2YWwKICAgICAgICAgICAgdGhpcy5lbW9qaVNob3cgPSBmYWxzZTsKICAgICAgICB9LAogICAgICAgIC8vIOiBiuWkqeihqOaDhei9rOaNogogICAgICAgIHJlcGxhY2VfZW0oc3RyKSB7CiAgICAgICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKC9cW2VtLShbYS16X10qKVxdL2csICI8c3BhbiBjbGFzcz0nZW0gZW0tJDEnLz48L3NwYW4+Iik7CiAgICAgICAgICAgIHJldHVybiBzdHI7CiAgICAgICAgfSwKICAgICAgICBvblNjcm9sbChldmVudCkgewogICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0LnNjcm9sbFRvcCA8PTMwKSB7CiAgICAgICAgICAgICAgICBpZih0aGlzLmt1ZnVUb2tlbil7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRSZWNvcmRMaXN0KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIC8vIOiBiuWkqeiusOW9lQogICAgICAgIGdldFJlY29yZExpc3QoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmxvYWRpbmcpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodGhpcy5maW5pc2hlZCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgIGNoYXRMaXN0QXBpKHsKICAgICAgICAgICAgICAgIHVpZDogdGhpcy5zZXJ2aWNlRGF0YS51aWQsCiAgICAgICAgICAgICAgICBsaW1pdDogdGhpcy5saW1pdCwKICAgICAgICAgICAgICAgIHVwcGVySWQ6dGhpcy51cHBlcklkLAogICAgICAgICAgICAgICAgdG9rZW46IHRoaXMua3VmdVRva2VuCiAgICAgICAgICAgIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgICBpZihyZXMuZGF0YS5sZW5ndGggPT09IDApIHJldHVybiB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHJlcy5kYXRhLmZvckVhY2goZWw9PnsKICAgICAgICAgICAgICAgICAgICBpZihlbC5tc25fdHlwZSA9PSAxKXsKICAgICAgICAgICAgICAgICAgICAgICAgZWwubXNuID0gdGhpcy5yZXBsYWNlX2VtKGVsLm1zbikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgbGV0IHNlbGVjdG9yID0gJycKICAgICAgICAgICAgICAgIGlmKHRoaXMudXBwZXJJZCA9PSAwKXsKICAgICAgICAgICAgICAgICAgICBzZWxlY3RvciA9IGBjaGF0XyR7cmVzLmRhdGFbcmVzLmRhdGEubGVuZ3RoLTFdLmlkfWA7CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICBzZWxlY3RvciA9IGBjaGF0XyR7dGhpcy5yZWNvcmRMaXN0WzBdLmlkfWA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLnJlY29yZExpc3QgPSBbLi4ucmVzLmRhdGEsLi4udGhpcy5yZWNvcmRMaXN0XTsKICAgICAgICAgICAgICAgIHRoaXMudXBwZXJJZCA9IHJlcy5kYXRhLmxlbmd0aD4wP3Jlcy5kYXRhWzBdLmlkIDogMAogICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gcmVzLmRhdGEubGVuZ3RoIDwgdGhpcy5saW1pdDsKICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uwqAoKcKgewogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0UGFnZVNjcm9sbFRvKHNlbGVjdG9yKQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuJE1lc3NhZ2UuZXJyb3IoZXJyLm1zZyk7CiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIC8vIOiuvue9rumhtemdoua7muWKqOS9jee9rgogICAgICAgIHNldFBhZ2VTY3JvbGxUbyhzZWxlY3Rvcil7CiAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpPT57CiAgICAgICAgICAgICAgICBpZihzZWxlY3Rvcil7CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKT0+ewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgbnVtID0gcGFyc2VGbG9hdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzZWxlY3Rvcikub2Zmc2V0VG9wKS02MAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLnJlY29yZC5zY3JvbGxUb3AgPSBudW0KICAgICAgICAgICAgICAgICAgICB9LDApCiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICB2YXIgY29udGFpbmVyID1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIjY2hhdF9zY3JvbGwiKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLnJlY29yZC5zY3JvbGxUb3AgPSBjb250YWluZXIub2Zmc2V0SGVpZ2h0CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChyZXM9PnsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHRoaXMuJHJlZnMucmVjb3JkLnNjcm9sbFRvcCAhPSB0aGlzLiRyZWZzLnNjcm9sbEJveC5vZmZzZXRIZWlnaHQpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5yZWNvcmQuc2Nyb2xsVG9wID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiI2NoYXRfc2Nyb2xsIikub2Zmc2V0SGVpZ2h0CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LDMwMCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIC8vIOihqOaDheWMheaYvuekuumakOiXjwogICAgICAgIGVtb2ppU3dpdGNoKCkgewogICAgICAgICAgICB0aGlzLmVtb2ppU2hvdyA9ICF0aGlzLmVtb2ppU2hvdzsKICAgICAgICB9LAogICAgICAgIC8vIOWPkemAgea2iOaBrwogICAgICAgIHNlbmRNZXNzYWdlKCkgewogICAgICAgICAgICB0aGlzLnNlbmRNc2codGhpcy5jaGF0Q29udCwgMSkKICAgICAgICAgICAgdGhpcy5jaGF0Q29udCA9ICIiOwogICAgICAgIH0sCiAgICAgICAgY2hhdChkYXRhKSB7CiAgICAgICAgICAgIGlmIChkYXRhLnVpZCAhPSB0aGlzLiRhdXRoLnVzZXIudWlkICYmIHRoaXMuYXVkaW8pIHsKICAgICAgICAgICAgICAgIHRoaXMuYXVkaW8ucGxheSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMucmVjb3JkTGlzdC5wdXNoKGRhdGEpOwogICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLnJlY29yZC5zY3JvbGxUb3AgPQogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMucmVjb3JkLnNjcm9sbEhlaWdodCAtIHRoaXMuJHJlZnMucmVjb3JkLmNsaWVudEhlaWdodDsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBzZW5kR29vZHMoKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmNoYXRPcHRpb25zLmdvb2RzSWQpIHsKICAgICAgICAgICAgICAgIFNvY2tldC50aGVuKHdzID0+IHsKICAgICAgICAgICAgICAgICAgICB3cy5zZW5kKHsKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNuOiB0aGlzLmNoYXRPcHRpb25zLmdvb2RzSWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiA1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9fdWlkOiB0aGlzLnRvVWlkLAogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAidG9fY2hhdCIKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgc2VuZE9yZGVyKCkgewogICAgICAgICAgICBpZiAodGhpcy5jaGF0T3B0aW9ucy5vcmRlcklkKSB7CiAgICAgICAgICAgICAgICBTb2NrZXQudGhlbih3cz0+IHsKICAgICAgICAgICAgICAgICAgICB3cy5zZW5kKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc246IHRoaXMuY2hhdE9wdGlvbnMub3JkZXJJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiA2LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvX3VpZDogdGhpcy50b1VpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ0b19jaGF0IgogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBjaGF0RW5kKCkgewogICAgICAgICAgICBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIikgPiAwKSB7CiAgICAgICAgICAgICAgICBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIDYuMCIpID4gMCkgewogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuZXIgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbG9zZSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cub3BlbignJywgJ190b3AnKTsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cudG9wLmNsb3NlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZiAobmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJGaXJlZm94IikgPiAwKSB7CiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICdhYm91dDpibGFuayAnOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgd2luZG93Lm9wZW5lciA9IG51bGw7CiAgICAgICAgICAgICAgICB3aW5kb3cub3BlbignJywgJ19zZWxmJywgJycpOwogICAgICAgICAgICAgICAgd2luZG93LmNsb3NlKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIC8vIOW5v+WRigogICAgICAgIGdldE5vdGljZSgpIHsKICAgICAgICAgICAgZ2V0QWR2QXBpKCkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLm5vdGljZSA9IHJlcy5kYXRhLmNvbnRlbnQ7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgYmVmb3JlVXBsb2FkKGZpbGUpIHsKICAgICAgICAgICAgdGhpcy51cGxvYWREYXRhID0gewogICAgICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGUsCiAgICAgICAgICAgICAgICB0b2tlbjogdGhpcy5rdWZ1VG9rZW4KICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7CiAgICAgICAgfSwKICAgICAgICBoYW5kbGVGb3JtYXRFcnJvciAoZmlsZSkgewogICAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKCLkuIrkvKDlm77niYflj6rog73mmK8ganBn44CBanBn44CBanBlZ+OAgWdpZiDmoLzlvI8hIik7CiAgICAgICAgfSwKICAgICAgICB1cGxvYWRTdWNjZXNzKHJlcykgewogICAgICAgICAgICB0aGlzLnNlbmRNc2cocmVzLmRhdGEudXJsLDMpCiAgICAgICAgfSwKICAgICAgICB1cGxvYWRFcnJvcihlcnJvcikgewogICAgICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKGVycm9yKTsKICAgICAgICB9CiAgICB9Cn07Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/kefu/appChat","sourcesContent":["<template>\n    <div class=\"chat-room\">\n        <div\n                class=\"room\"\n                :class=\"{ win: !chatOptions.popup }\"\n                @click=\"roomClick\"\n        >\n            <div v-drag class=\"head\">\n                <div class=\"image\">\n                    <img v-lazy=\"serviceData && serviceData.avatar\" />\n                </div>\n                <div class=\"name\">{{ serviceData && serviceData.nickname }}</div>\n                <div :class=\"['iconfont', muted ? 'icon-shengyinjingyinxianxing' : 'icon-shengyinyinliang']\" @click.stop=\"muted = !muted\"></div>\n                <div class=\"iconfont icon-guanbi5\" @click.stop=\"close\"></div>\n            </div>\n            <div class=\"main\">\n                <div class=\"chat\">\n                    <div class=\"record\" @scroll=\"onScroll\" ref=\"record\">\n                        <div id=\"chat_scroll\" ref=\"scrollBox\">\n                            <Spin v-show=\"loading\">\n                                <Icon type=\"ios-loading\" size=18 class=\"demo-spin-icon-load\"></Icon>\n                                <div>Loading</div>\n                            </Spin>\n                            <ul>\n                                <template v-for=\"item in records\">\n                                    <li :key=\"item.id\" :class=\"{ right: item.uid === serviceData.tourist_uid }\" :id=\"`chat_${item.id}`\">\n                                        <div v-if=\"item.show\" class=\"time-tag\">\n                                            {{ item.add_time }}\n                                        </div>\n                                        <div class=\"avatar\">\n                                            <img v-lazy=\"item.avatar\" />\n                                        </div>\n                                        <div class=\"content\" ref=\"chatContent\">\n                                            <div v-if=\"item.msn_type === 1\" class=\"text\"  v-html=\"item.msn\"></div>\n                                            <div v-if=\"item.msn_type === 2\" class=\"image\">\n                                                <div class=\"text\">\n                                                    <i :class=\"`em ${item.msn}`\"></i>\n                                                </div>\n                                            </div>\n                                            <div v-if=\"item.msn_type === 3\" class=\"image\" v-viewer>\n                                                <img v-lazy=\"item.msn\" />\n                                            </div>\n                                            <div v-if=\"item.msn_type === 5\" class=\"goods\">\n                                                <div class=\"thumb\">\n                                                    <img v-lazy=\"item.productInfo.image\" />\n                                                </div>\n                                                <div class=\"intro\">\n                                                    <div class=\"name\">\n                                                        {{ item.productInfo.store_name }}\n                                                    </div>\n                                                    <div class=\"attr\">\n                                                        <span>库存：{{ item.productInfo.stock }}</span>\n                                                        <span>销量：{{ item.productInfo.sales }}</span>\n                                                    </div>\n                                                    <div class=\"group\">\n                                                        <div class=\"money\">\n                                                            ￥{{ item.productInfo.price }}\n                                                        </div>\n                                                        <span style=\"cursor: pointer\" @click.stop=\"onLook(item.productInfo.id)\">查看商品 ></span>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                            <template v-if=\"item.msn_type === 6\">\n                                                <div\n                                                        v-for=\"itm in item.orderInfo.cartInfo\"\n                                                        :key=\"itm.id\"\n                                                        class=\"order\"\n                                                >\n                                                    <div class=\"thumb\">\n                                                        <img :src=\"itm.productInfo.image\" />\n                                                    </div>\n                                                    <div class=\"intro\">\n                                                        <div class=\"name\">\n                                                            订单ID：{{ item.orderInfo.order_id }}\n                                                        </div>\n                                                        <div class=\"attr\">商品数量：{{ itm.cart_num }}</div>\n                                                        <div class=\"group\">\n                                                            <div class=\"money\">\n                                                                ￥{{ itm.productInfo.price }}\n                                                            </div>\n                                                            <nuxt-link\n                                                                    target=\"_blank\"\n                                                                    :to=\"{\n                                path: '/order_detail',\n                                query: { orderId: item.orderInfo.order_id },\n                              }\"\n                                                            >查看订单 ></nuxt-link\n                                                            >\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            </template>\n                                        </div>\n                                    </li>\n                                </template>\n                            </ul>\n                        </div>\n\n                    </div>\n                    <div class=\"editor\">\n                        <div class=\"editor-hd\">\n                            <div>\n                                <button class=\"emoji-btn\" title=\"表情\" @click.stop=\"emojiSwitch\">\n                                    <span class=\"iconfont iconbiaoqing1\"></span>\n                                </button>\n                                <button title=\"图片\" v-if=\"kufuToken\">\n                                    <Upload :show-upload-list=\"false\" :action=\"uploadAction\"\n                                            :before-upload=\"beforeUpload\"\n                                            :format=\"['jpg','jpeg','png','gif']\"\n                                            :on-format-error=\"handleFormatError\"\n                                            :data=\"uploadData\"\n                                            :on-success=\"uploadSuccess\"\n                                            :on-error=\"uploadError\"\n                                            >\n                                        <span class=\"iconfont icontupian1\"></span>\n                                    </Upload>\n                                </button>\n                            </div>\n<!--                            <div>-->\n<!--                                <button class=\"end\" @click=\"chatEnd\">-->\n<!--                                    <i class=\"iconfont icon-guanji\"></i>结束-->\n<!--                                </button>-->\n<!--                            </div>-->\n                            <!-- 表情 -->\n                            <div class=\"emoji-panel\" v-if=\"emojiShow\">\n                                <i class=\"em\" :class=\"emoji\" @click.stop=\"selectEmoji(emoji)\" v-for=\"(emoji, index) in emojiList\" :key=\"index\"></i>\n                            </div>\n                        </div>\n                        <div class=\"editor-bd\">\n              <textarea\n                      v-model=\"chatCont\"\n                      placeholder=\"请输入文字内容\"\n                      @keydown.enter=\"ctrlEnter\"\n              ></textarea>\n                        </div>\n                        <div class=\"editor-ft\">\n                            <button :disabled=\"!chatCont\" @click.stop=\"sendMessage\">发送</button>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"notice\">\n                    <div v-if=\"notice\" class=\"rich\" v-html=\"notice\"></div>\n                    <div class=\"copy\">\n                        <a href=\"https://www.csyongyi.com/\" target=\"_blank\">永益科技提供技术支持</a>\n                    </div>\n                </div>\n            </div>\n            <audio ref=\"audio\" :src=\"audioSrc\"></audio>\n        </div>\n        <feed-back   @closeChange=\"closeChange($event)\"  v-if=\"change\" :change=\"change\"></feed-back>\n    </div>\n</template>\n\n<script>\n    import \"emoji-awesome/dist/css/google.min.css\";\n    import emojiList from \"@/utils/emoji\";\n    import {Socket} from \"@/libs/socket\";\n    import Setting from \"@/setting\";\n    import Cookies from 'js-cookie';\n    import { chatListApi, serviceListApi, getAdvApi, serviceList, getOrderApi,productApi } from '@/api/kefu';\n    import feedBack from './feedback';\n    const chunk = function(arr, num) {\n        num = num * 1 || 1;\n        var ret = [];\n        arr.forEach(function(item, i) {\n            if (i % num === 0) {\n                ret.push([]);\n            }\n            ret[ret.length - 1].push(item);\n        });\n        return ret;\n    };\n    export default {\n        name: \"ChatRoom\",\n        auth: false,\n        components:{\n            feedBack\n        },\n        props: {\n            chatOptions: {\n                type: Object,\n                default: function () {\n                    return {\n                        show: false,\n                    };\n                },\n            },\n        },\n        directives: {\n            drag: {\n                inserted: function (el) {\n                    let x = 0;\n                    let y = 0;\n                    let l = 0;\n                    let t = 0;\n                    let isDown = false;\n                    el.onmousedown = function (e) {\n                        x = e.clientX;\n                        y = e.clientY;\n                        l = el.parentNode.offsetLeft;\n                        t = el.parentNode.offsetTop;\n                        isDown = true;\n                        el.style.cursor = \"move\";\n                        window.onmousemove = function (e) {\n                            if (isDown == false) {\n                                return;\n                            }\n                            let nx = e.clientX;\n                            let ny = e.clientY;\n                            let nl = nx - (x - l);\n                            let nt = ny - (y - t);\n                            el.parentNode.style.left = nl + \"px\";\n                            el.parentNode.style.top = nt + \"px\";\n                        };\n                        window.onmouseup = function () {\n                            isDown = false;\n                            el.style.cursor = \"default\";\n                            window.onmousemove = null;\n                            window.onmouseup = null;\n                        };\n                        return false;\n                    };\n                },\n            },\n        },\n        data() {\n            return {\n                locations: `${location.origin}`,\n                change: false,\n                emojiGroup: chunk(emojiList, 20), // 表情列表\n                emojiList: emojiList,\n                emojiShow: false,\n                recordList: [],\n                limit: 20,\n                loading: false,\n                finished: false,\n                chatCont: \"\",\n                service: null,\n                serviceData: {},\n                uploadAction: '',\n                notice: \"\",\n                audio: null,\n                muted: false,\n                audioSrc: '',\n                upperId: 0,\n                uploadData: {},\n                is_tourist: 1, // 0登录状态，1未登录状态游客\n                text:'',\n                isLoad: false,\n                page: 1,\n                tourist_avatar: '', //游客头像\n                tourist_uid: '', //游客id\n                toUid: '', //客服id\n                kufuToken: '' // token\n            };\n        },\n        watch: {\n            muted(value) {\n                this.audio.muted = value;\n            }\n        },\n        computed: {\n            records() {\n                return this.recordList.map((item, index) => {\n                    if (index) {\n                        if (\n                            new Date(item.add_time) -\n                            new Date(this.recordList[index - 1].add_time) >=\n                            300000\n                        ) {\n                            item.show = true;\n                        } else {\n                            item.show = false;\n                        }\n                    } else {\n                        item.show = false;\n                    }\n                    return item;\n                });\n            },\n        },\n        created() {\n            if(location.href.indexOf('kefu')!=-1) this.uploadAction = Setting.apiBaseURL.replace(/adminapi/, \"kefuapi\")+'/tourist/upload';\n            let token = Cookies.get('auth._token.local1');\n            this.kufuToken = token?token.split(\"Bearer \")[1]: '';\n        },\n        mounted() {\n            let that = this\n            window.addEventListener('click',function(){\n                that.emojiShow = false\n            });\n            if (this.$wechat._isMobile()) this.$router.replace('/kefu/mobile_user_chat');\n            this.getNotice();\n            Socket.then(ws=>{\n                if(this.kufuToken){\n                    ws.send({\n                        type: 'login',\n                        data: this.kufuToken\n                    })\n                }\n                this.getService();\n                ws.$on([\"reply\", \"chat\"], data => {\n                    if(data.msn_type == 1){\n                        data.msn = this.replace_em(data.msn)\n                    }\n                    this.recordList.push(data)\n                    setTimeout(res=>{\n                        this.$nextTick(function () {\n                            this.$refs.record.scrollTop = this.$refs.record.scrollHeight - this.$refs.record.clientHeight;\n                        });\n                    },300)\n\n                });\n                // 监听客服转接\n                ws.$on('to_transfer', data => {\n                    this.toUid = data.toUid;\n                    ws.send({\n                        data: {\n                            id: this.toUid\n                        },\n                        type: 'to_chat'\n                    });\n                });\n                ws.$on(\"socket_error\", () => {\n                    this.$Message.error('连接失败')\n                });\n                ws.$on(\"err_tip\", data => {\n                    this.$Message.error(data.msg)\n                });\n                ws.$on(\"success\", data => {\n                    this.is_tourist = 0;\n                });\n\n            });\n            this.text = this.replace_em('[em-smiling_imp]')\n        },\n        beforeDestroy() {\n            this.socket.close();\n        },\n        methods: {\n            onLook(id){\n                window.open(`${location.origin}/home/goods_detail/${id}`);\n            },\n            // 关闭\n            closeChange(msg){\n                this.change = msg;\n            },\n            // 统一发送处理\n            sendMsg(msn,type) {\n                let obj = {\n                    type:'chat',\n                    data:{\n                        msn,\n                        type,\n                        is_tourist: this.is_tourist,\n                        to_uid: this.toUid,\n                        tourist_uid: this.tourist_uid,\n                        tourist_avatar: this.tourist_avatar,\n                        form_type: this.$wechat.isWeixin() ? 1 : 3,\n                    }\n                }\n                Socket.then(ws=> {\n                    ws.send(obj)\n                })\n            },\n            // 随机客服\n            getService() {\n                serviceListApi({token: this.kufuToken || ''}).then((res) => {\n                    this.serviceData = res.data;\n                    this.upperId = 0\n                    this.toUid = res.data.uid;\n                    this.tourist_uid = res.data.tourist_uid;\n                    this.tourist_avatar = res.data.tourist_avatar;\n                    let obj = {\n                        data: {\n                            id: res.data.uid,\n                            tourist_uid: this.tourist_uid\n                        },\n                        type: 'to_chat'\n                    }\n                    Socket.then(ws=> {\n                        ws.send(obj)\n                    })\n                    if(this.kufuToken){\n                       this.getRecordList();\n                    }\n                }).catch((err) => {\n                    this.$Message.error(err.msg);\n                    this.change = true;\n                });\n            },\n            roomClick(event) {\n                // if (\n                //     !event.target.classList.contains(\"emoji-panel\") &&\n                //     !event.target.classList.contains(\"emoji-btn\") &&\n                //     !event.target.classList.contains(\"icon-biaoqing\") &&\n                //     this.emojiShow\n                // ) {\n                //     this.emojiShow = false;\n                // }\n            },\n            // enter 发送\n            ctrlEnter(e) {\n                if (e.keyCode == 13) {\n                    e.preventDefault();\n                }\n                if (this.chatCont.trim()) {\n                    this.sendMessage();\n                }\n            },\n            // 关闭聊天窗口\n            close() {\n                this.$emit(\"chat-close\");\n            },\n            // 选择表情\n            selectEmoji(data) {\n                let val = `[${data}]`\n                this.chatCont += val\n                this.emojiShow = false;\n            },\n            // 聊天表情转换\n            replace_em(str) {\n                str = str.replace(/\\[em-([a-z_]*)\\]/g, \"<span class='em em-$1'/></span>\");\n                return str;\n            },\n            onScroll(event) {\n                if (event.target.scrollTop <=30) {\n                    if(this.kufuToken){\n                        this.getRecordList();\n                    }\n                }\n            },\n            // 聊天记录\n            getRecordList() {\n                if (this.loading) {\n                    return;\n                }\n                if (this.finished) {\n                    return;\n                }\n                this.loading = true;\n                chatListApi({\n                    uid: this.serviceData.uid,\n                    limit: this.limit,\n                    upperId:this.upperId,\n                    token: this.kufuToken\n                }).then((res) => {\n                   if(res.data.length === 0) return this.loading = false;\n                    res.data.forEach(el=>{\n                        if(el.msn_type == 1){\n                            el.msn = this.replace_em(el.msn)\n                        }\n                    })\n                    let selector = ''\n                    if(this.upperId == 0){\n                        selector = `chat_${res.data[res.data.length-1].id}`;\n                    }else{\n                        selector = `chat_${this.recordList[0].id}`;\n                    }\n                    this.recordList = [...res.data,...this.recordList];\n                    this.upperId = res.data.length>0?res.data[0].id : 0\n                    this.loading = false;\n                    this.finished = res.data.length < this.limit;\n                    this.$nextTick(function () {\n                        this.setPageScrollTo(selector)\n                    });\n                }).catch((err) => {\n                    this.$Message.error(err.msg);\n                    this.loading = false;\n                })\n            },\n            // 设置页面滚动位置\n            setPageScrollTo(selector){\n                this.$nextTick(()=>{\n                    if(selector){\n                        setTimeout(()=>{\n                            let num = parseFloat(document.getElementById(selector).offsetTop)-60\n                            this.$refs.record.scrollTop = num\n                        },0)\n                    }else{\n                        var container =document.querySelector(\"#chat_scroll\");\n                        this.$refs.record.scrollTop = container.offsetHeight\n                        setTimeout(res=>{\n                            if( this.$refs.record.scrollTop != this.$refs.scrollBox.offsetHeight){\n                                this.$refs.record.scrollTop = document.querySelector(\"#chat_scroll\").offsetHeight\n                            }\n                        },300)\n                    }\n                })\n            },\n            // 表情包显示隐藏\n            emojiSwitch() {\n                this.emojiShow = !this.emojiShow;\n            },\n            // 发送消息\n            sendMessage() {\n                this.sendMsg(this.chatCont, 1)\n                this.chatCont = \"\";\n            },\n            chat(data) {\n                if (data.uid != this.$auth.user.uid && this.audio) {\n                    this.audio.play();\n                }\n                this.recordList.push(data);\n                this.$nextTick(() => {\n                    this.$refs.record.scrollTop =\n                        this.$refs.record.scrollHeight - this.$refs.record.clientHeight;\n                });\n            },\n            sendGoods() {\n                if (this.chatOptions.goodsId) {\n                    Socket.then(ws => {\n                        ws.send({\n                            data: {\n                                msn: this.chatOptions.goodsId,\n                                type: 5,\n                                to_uid: this.toUid,\n                            },\n                            type: \"to_chat\"\n                        })\n                    })\n                }\n            },\n            sendOrder() {\n                if (this.chatOptions.orderId) {\n                    Socket.then(ws=> {\n                        ws.send({\n                                data: {\n                                    msn: this.chatOptions.orderId,\n                                    type: 6,\n                                    to_uid: this.toUid,\n                                },\n                            type: \"to_chat\"\n                        })\n                    })\n                }\n            },\n            chatEnd() {\n                if (navigator.userAgent.indexOf(\"MSIE\") > 0) {\n                    if (navigator.userAgent.indexOf(\"MSIE 6.0\") > 0) {\n                        window.opener = null;\n                        window.close();\n                    } else {\n                        window.open('', '_top');\n                        window.top.close();\n                    }\n                }\n                else if (navigator.userAgent.indexOf(\"Firefox\") > 0) {\n                    window.location.href = 'about:blank ';\n                } else {\n                    window.opener = null;\n                    window.open('', '_self', '');\n                    window.close();\n                }\n            },\n            // 广告\n            getNotice() {\n                getAdvApi().then((res) => {\n                    this.notice = res.data.content;\n                });\n            },\n            beforeUpload(file) {\n                this.uploadData = {\n                    filename: file,\n                    token: this.kufuToken\n                }\n                let promise = new Promise((resolve) => {\n                    this.$nextTick(function () {\n                        resolve(true);\n                    });\n                });\n                return promise;\n            },\n            handleFormatError (file) {\n                this.$Message.error(\"上传图片只能是 jpg、jpg、jpeg、gif 格式!\");\n            },\n            uploadSuccess(res) {\n                this.sendMsg(res.data.url,3)\n            },\n            uploadError(error) {\n                this.$Message.error(error);\n            }\n        }\n    };\n</script>\n\n<style lang=\"less\" scoped>\n    @import \"../../../styles/emoji-awesome/css/google.min.css\";\n    li{\n        list-style-type:none;\n    }\n    .chat-room {\n        .room {\n            border-radius:10px;\n            position: fixed;\n            top: calc(50% - 327px);\n            left: calc(50% - 365px);\n            z-index: 999;\n            display: flex;\n            flex-direction: column;\n            width: 730px;\n            height: 654px;\n            background-color: #ffffff;\n            overflow: hidden;\n            box-shadow: 1px 1px 15px 0 rgba(0, 0, 0, 0.1);\n\n            &.win {\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n            }\n\n            .head {\n                display: flex;\n                align-items: center;\n                height: 50px;\n                padding-right: 15px;\n                padding-left: 20px;\n                background: linear-gradient(270deg, #1890ff 0%, #3875ea 100%);\n\n                .image {\n                    width: 36px;\n                    height: 36px;\n                    border-radius: 50%;\n                    overflow: hidden;\n\n                    img {\n                        display: block;\n                        width: 100%;\n                        height: 100%;\n                        object-fit: cover;\n                    }\n                }\n\n                .name {\n                    flex: 1;\n                    min-width: 0;\n                    margin-left: 15px;\n                    font-size: 16px;\n                    color: #ffffff;\n                }\n\n                .iconfont {\n                    width: 25px;\n                    height: 25px;\n                    font-size: 16px;\n                    line-height: 25px;\n                    text-align: center;\n                    color: #ffffff;\n                    cursor: pointer;\n                }\n            }\n\n            .main {\n                flex: 1;\n                display: flex;\n                min-height: 0;\n\n                .chat {\n                    flex: 1;\n                    display: flex;\n                    flex-direction: column;\n                    min-width: 0;\n                }\n\n                .record {\n                    flex: 1;\n                    min-height: 0;\n                    overflow-x: hidden;\n                    overflow-y: auto;\n\n                    &::-webkit-scrollbar {\n                        display: none;\n                    }\n\n                    ul {\n                        padding: 20px;\n                    }\n\n                    li {\n                        ~ li {\n                            margin-top: 20px;\n                        }\n\n                        &::after {\n                            content: \"\";\n                            display: block;\n                            height: 0;\n                            clear: both;\n                            visibility: hidden;\n                        }\n\n                        &.right {\n                            .avatar {\n                                float: right;\n                            }\n\n                            .content {\n                                text-align: right;\n\n                                > div {\n                                    text-align: left;\n                                }\n                            }\n                        }\n                    }\n\n                    .time-tag {\n                        padding-top: 10px;\n                        padding-bottom: 30px;\n                        text-align: center;\n                        color: #999999;\n                    }\n\n                    .avatar {\n                        float: left;\n                        width: 40px;\n                        height: 40px;\n                        border-radius: 50%;\n                        overflow: hidden;\n\n                        &.right {\n                            float: right;\n                        }\n\n                        img {\n                            display: block;\n                            width: 100%;\n                            height: 100%;\n                            object-fit: cover;\n                        }\n                    }\n\n                    .content {\n                        margin-right: 56px;\n                        margin-left: 56px;\n                    }\n\n                    .text {\n                        display: inline-block;\n                        min-height: 41px;\n                        padding: 10px 12px;\n                        border-radius: 10px;\n                        background-color: #f5f5f5;\n                        font-size: 15px;\n                        line-height: 21px;\n                        color: #000000;\n                    }\n\n                    .image {\n                        display: inline-block;\n                        max-width: 50%;\n                        border-radius: 10px;\n                        overflow: hidden;\n\n                        img {\n                            display: block;\n                            max-width: 100%;\n                        }\n                    }\n\n                    .goods,\n                    .order {\n                        display: inline-flex;\n                        align-items: center;\n                        width: 320px;\n                        padding: 10px 13px;\n                        border-radius: 10px;\n                        background-color: #f5f5f5;\n                    }\n\n                    .thumb {\n                        width: 60px;\n                        height: 60px;\n                        border-radius: 5px;\n                        overflow: hidden;\n\n                        img {\n                            display: block;\n                            width: 100%;\n                            height: 100%;\n                        }\n                    }\n\n                    .intro {\n                        flex: 1;\n                        min-width: 0;\n                        margin-left: 10px;\n\n                        .name {\n                            overflow: hidden;\n                            white-space: nowrap;\n                            text-overflow: ellipsis;\n                            font-size: 15px;\n                            color: #000000;\n                        }\n\n                        .attr {\n                            margin-top: 5px;\n                            font-size: 12px;\n                            color: #999999;\n\n                            span {\n                                vertical-align: middle;\n\n                                ~ span {\n                                    margin-left: 10px;\n                                }\n                            }\n                        }\n\n                        .group {\n                            display: flex;\n                            justify-content: space-between;\n                            align-items: center;\n                            margin-top: 5px;\n\n                            .money {\n                                font-size: 14px;\n                                color: #ff0000;\n                            }\n\n                            a {\n                                font-size: 12px;\n                                color: #1890ff;\n                            }\n                        }\n                    }\n                }\n\n                .editor {\n                    display: flex;\n                    flex-direction: column;\n                    height: 162px;\n                    border-top: 1px solid #ececec;\n\n                    > div {\n                        &:first-child {\n                            font-size: 0;\n                        }\n                    }\n\n                    button {\n                        border: none;\n                        background: none;\n                        outline: none;\n\n                        ~ button {\n                            margin-left: 20px;\n                        }\n\n                        &.end {\n                            font-size: 15px;\n                        }\n\n                        &:hover {\n                            color: #1890ff;\n\n                            .iconfont {\n                                color: #1890ff;\n                            }\n                        }\n                    }\n\n                    .editor-hd {\n                        position: relative;\n                        display: flex;\n                        justify-content: space-between;\n                        align-items: center;\n                        height: 50px;\n                        padding-right: 20px;\n                        padding-left: 20px;\n\n                        .iconfont {\n                            line-height: 1;\n                            color: #333333;\n                        }\n\n                        .emoji-panel {\n                            position: absolute;\n                            bottom: 100%;\n                            left: 5px;\n                            width: 390px;\n                            padding-bottom: 10px;\n                            border: 1px solid #ececec;\n                            margin-bottom: 5px;\n                            background-color: #ffffff;\n                            box-shadow: 1px 0 16px 0 rgba(0, 0, 0, 0.05);\n\n                            .em {\n                                width: 28px;\n                                height: 28px;\n                                padding: 4px;\n                                margin-top: 10px;\n                                margin-left: 10px;\n                                box-sizing: border-box;\n\n                                &:hover {\n                                    background-color: #ececec;\n                                }\n                            }\n                        }\n                    }\n\n                    .icon-biaoqing1,\n                    .icon-tupian1 {\n                        font-size: 22px;\n                    }\n\n                    .icon-guanji {\n                        margin-right: 5px;\n                        font-size: 15px;\n                    }\n\n                    .editor-bd {\n                        flex: 1;\n                        min-height: 0;\n\n                        textarea {\n                            display: block;\n                            width: 100%;\n                            height: 100%;\n                            padding-right: 20px;\n                            padding-left: 20px;\n                            border: none;\n                            outline: none;\n                            resize: none;\n                            white-space: pre-wrap;\n                            overflow-wrap: break-word;\n\n                            &::-webkit-scrollbar {\n                                display: none;\n                            }\n                        }\n                    }\n\n                    .editor-ft {\n                        display: flex;\n                        justify-content: flex-end;\n                        align-items: center;\n                        padding-right: 20px;\n                        padding-bottom: 20px;\n\n                        button {\n                            width: 68px;\n                            height: 26px;\n                            border: none;\n                            border-radius: 3px;\n                            background-color: #3875ea;\n                            outline: none;\n                            font-size: 13px;\n                            color: #ffffff;\n\n                            &:disabled {\n                                background-color: #cccccc;\n                            }\n                        }\n                    }\n                }\n\n                .notice {\n                    display: flex;\n                    flex-direction: column;\n                    width: 260px;\n                    border-left: 1px solid #ececec;\n\n                    .rich {\n                        flex: 1;\n                        min-height: 0;\n                        padding: 18px 18px 0;\n                        overflow-x: hidden;\n                        overflow-y: auto;\n\n                        &::-webkit-scrollbar {\n                            display: none;\n                        }\n\n                        /deep/ img {\n                            width: 100%;\n                        }\n\n                        /deep/ video {\n                            width: 100%;\n                        }\n                    }\n\n                    .copy {\n                        padding-top: 15px;\n                        padding-bottom: 15px;\n                        font-size: 12px;\n                        text-align: center;\n                        a {\n                            color: #cccccc!important;\n                            text-decoration: none;\n                        }\n                    }\n                }\n            }\n        }\n    }\n</style>\n"]}]}