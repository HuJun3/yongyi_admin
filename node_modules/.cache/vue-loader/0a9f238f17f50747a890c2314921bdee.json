{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hujun/Downloads/永益科技后端/src/pages/app/wechat/menus/index.vue?vue&type=style&index=0&id=54b330c0&scoped=true&lang=less&","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/pages/app/wechat/menus/index.vue","mtime":1610587844000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/less-loader/dist/cjs.js","mtime":1625101332743},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCip7CiAgICAtbW96LXVzZXItc2VsZWN0OiBub25lOyAvKueBq+eLkCovCiAgICAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lOyAvKndlYmtpdOa1j+iniOWZqCovCiAgICAtbXMtdXNlci1zZWxlY3Q6IG5vbmU7IC8qSUUxMCovCiAgICAta2h0bWwtdXNlci1zZWxlY3Q6IG5vbmU7IC8q5pep5pyf5rWP6KeI5ZmoKi8KICAgIHVzZXItc2VsZWN0OiBub25lOwp9Ci5sZWZ0IHsKICAgIG1pbi13aWR0aDogMzkwcHg7CiAgICBtaW4taGVpZ2h0OiA1NTBweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIHBhZGRpbmctbGVmdDogNDBweDsKfQoKLnRvcCB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICB0b3A6IDBweDsKfQoKLmJvdHRvbSB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBib3R0b206IDBweDsKfQoKLnRleHRib3QgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgYm90dG9tOiAwcHg7CiAgICBsZWZ0OiA4MnB4OwogICAgd2lkdGg6IDEwMCU7Cn0KLmFjdGl2ZSB7CiAgICBib3JkZXI6IDFweCBzb2xpZCAjNDRCNTQ5ICFpbXBvcnRhbnQ7CiAgICBjb2xvcjogIzQ0QjU0OSAhaW1wb3J0YW50Owp9Ci5saSB7CiAgICBmbG9hdDogbGVmdDsKICAgIHdpZHRoOiA5M3B4OwogICAgbGluZS1oZWlnaHQ6IDQ4cHg7CiAgICBib3JkZXI6IDFweCBzb2xpZCAjRTdFN0VCOwogICAgYmFja2dyb3VuZDogI0ZBRkFGQTsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIGNvbG9yOiAjOTk5OwogICAgcG9zaXRpb246IHJlbGF0aXZlOwp9Ci50ZXh0ewogICAgaGVpZ2h0OiA1MHB4OwogICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgIHdpZHRoOiAxMDAlOwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIHRleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7CiAgICBwYWRkaW5nOiAwIDVweDsKfQoudGV4dDpob3ZlciB7CiAgICBjb2xvcjogIzAwMDsKfQoKLmFkZCB7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICBib3R0b206IDY1cHg7CiAgICB3aWR0aDogMTAwJTsKICAgIGxpbmUtaGVpZ2h0OiA0OHB4OwogICAgYm9yZGVyOiAxcHggc29saWQgI0U3RTdFQjsKICAgIGJhY2tncm91bmQ6ICNGQUZBRkE7Cn0KLmFycm93IHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIGJvdHRvbTogLTE2cHg7CiAgICBsZWZ0OiAzNnB4OwogICAgLyog5ZyG6KeS55qE5L2N572u6ZyA6KaB57uG5b+D6LCD6K+V5ZOmICovCiAgICB3aWR0aDogMDsKICAgIGhlaWdodDogMDsKICAgIGZvbnQtc2l6ZTogMDsKICAgIGJvcmRlcjogc29saWQgOHB4OwogICAgYm9yZGVyLWNvbG9yOiNmZmYgI0Y0RjVGOSAjRjRGNUY5ICNGNEY1Rjk7Cn0KLnRpYW5qaWEgewogICAgcG9zaXRpb246IGFic29sdXRlOwogICAgYm90dG9tOiAxMTVweDsKICAgIHdpZHRoOiAxMDAlOwogICAgbGluZS1oZWlnaHQ6IDQ4cHg7CiAgICBiYWNrZ3JvdW5kOiAjRkFGQUZBOwp9Ci5hZGRhZGQgewogICAgd2lkdGg6IDEwMCU7CiAgICBsaW5lLWhlaWdodDogNDhweDsKICAgIGJvcmRlcjogMXB4IHNvbGlkICNFN0U3RUI7CiAgICBiYWNrZ3JvdW5kOiAjRkFGQUZBOwogICAgaGVpZ2h0OiA0OHB4Owp9Ci5yaWdodCB7CiAgICBiYWNrZ3JvdW5kOiAjZmZmOwogICAgbWluLWhlaWdodDogNDAwcHg7Cn0KLnNwd2lkdGh7CiAgICB3aWR0aDogMTAwJTsKfQoudXNlckFsZXJ0ewogIG1hcmdpbi10b3A6IDE2cHghaW1wb3J0YW50Owp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/app/wechat/menus","sourcesContent":["<template>\n    <div class=\"article-manager\">\n        <div class=\"i-layout-page-header\">\n          <div class=\"i-layout-page-header\">\n            <span class=\"ivu-page-header-title\">{{$route.meta.title}}</span>\n          </div>\n        </div>\n        <Card :bordered=\"false\" dis-hover class=\"ivu-mt\">\n            <!-- 公众号设置 -->\n            <Row :gutter=\"24\" type=\"flex\">\n                <Col span=\"24\" class=\"ml40\">\n                    <!-- 预览功能 -->\n                    <Col :span=\"24\">\n                        <Col :xl=\"7\" :lg=\"7\" :md=\"22\" :sm=\"22\" :xs=\"22\" class=\"left mb15\">\n                            <img class=\"top\" src=\"../../../../assets/images/mobilehead.png\" />\n                            <img class=\"bottom\" src=\"@/assets/images/mobilefoot.png\" />\n                            <div style=\"background: #F4F5F9; min-height: 438px; position: absolute;\n         top: 63px; width: 320px; \">\n                            </div>\n                            <div class=\"textbot\">\n                                <div class=\"li\" v-for=\"(item,indx) in list\" :key=\"indx\" :class=\"{active:item === formValidate}\">\n                                    <div>\n                                        <div class=\"add\" @click=\"add(item,indx)\">\n                                            <Icon type=\"ios-add\" />\n                                            <div class=\"arrow\"></div>\n                                        </div>\n                                        <div class=\"tianjia\">\n                                            <div class=\"addadd\" v-for=\"(j,index) in item.sub_button\" :key=\"index\"\n                                                 :class=\"{active:j === formValidate}\" @click=\"gettem(j,index,indx)\">{{j.name || '二级菜单'}}</div>\n                                        </div>\n                                    </div>\n                                    <div class=\"text\" @click=\"gettem(item,indx,null)\">{{item.name || '一级菜单'}}</div>\n                                </div>\n                                <div class=\"li\" v-show=\"list.length < 3\">\n                                    <div class=\"text\" @click=\"addtext\"><Icon type=\"ios-add\" /></div>\n                                </div>\n                            </div>\n                        </Col>\n                        <Col :xl=\"11\" :lg=\"12\" :md=\"22\" :sm=\"22\" :xs=\"22\" >\n                            <Tabs value=\"name1\" v-if=\"checkedMenuId !== null\">\n                                <TabPane label=\"菜单信息\" name=\"name1\">\n                                    <Col span=\"24\" class=\"userAlert\">\n                                        <div class=\"box-card right\">\n                                            <Alert show-icon closable class=\"spwidth\"> 已添加子菜单，仅可设置菜单名称</Alert>\n                                            <Form  ref=\"formValidate\" :model=\"formValidate\" :rules=\"ruleValidate\" :label-width=\"100\" class=\"mt20\">\n                                                <FormItem label=\"菜单名称\" prop=\"name\">\n                                                    <Input v-model=\"formValidate.name\" placeholder=\"请填写菜单名称\" class=\"spwidth\"></Input>\n                                                </FormItem>\n                                                <FormItem label=\"规则状态\" prop=\"type\">\n                                                    <Select v-model=\"formValidate.type\" placeholder=\"请选择规则状态\" class=\"spwidth\">\n                                                        <Option value=\"click\">关键字</Option>\n                                                        <Option value=\"view\">跳转网页</Option>\n                                                        <Option value=\"miniprogram\">小程序</Option>\n                                                    </Select>\n                                                </FormItem>\n                                                <div v-if=\"formValidate.type === 'click'\">\n                                                    <FormItem label=\"关键字\" prop=\"key\">\n                                                        <Input v-model=\"formValidate.key\" placeholder=\"请填写关键字\" class=\"spwidth\"></Input>\n                                                    </FormItem>\n                                                </div>\n                                                <div v-if=\"formValidate.type === 'miniprogram'\">\n                                                    <FormItem label=\"appid\" prop=\"appid\">\n                                                        <Input v-model=\"formValidate.appid\" placeholder=\"请填写appid\" class=\"spwidth\"></Input>\n                                                    </FormItem>\n                                                    <FormItem label=\"小程序路径\" prop=\"pagepath\">\n                                                        <Input v-model=\"formValidate.pagepath\" placeholder=\"请填写小程序路径\" class=\"spwidth\"></Input>\n                                                    </FormItem>\n                                                    <FormItem label=\"备用网页\" prop=\"url\">\n                                                        <Input v-model=\"formValidate.url\" placeholder=\"请填写备用网页\" class=\"spwidth\"></Input>\n                                                    </FormItem>\n                                                </div>\n                                                <div v-if=\"formValidate.type === 'view'\">\n                                                    <FormItem label=\"跳转地址\" prop=\"url\">\n                                                        <Input v-model=\"formValidate.url\" placeholder=\"请填写跳转地址\" class=\"spwidth\"></Input>\n                                                    </FormItem>\n                                                </div>\n                                            </Form>\n                                        </div>\n                                    </Col>\n                                </TabPane>\n                                <Button size=\"small\" type=\"error\"  slot=\"extra\" @click=\"deltMenus\">删除</Button>\n                            </Tabs>\n                            <Col :span=\"24\" v-if=\"isTrue\">\n                                <Button type=\"primary\" style=\"display: block;margin: 10px auto;\" @click=\"submenus('formValidate')\">保存并发布</Button>\n                            </Col>\n                        </Col>\n                    </Col>\n                </Col>\n            </Row>\n        </Card>\n\n        <Modal v-model=\"modal2\" width=\"360\">\n            <p slot=\"header\" style=\"color:#f60;text-align:center\">\n                <Icon type=\"ios-information-circle\"></Icon>\n                <span>删除</span>\n            </p>\n            <div style=\"text-align:center\">\n                <p>确定删除吗？</p>\n            </div>\n            <div slot=\"footer\">\n                <Button type=\"error\" size=\"large\" long  @click=\"del\">确定</Button>\n            </div>\n        </Modal>\n    </div>\n</template>\n\n<script>\n    import { wechatMenuApi, MenuApi } from '@/api/app'\n    export default {\n        name: 'wechatMenus',\n        data () {\n            return {\n                modal2: false,\n                formValidate: {\n                    name: '',\n                    type: 'click',\n                    appid: '',\n                    url: '',\n                    key: '',\n                    pagepath: '',\n                    id: 0\n                },\n                ruleValidate: {\n                    name: [\n                        { required: true, message: '请填写菜单名称', trigger: 'blur' },\n                        { min: 1, max: 14, message: '长度在 1 到 14 个字符', trigger: 'blur' }\n                    ],\n                    key: [\n                        { required: true, message: '请填写关键字', trigger: 'blur' }\n                    ],\n                    appid: [\n                        { required: true, message: '请填写appid', trigger: 'blur' }\n                    ],\n                    pagepath: [\n                        { required: true, message: '请填写备用网页', trigger: 'blur' }\n                    ],\n                    url: [\n                        { required: true, message: '请填写跳转地址', trigger: 'blur' }\n                    ],\n                    type: [\n                        { required: true, message: '请选择规则状态', trigger: 'change' }\n                    ]\n                },\n                parentMenuId: null,\n                list: [],\n                checkedMenuId: null,\n                isTrue: false\n            }\n        },\n        mounted () {\n            this.getMenus()\n            if (this.list.length) {\n                this.formValidate = this.list[this.activeClass]\n            } else {\n                return this.formValidate\n            }\n        },\n        methods: {\n            // 添加一级字段函数\n            defaultMenusData () {\n                return {\n                    type: 'click',\n                    name: '',\n                    sub_button: []\n                }\n            },\n            // 添加二级字段函数\n            defaultChildData () {\n                return {\n                    type: 'click',\n                    name: ''\n                }\n            },\n            // 获取 菜单\n            getMenus () {\n                wechatMenuApi().then(async res => {\n                    let data = res.data\n                    this.list = data.menus\n                }).catch(res => {\n                    this.$Message.error(res.msg)\n                })\n            },\n            // 点击保存提交\n            submenus (name) {\n                if (this.isTrue && !this.checkedMenuId && this.checkedMenuId !== 0) {\n                    this.putData()\n                } else {\n                    this.$refs[name].validate((valid) => {\n                        if (valid) {\n                            this.putData()\n                        } else {\n                            if (!this.check()) return false\n                        }\n                    })\n                }\n            },\n            // 新增data\n            putData () {\n                let data = {\n                    button: this.list\n                }\n                MenuApi(data).then(async res => {\n                    this.$Message.success(res.msg)\n                    this.checkedMenuId = null\n                    this.formValidate = {}\n                    this.isTrue = false\n                }).catch(res => {\n                    this.$Message.error(res.msg)\n                })\n            },\n            // 点击元素\n            gettem (item, index, pid) {\n                this.checkedMenuId = index\n                this.formValidate = item\n                this.parentMenuId = pid\n                this.isTrue = true\n            },\n            // 增加二级\n            add (item, index) {\n                if (!this.check()) return false\n                if (item.sub_button.length < 5) {\n                    let data = this.defaultChildData()\n                    let id = item.sub_button.length\n                    item.sub_button.push(data)\n                    this.formValidate = data\n                    this.checkedMenuId = id\n                    this.parentMenuId = index\n                    this.isTrue = true\n                }\n            },\n            // 增加一级\n            addtext () {\n                console.log(this.list)\n                if (!this.check()) return false\n                let data = this.defaultMenusData()\n                let id = this.list.length\n                this.list.push(data)\n                this.formValidate = data\n                this.checkedMenuId = id\n                this.parentMenuId = null\n                this.isTrue = true\n            },\n            // 判断函数\n            check: function () {\n                let reg = /[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\\.?/\n                if (this.checkedMenuId === null) return true\n                if (!this.isTrue) return true\n                if (!this.formValidate.name) {\n                    this.$Message.warning('请输入按钮名称!')\n                    return false\n                }\n                if (this.formValidate.type === 'click' && !this.formValidate.key) {\n                    this.$Message.warning('请输入关键字!')\n                    return false\n                }\n                if (this.formValidate.type === 'view' && !(reg.test(this.formValidate.url))) {\n                    this.$Message.warning('请输入正确的跳转地址!')\n                    return false\n                }\n                if (this.formValidate.type === 'miniprogram' &&\n                    (!this.formValidate.appid ||\n                    !this.formValidate.pagepath ||\n                    !this.formValidate.url)) {\n                        this.$Message.warning('请填写完整小程序配置!')\n                        return false\n                    }\n                return true\n            },\n            // 删除\n            deltMenus () {\n                if (this.isTrue) {\n                    this.modal2 = true\n                } else {\n                    this.$Message.warning('请选择菜单!')\n                }\n            },\n            // 确认删除\n            del () {\n                this.parentMenuId === null ? this.list.splice(this.checkedMenuId, 1) : this.list[this.parentMenuId].sub_button.splice(this.checkedMenuId, 1)\n                this.parentMenuId = null\n                this.formValidate = {\n                    name: '',\n                    type: 'click',\n                    appid: '',\n                    url: '',\n                    key: '',\n                    pagepath: '',\n                    id: 0\n                }\n                this.isTrue = true\n                this.modal2 = false\n                this.checkedMenuId = null\n                this.$refs['formValidate'].resetFields()\n            }\n        }\n    }\n</script>\n<style scoped lang=\"less\">\n    *{\n        -moz-user-select: none; /*火狐*/\n        -webkit-user-select: none; /*webkit浏览器*/\n        -ms-user-select: none; /*IE10*/\n        -khtml-user-select: none; /*早期浏览器*/\n        user-select: none;\n    }\n    .left {\n        min-width: 390px;\n        min-height: 550px;\n        position: relative;\n        padding-left: 40px;\n    }\n\n    .top {\n        position: absolute;\n        top: 0px;\n    }\n\n    .bottom {\n        position: absolute;\n        bottom: 0px;\n    }\n\n    .textbot {\n        position: absolute;\n        bottom: 0px;\n        left: 82px;\n        width: 100%;\n    }\n    .active {\n        border: 1px solid #44B549 !important;\n        color: #44B549 !important;\n    }\n    .li {\n        float: left;\n        width: 93px;\n        line-height: 48px;\n        border: 1px solid #E7E7EB;\n        background: #FAFAFA;\n        text-align: center;\n        cursor: pointer;\n        color: #999;\n        position: relative;\n    }\n    .text{\n        height: 50px;\n        white-space: nowrap;\n        width: 100%;\n        overflow: hidden;\n        text-overflow:ellipsis;\n        padding: 0 5px;\n    }\n    .text:hover {\n        color: #000;\n    }\n\n    .add {\n        position: absolute;\n        bottom: 65px;\n        width: 100%;\n        line-height: 48px;\n        border: 1px solid #E7E7EB;\n        background: #FAFAFA;\n    }\n    .arrow {\n        position: absolute;\n        bottom: -16px;\n        left: 36px;\n        /* 圆角的位置需要细心调试哦 */\n        width: 0;\n        height: 0;\n        font-size: 0;\n        border: solid 8px;\n        border-color:#fff #F4F5F9 #F4F5F9 #F4F5F9;\n    }\n    .tianjia {\n        position: absolute;\n        bottom: 115px;\n        width: 100%;\n        line-height: 48px;\n        background: #FAFAFA;\n    }\n    .addadd {\n        width: 100%;\n        line-height: 48px;\n        border: 1px solid #E7E7EB;\n        background: #FAFAFA;\n        height: 48px;\n    }\n    .right {\n        background: #fff;\n        min-height: 400px;\n    }\n    .spwidth{\n        width: 100%;\n    }\n    .userAlert{\n      margin-top: 16px!important;\n    }\n</style>\n"]}]}