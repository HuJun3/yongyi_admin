{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/babel-loader/lib/index.js!/Users/hujun/Downloads/永益科技后端/src/utils/Excel.js","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/utils/Excel.js","mtime":1610587844000},{"path":"/Users/hujun/Downloads/永益科技后端/.babelrc","mtime":1610587842000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXM2LnR5cGVkLnVpbnQ4LWFycmF5IjsKaW1wb3J0IHsgc2F2ZUFzIH0gZnJvbSAnZmlsZS1zYXZlcic7CmltcG9ydCBYTFNYIGZyb20gJ3hsc3gnOwoKZnVuY3Rpb24gZGF0ZW51bSh2LCBkYXRlMTkwNCkgewogIGlmIChkYXRlMTkwNCkgdiArPSAxNDYyOwogIHZhciBlcG9jaCA9IERhdGUucGFyc2Uodik7CiAgcmV0dXJuIChlcG9jaCAtIG5ldyBEYXRlKERhdGUuVVRDKDE4OTksIDExLCAzMCkpKSAvICgyNCAqIDYwICogNjAgKiAxMDAwKTsKfQoKZnVuY3Rpb24gZGF0YTJ3cyhkYXRhKSB7CiAgdmFyIHdzID0ge307CiAgdmFyIHJhbmdlID0gewogICAgczogewogICAgICBjOiAxMDAwMDAwMCwKICAgICAgcjogMTAwMDAwMDAKICAgIH0sCiAgICBlOiB7CiAgICAgIGM6IDAsCiAgICAgIHI6IDAKICAgIH0KICB9OwoKICBmb3IgKHZhciBSID0gMDsgUiAhPT0gZGF0YS5sZW5ndGg7ICsrUikgewogICAgZm9yICh2YXIgQyA9IDA7IEMgIT09IGRhdGFbUl0ubGVuZ3RoOyArK0MpIHsKICAgICAgaWYgKHJhbmdlLnMuciA+IFIpIHJhbmdlLnMuciA9IFI7CiAgICAgIGlmIChyYW5nZS5zLmMgPiBDKSByYW5nZS5zLmMgPSBDOwogICAgICBpZiAocmFuZ2UuZS5yIDwgUikgcmFuZ2UuZS5yID0gUjsKICAgICAgaWYgKHJhbmdlLmUuYyA8IEMpIHJhbmdlLmUuYyA9IEM7CiAgICAgIHZhciBjZWxsID0gewogICAgICAgIHY6IGRhdGFbUl1bQ10KICAgICAgfTsKICAgICAgaWYgKGNlbGwudiA9PSBudWxsKSBjb250aW51ZTsKICAgICAgdmFyIGNlbGxSZWYgPSBYTFNYLnV0aWxzLmVuY29kZV9jZWxsKHsKICAgICAgICBjOiBDLAogICAgICAgIHI6IFIKICAgICAgfSk7CiAgICAgIGlmICh0eXBlb2YgY2VsbC52ID09PSAnbnVtYmVyJykgY2VsbC50ID0gJ24nO2Vsc2UgaWYgKHR5cGVvZiBjZWxsLnYgPT09ICdib29sZWFuJykgY2VsbC50ID0gJ2InO2Vsc2UgaWYgKGNlbGwudiBpbnN0YW5jZW9mIERhdGUpIHsKICAgICAgICBjZWxsLnQgPSAnbic7CiAgICAgICAgY2VsbC56ID0gWExTWC5TU0YuX3RhYmxlWzE0XTsKICAgICAgICBjZWxsLnYgPSBkYXRlbnVtKGNlbGwudik7CiAgICAgIH0gZWxzZSBjZWxsLnQgPSAncyc7CiAgICAgIHdzW2NlbGxSZWZdID0gY2VsbDsKICAgIH0KICB9CgogIGlmIChyYW5nZS5zLmMgPCAxMDAwMDAwMCkgd3NbJyFyZWYnXSA9IFhMU1gudXRpbHMuZW5jb2RlX3JhbmdlKHJhbmdlKTsKICByZXR1cm4gd3M7Cn0KCmZ1bmN0aW9uIFdvcmtib29rKCkgewogIGlmICghKHRoaXMgaW5zdGFuY2VvZiBXb3JrYm9vaykpIHJldHVybiBuZXcgV29ya2Jvb2soKTsKICB0aGlzLlNoZWV0TmFtZXMgPSBbXTsKICB0aGlzLlNoZWV0cyA9IHt9Owp9CgpmdW5jdGlvbiBzMmFiKHMpIHsKICB2YXIgYnVmID0gbmV3IEFycmF5QnVmZmVyKHMubGVuZ3RoKTsKICB2YXIgdmlldyA9IG5ldyBVaW50OEFycmF5KGJ1Zik7CgogIGZvciAodmFyIGkgPSAwOyBpICE9PSBzLmxlbmd0aDsgKytpKSB7CiAgICB2aWV3W2ldID0gcy5jaGFyQ29kZUF0KGkpICYgMHhGRjsKICB9CgogIHJldHVybiBidWY7Cn0KLyoKKiB0aCA9PiDooajlpLQKKiBkYXRhID0+IOaVsOaNrgoqIGZpbGVOYW1lID0+IOaWh+S7tuWQjQoqIGZpbGVUeXBlID0+IOaWh+S7tuexu+WeiwoqIHNoZWV0TmFtZSA9PiBzaGVldOmhteWQjQoqLwoKCmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHRvRXhjZWwoX3JlZikgewogIHZhciB0aCA9IF9yZWYudGgsCiAgICAgIGRhdGEgPSBfcmVmLmRhdGEsCiAgICAgIGZpbGVOYW1lID0gX3JlZi5maWxlTmFtZSwKICAgICAgZmlsZVR5cGUgPSBfcmVmLmZpbGVUeXBlLAogICAgICBzaGVldE5hbWUgPSBfcmVmLnNoZWV0TmFtZTsKICBkYXRhLnVuc2hpZnQodGgpOwogIHZhciB3YiA9IG5ldyBXb3JrYm9vaygpOwogIHZhciB3cyA9IGRhdGEyd3MoZGF0YSk7CiAgc2hlZXROYW1lID0gc2hlZXROYW1lIHx8ICdzaGVldDEnOwogIHdiLlNoZWV0TmFtZXMucHVzaChzaGVldE5hbWUpOwogIHdiLlNoZWV0c1tzaGVldE5hbWVdID0gd3M7CiAgZmlsZVR5cGUgPSBmaWxlVHlwZSB8fCAneGxzeCc7CiAgdmFyIHdib3V0ID0gWExTWC53cml0ZSh3YiwgewogICAgYm9va1R5cGU6IGZpbGVUeXBlLAogICAgYm9va1NTVDogZmFsc2UsCiAgICB0eXBlOiAnYmluYXJ5JwogIH0pOwogIGZpbGVOYW1lID0gZmlsZU5hbWUgfHwgJ+WIl+ihqCc7CiAgc2F2ZUFzKG5ldyBCbG9iKFtzMmFiKHdib3V0KV0sIHsKICAgIHR5cGU6ICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nCiAgfSksICIiLmNvbmNhdChmaWxlTmFtZSwgIi4iKS5jb25jYXQoZmlsZVR5cGUpKTsKfQ=="},{"version":3,"sources":["/Users/hujun/Downloads/永益科技后端/src/utils/Excel.js"],"names":["saveAs","XLSX","datenum","v","date1904","epoch","Date","parse","UTC","data2ws","data","ws","range","s","c","r","e","R","length","C","cell","cellRef","utils","encode_cell","t","z","SSF","_table","encode_range","Workbook","SheetNames","Sheets","s2ab","buf","ArrayBuffer","view","Uint8Array","i","charCodeAt","toExcel","th","fileName","fileType","sheetName","unshift","wb","push","wbout","write","bookType","bookSST","type","Blob"],"mappings":"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","sourcesContent":["import { saveAs } from 'file-saver'\nimport XLSX from 'xlsx'\n\nfunction datenum (v, date1904) {\n    if (date1904) v += 1462\n    let epoch = Date.parse(v)\n    return (epoch - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000)\n}\n\nfunction data2ws (data) {\n    const ws = {}\n    const range = { s: { c: 10000000, r: 10000000 }, e: { c: 0, r: 0 } }\n    for (let R = 0; R !== data.length; ++R) {\n        for (let C = 0; C !== data[R].length; ++C) {\n            if (range.s.r > R) range.s.r = R\n            if (range.s.c > C) range.s.c = C\n            if (range.e.r < R) range.e.r = R\n            if (range.e.c < C) range.e.c = C\n            const cell = { v: data[R][C] }\n            if (cell.v == null) continue\n            const cellRef = XLSX.utils.encode_cell({ c: C, r: R })\n\n            if (typeof cell.v === 'number') cell.t = 'n'\n            else if (typeof cell.v === 'boolean') cell.t = 'b'\n            else if (cell.v instanceof Date) {\n                cell.t = 'n'\n                cell.z = XLSX.SSF._table[14]\n                cell.v = datenum(cell.v)\n            } else cell.t = 's'\n\n            ws[cellRef] = cell\n        }\n    }\n    if (range.s.c < 10000000) ws['!ref'] = XLSX.utils.encode_range(range)\n    return ws\n}\nfunction Workbook () {\n    if (!(this instanceof Workbook)) return new Workbook()\n    this.SheetNames = []\n    this.Sheets = {}\n}\n\nfunction s2ab (s) {\n    const buf = new ArrayBuffer(s.length)\n    const view = new Uint8Array(buf)\n    for (let i = 0; i !== s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF\n    return buf\n}\n\n/*\n* th => 表头\n* data => 数据\n* fileName => 文件名\n* fileType => 文件类型\n* sheetName => sheet页名\n*/\nexport default function toExcel ({ th, data, fileName, fileType, sheetName }) {\n    data.unshift(th)\n    let wb = new Workbook()\n    let ws = data2ws(data)\n    sheetName = sheetName || 'sheet1'\n    wb.SheetNames.push(sheetName)\n    wb.Sheets[sheetName] = ws\n    fileType = fileType || 'xlsx'\n    let wbout = XLSX.write(wb, { bookType: fileType, bookSST: false, type: 'binary' })\n    fileName = fileName || '列表'\n    saveAs(new Blob([s2ab(wbout)], { type: 'application/octet-stream' }), `${fileName}.${fileType}`)\n}\n"]}]}