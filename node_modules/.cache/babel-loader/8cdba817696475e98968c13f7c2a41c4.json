{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/babel-loader/lib/index.js!/Users/hujun/Downloads/永益科技后端/src/libs/socket.js","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/libs/socket.js","mtime":1610587844000},{"path":"/Users/hujun/Downloads/永益科技后端/.babelrc","mtime":1610587842000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMvaHVqdW4vRG93bmxvYWRzL1x1NkMzOFx1NzZDQVx1NzlEMVx1NjI4MFx1NTQwRVx1N0FFRi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUtY29yZWpzMi9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL2h1anVuL0Rvd25sb2Fkcy9cdTZDMzhcdTc2Q0FcdTc5RDFcdTYyODBcdTU0MEVcdTdBRUYvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lLWNvcmVqczIvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgeyB3c3MgfSBmcm9tICdAL2xpYnMvdXRpbCc7CmltcG9ydCBTZXR0aW5nIGZyb20gJ0Avc2V0dGluZyc7CmltcG9ydCBWdWUgZnJvbSAndnVlJzsKdmFyIHZtID0gbmV3IFZ1ZSgpOwoKdmFyIHdzU29ja2V0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiB3c1NvY2tldChvcHQpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCB3c1NvY2tldCk7CgogICAgdGhpcy53cyA9IG51bGw7CiAgICB0aGlzLm9wdCA9IG9wdCB8fCB7fTsKICAgIHRoaXMuaW5pdChvcHQua2V5KTsKICB9CgogIF9jcmVhdGVDbGFzcyh3c1NvY2tldCwgW3sKICAgIGtleTogIm9uT3BlbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25PcGVuKCkgewogICAgICB2YXIga2V5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKICAgICAgdGhpcy5vcHQub3BlbiAmJiB0aGlzLm9wdC5vcGVuKCk7CiAgICAgIHZhciB0aGF0ID0gdGhpczsgLy8gdGhpcy5zZW5kKHsKICAgICAgLy8gICAgIHR5cGU6ICdsb2dpbicsCiAgICAgIC8vICAgICBkYXRhOiB1dGlsLmNvb2tpZXMuZ2V0KCd0b2tlbicpCiAgICAgIC8vIH0pLnRoZW4oKCkgPT4gewogICAgICAvLyAgICAgdGhhdC5waW5nKCk7CiAgICAgIC8vIH0pOwoKICAgICAgdGhhdC5waW5nKCk7CiAgICAgIHRoaXMuc29ja2V0U3RhdHVzID0gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpbml0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KGtleSkgewogICAgICB2YXIgd3NVcmwgPSAnJzsKCiAgICAgIGlmIChrZXkgPT0gMSkgewogICAgICAgIHdzVXJsID0gU2V0dGluZy53c0FkbWluU29ja2V0VXJsOwogICAgICB9CgogICAgICBpZiAoa2V5ID09IDIpIHsKICAgICAgICB3c1VybCA9IFNldHRpbmcud3NLZWZ1U29ja2V0VXJsOwogICAgICB9CgogICAgICBpZiAod3NVcmwpIHsKICAgICAgICB0aGlzLndzID0gbmV3IFdlYlNvY2tldCh3c3Mod3NVcmwpKTsKICAgICAgICB0aGlzLndzLm9ub3BlbiA9IHRoaXMub25PcGVuLmJpbmQodGhpcyk7CiAgICAgICAgdGhpcy53cy5vbmVycm9yID0gdGhpcy5vbkVycm9yLmJpbmQodGhpcyk7CiAgICAgICAgdGhpcy53cy5vbm1lc3NhZ2UgPSB0aGlzLm9uTWVzc2FnZS5iaW5kKHRoaXMpOwogICAgICAgIHRoaXMud3Mub25jbG9zZSA9IHRoaXMub25DbG9zZS5iaW5kKHRoaXMpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAicGluZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGluZygpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgIHRoYXQuc2VuZCh7CiAgICAgICAgICB0eXBlOiAncGluZycKICAgICAgICB9KTsKICAgICAgfSwgMTAwMDApOwogICAgfQogIH0sIHsKICAgIGtleTogInNlbmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbmQoZGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB0cnkgewogICAgICAgICAgX3RoaXMud3Muc2VuZChKU09OLnN0cmluZ2lmeShkYXRhKSk7CgogICAgICAgICAgcmVzb2x2ZSh7CiAgICAgICAgICAgIHN0YXR1czogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgcmVqZWN0KHsKICAgICAgICAgICAgc3RhdHVzOiBmYWxzZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvbk1lc3NhZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uTWVzc2FnZShyZXMpIHsKICAgICAgdGhpcy5vcHQubWVzc2FnZSAmJiB0aGlzLm9wdC5tZXNzYWdlKHJlcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAib25DbG9zZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DbG9zZSgpIHsKICAgICAgdGhpcy50aW1lciAmJiBjbGVhckludGVydmFsKHRoaXMudGltZXIpOwogICAgICB0aGlzLm9wdC5jbG9zZSAmJiB0aGlzLm9wdC5jbG9zZSgpOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uRXJyb3IiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uRXJyb3IoZSkgewogICAgICB0aGlzLm9wdC5lcnJvciAmJiB0aGlzLm9wdC5lcnJvcihlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICIkb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uICRvbigpIHsKICAgICAgdm0uJG9uLmFwcGx5KHZtLCBhcmd1bWVudHMpOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIHdzU29ja2V0Owp9KCk7CgpmdW5jdGlvbiBjcmVhdGVTb2NrZXQoa2V5KSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgIHZhciB3cyA9IG5ldyB3c1NvY2tldCh7CiAgICAgIGtleToga2V5LAogICAgICBvcGVuOiBmdW5jdGlvbiBvcGVuKCkgewogICAgICAgIHJlc29sdmUod3MpOwogICAgICB9LAogICAgICBlcnJvcjogZnVuY3Rpb24gZXJyb3IoZSkgewogICAgICAgIHJlamVjdChlKTsKICAgICAgfSwKICAgICAgbWVzc2FnZTogZnVuY3Rpb24gbWVzc2FnZShyZXMpIHsKICAgICAgICB2YXIgX0pTT04kcGFyc2UgPSBKU09OLnBhcnNlKHJlcy5kYXRhKSwKICAgICAgICAgICAgdHlwZSA9IF9KU09OJHBhcnNlLnR5cGUsCiAgICAgICAgICAgIF9KU09OJHBhcnNlJGRhdGEgPSBfSlNPTiRwYXJzZS5kYXRhLAogICAgICAgICAgICBkYXRhID0gX0pTT04kcGFyc2UkZGF0YSA9PT0gdm9pZCAwID8ge30gOiBfSlNPTiRwYXJzZSRkYXRhOwoKICAgICAgICB2bS4kZW1pdCh0eXBlLCBkYXRhKTsKICAgICAgfSwKICAgICAgY2xvc2U6IGZ1bmN0aW9uIGNsb3NlKGUpIHsKICAgICAgICB2bS4kZW1pdCgnY2xvc2UnLCBlKTsKICAgICAgfQogICAgfSk7CiAgfSk7Cn0KCmV4cG9ydCB2YXIgYWRtaW5Tb2NrZXQgPSBjcmVhdGVTb2NrZXQoMSk7CmV4cG9ydCB2YXIgU29ja2V0ID0gY3JlYXRlU29ja2V0KDIpOyAvLwovLyBjbGFzcyBTb2NrZXQgewovLyAgICAgY29uc3RydWN0b3IgKCkgewovLyAgICAgICAgIHRoaXMud3MgPSBudWxsOwovLyAgICAgICAgIHRoaXMuc29ja2V0U3RhdHVzID0gZmFsc2U7Ci8vICAgICB9Ci8vCi8vICAgICBjbG9zZSAoKSB7Ci8vICAgICAgICAgY29uc29sZS5sb2coJ3dzIGNsb3NlJyk7Ci8vICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyKTsKLy8gICAgICAgICB0aGlzLndzLmNsb3NlKCk7Ci8vICAgICB9Ci8vCi8vICAgICBvbk9wZW4gKGtleSA9ICcnKSB7Ci8vICAgICAgICAgbGV0IHRoYXQgPSB0aGlzOwovLyAgICAgICAgIHRoaXMuc2VuZCh7Ci8vICAgICAgICAgICAgIHR5cGU6IGtleT8na2VmdV9sb2dvbic6J2xvZ2luJywKLy8gICAgICAgICAgICAgZGF0YToga2V5P3V0aWwuY29va2llcy5rZWZ1R2V0KCd0b2tlbicpOnV0aWwuY29va2llcy5nZXQoJ3Rva2VuJykKLy8gICAgICAgICB9KS50aGVuKCgpID0+IHsKLy8gICAgICAgICAgICAgdGhhdC5waW5nKCk7Ci8vICAgICAgICAgfSk7Ci8vICAgICAgICAgdGhpcy52bS4kZW1pdCgnc29ja2V0X29wZW4nKTsKLy8gICAgICAgICB0aGlzLnNvY2tldFN0YXR1cyA9IHRydWU7Ci8vICAgICB9Ci8vCi8vICAgICBpbml0ICh2bSxrZXkpIHsKLy8gICAgICAgICB0aGlzLnZtID0gdm07Ci8vICAgICAgICAgaWYgKHRoaXMuc29ja2V0U3RhdHVzID09PSBmYWxzZSkgewovLyAgICAgICAgICAgICB0cnkgewovLyAgICAgICAgICAgICAgICAgbGV0IHdzU29ja2V0VXJsID0gU2V0dGluZy53c1NvY2tldFVybDsKLy8gICAgICAgICAgICAgICAgIHRoaXMud3MgPSBuZXcgV2ViU29ja2V0KHV0aWwud3NzKHdzU29ja2V0VXJsKSk7Ci8vICAgICAgICAgICAgICAgICB0aGlzLndzLm9ub3BlbiA9IHRoaXMub25PcGVuLmJpbmQodGhpcyxrZXkpOwovLyAgICAgICAgICAgICAgICAgdGhpcy53cy5vbmVycm9yID0gdGhpcy5vbkVycm9yLmJpbmQodGhpcyk7Ci8vICAgICAgICAgICAgICAgICB0aGlzLndzLm9ubWVzc2FnZSA9IHRoaXMub25NZXNzYWdlLmJpbmQodGhpcyk7Ci8vICAgICAgICAgICAgICAgICB0aGlzLndzLm9uY2xvc2UgPSB0aGlzLm9uQ2xvc2UuYmluZCh0aGlzKTsKLy8gICAgICAgICAgICAgfSBjYXRjaCAoZSkgewovLyAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+Wksei0pScsIGUpCi8vICAgICAgICAgICAgIH0KLy8gICAgICAgICB9Ci8vICAgICB9Ci8vCi8vICAgICBwaW5nICgpIHsKLy8gICAgICAgICB2YXIgdGhhdCA9IHRoaXM7Ci8vICAgICAgICAgdGhpcy50aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKLy8gICAgICAgICAgICAgdGhhdC5zZW5kKHsgdHlwZTogJ3BpbmcnIH0pOwovLyAgICAgICAgIH0sIDEwMDAwKTsKLy8gICAgIH0KLy8KLy8gICAgIHNlbmQgKGRhdGEpIHsKLy8gICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewovLyAgICAgICAgICAgICB0cnkgewovLyAgICAgICAgICAgICAgICAgdGhpcy53cy5zZW5kKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKLy8gICAgICAgICAgICAgICAgIHJlc29sdmUoeyBzdGF0dXM6IHRydWUgfSk7Ci8vICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKLy8gICAgICAgICAgICAgICAgIHJlamVjdCh7IHN0YXR1czogZmFsc2UgfSkKLy8gICAgICAgICAgICAgfQovLyAgICAgICAgIH0pOwovLyAgICAgfQovLwovLyAgICAgb25NZXNzYWdlIChyZXMpIHsKLy8gICAgICAgICB0aGlzLm9wdC5tZXNzYWdlICYmIHRoaXMub3B0Lm1lc3NhZ2UoKTsKLy8gICAgICAgICBjb25zdCB7IHR5cGUsIGRhdGEgPSB7fSB9ID0gSlNPTi5wYXJzZShyZXMuZGF0YSk7Ci8vICAgICAgICAgdGhpcy52bS4kZW1pdCh0eXBlLCBkYXRhKTsKLy8gICAgIH0KLy8KLy8gICAgIG9uQ2xvc2UgKCkgewovLyAgICAgICAgIHRoaXMudGltZXIgJiYgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyKTsKLy8gICAgIH0KLy8KLy8gICAgIG9uRXJyb3IgKGUpIHsKLy8gICAgICAgICB0aGlzLm9wdC5lcnJvciAmJiB0aGlzLm9wdC5lcnJvcigpOwovLyAgICAgfQovLyB9Ci8vIGV4cG9ydCBkZWZhdWx0IG5ldyBTb2NrZXQoKTs="},{"version":3,"sources":["/Users/hujun/Downloads/永益科技后端/src/libs/socket.js"],"names":["wss","Setting","Vue","vm","wsSocket","opt","ws","init","key","open","that","ping","socketStatus","wsUrl","wsAdminSocketUrl","wsKefuSocketUrl","WebSocket","onopen","onOpen","bind","onerror","onError","onmessage","onMessage","onclose","onClose","timer","setInterval","send","type","data","Promise","resolve","reject","JSON","stringify","status","e","res","message","clearInterval","close","error","$on","createSocket","parse","$emit","adminSocket","Socket"],"mappings":"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IADA,eACAA,IADA;AAAA,2CACMC,IADN;AAAA,YACMA,IADN,iCACa,EADb;;AAER3B,QAAAA,EAAE,CAAC2C,KAAH,CAASjB,IAAT,EAAeC,IAAf;AACH,OAXmB;AAYpBW,MAAAA,KAZoB,iBAYdJ,CAZc,EAYZ;AAEJlC,QAAAA,EAAE,CAAC2C,KAAH,CAAS,OAAT,EAAkBT,CAAlB;AACH;AAfmB,KAAb,CAAX;AAiBH,GAlBM,CAAP;AAmBH;;AAKD,OAAO,IAAMU,WAAW,GAAGH,YAAY,CAAC,CAAD,CAAhC;AACP,OAAO,IAAMI,MAAM,GAAGJ,YAAY,CAAC,CAAD,CAA3B,C,CACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA","sourcesContent":["import {wss} from '@/libs/util';\nimport Setting from '@/setting';\nimport Vue from 'vue';\n\nconst vm = new Vue;\n\nclass wsSocket {\n    constructor (opt) {\n        this.ws = null;\n        this.opt = opt ||{};\n        this.init(opt.key);\n    }\n\n    onOpen (key = false) {\n        this.opt.open && this.opt.open();\n        let that = this;\n        // this.send({\n        //     type: 'login',\n        //     data: util.cookies.get('token')\n        // }).then(() => {\n        //     that.ping();\n        // });\n        that.ping();\n        this.socketStatus = true;\n\n\n    }\n\n    init (key) {\n        let wsUrl = ''\n        if(key == 1){\n            wsUrl = Setting.wsAdminSocketUrl\n        }\n        if(key == 2){\n            wsUrl = Setting.wsKefuSocketUrl\n        }\n        if(wsUrl){\n            this.ws = new WebSocket(wss( wsUrl ));\n            this.ws.onopen = this.onOpen.bind(this);\n            this.ws.onerror = this.onError.bind(this);\n            this.ws.onmessage = this.onMessage.bind(this);\n            this.ws.onclose = this.onClose.bind(this);\n        }\n\n    }\n\n    ping () {\n        var that = this;\n        this.timer = setInterval(function () {\n            that.send({ type: 'ping' });\n        }, 10000);\n    }\n\n    send (data) {\n        return new Promise((resolve, reject) => {\n            try {\n                this.ws.send(JSON.stringify(data));\n                resolve({ status: true });\n            } catch (e) {\n                reject({ status: false })\n            }\n        });\n    }\n\n    onMessage (res) {\n        this.opt.message && this.opt.message(res);\n    }\n\n    onClose () {\n        this.timer && clearInterval(this.timer);\n        this.opt.close && this.opt.close();\n    }\n\n    onError (e) {\n        this.opt.error && this.opt.error(e);\n    }\n\n    $on(...args) {\n        vm.$on(...args);\n    }\n}\n\n\nfunction createSocket(key) {\n    return new Promise((resolve, reject) => {\n        const ws = new wsSocket({\n            key,\n            open(){\n                resolve(ws);\n            },\n            error(e){\n                reject(e)\n            },\n            message(res){\n                const { type, data = {} } = JSON.parse(res.data);\n                vm.$emit(type, data);\n            },\n            close(e){\n\n                vm.$emit('close', e);\n            }\n        })\n    });\n}\n\n\n\n\nexport const adminSocket = createSocket(1);\nexport const Socket = createSocket(2);\n//\n// class Socket {\n//     constructor () {\n//         this.ws = null;\n//         this.socketStatus = false;\n//     }\n//\n//     close () {\n//         console.log('ws close');\n//         clearInterval(this.timer);\n//         this.ws.close();\n//     }\n//\n//     onOpen (key = '') {\n//         let that = this;\n//         this.send({\n//             type: key?'kefu_logon':'login',\n//             data: key?util.cookies.kefuGet('token'):util.cookies.get('token')\n//         }).then(() => {\n//             that.ping();\n//         });\n//         this.vm.$emit('socket_open');\n//         this.socketStatus = true;\n//     }\n//\n//     init (vm,key) {\n//         this.vm = vm;\n//         if (this.socketStatus === false) {\n//             try {\n//                 let wsSocketUrl = Setting.wsSocketUrl;\n//                 this.ws = new WebSocket(util.wss(wsSocketUrl));\n//                 this.ws.onopen = this.onOpen.bind(this,key);\n//                 this.ws.onerror = this.onError.bind(this);\n//                 this.ws.onmessage = this.onMessage.bind(this);\n//                 this.ws.onclose = this.onClose.bind(this);\n//             } catch (e) {\n//                 console.log('失败', e)\n//             }\n//         }\n//     }\n//\n//     ping () {\n//         var that = this;\n//         this.timer = setInterval(function () {\n//             that.send({ type: 'ping' });\n//         }, 10000);\n//     }\n//\n//     send (data) {\n//         return new Promise((resolve, reject) => {\n//             try {\n//                 this.ws.send(JSON.stringify(data));\n//                 resolve({ status: true });\n//             } catch (e) {\n//                 reject({ status: false })\n//             }\n//         });\n//     }\n//\n//     onMessage (res) {\n//         this.opt.message && this.opt.message();\n//         const { type, data = {} } = JSON.parse(res.data);\n//         this.vm.$emit(type, data);\n//     }\n//\n//     onClose () {\n//         this.timer && clearInterval(this.timer);\n//     }\n//\n//     onError (e) {\n//         this.opt.error && this.opt.error();\n//     }\n// }\n\n// export default new Socket();\n"]}]}