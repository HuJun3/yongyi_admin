{"remainingRequest":"/Users/hujun/Downloads/永益科技后端/node_modules/babel-loader/lib/index.js!/Users/hujun/Downloads/永益科技后端/src/router/index.js","dependencies":[{"path":"/Users/hujun/Downloads/永益科技后端/src/router/index.js","mtime":1625101523992},{"path":"/Users/hujun/Downloads/永益科技后端/.babelrc","mtime":1610587842000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hujun/Downloads/永益科技后端/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL2h1anVuL0Rvd25sb2Fkcy9cdTZDMzhcdTc2Q0FcdTc5RDFcdTYyODBcdTU0MEVcdTdBRUYvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lLWNvcmVqczIvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBWdWUgZnJvbSAndnVlJzsKaW1wb3J0IFJvdXRlciBmcm9tICd2dWUtcm91dGVyJzsKaW1wb3J0IHJvdXRlcyBmcm9tICIuL3JvdXRlcnMiOwppbXBvcnQgU2V0dGluZyBmcm9tICdAL3NldHRpbmcnOwppbXBvcnQgc3RvcmUgZnJvbSAnQC9zdG9yZSc7CmltcG9ydCBpVmlldyBmcm9tICdpdmlldyc7CmltcG9ydCB7IHJlbW92ZUNvb2tpZXMsIGdldENvb2tpZXMsIHNldFRpdGxlIH0gZnJvbSAnQC9saWJzL3V0aWwnOwppbXBvcnQgeyBpbmNsdWRlQXJyYXkgfSBmcm9tICdAL2xpYnMvYXV0aCc7ClZ1ZS51c2UoUm91dGVyKTsKdmFyIHJvdXRlciA9IG5ldyBSb3V0ZXIoewogIHJvdXRlczogcm91dGVzLAogIG1vZGU6IFNldHRpbmcucm91dGVyTW9kZQp9KTsKLyoqCiAqIOi3r+eUseaLpuaIqgogKiDmnYPpmZDpqozor4EKICovCgpyb3V0ZXIuYmVmb3JlRWFjaCggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh0bywgZnJvbSwgbmV4dCkgewogICAgdmFyIHRva2VuLCBhY2Nlc3MsIGlzUGVybWlzc2lvbjsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgaWYgKCEodG8uZnVsbFBhdGguaW5kZXhPZigna2VmdScpICE9IC0xKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBuZXh0KCkpOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgaWYgKFNldHRpbmcuc2hvd1Byb2dyZXNzQmFyKSBpVmlldy5Mb2FkaW5nQmFyLnN0YXJ0KCk7IC8vIOWIpOaWreaYr+WQpumcgOimgeeZu+W9leaJjeWPr+S7pei/m+WFpQoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgbmV4dCgpKTsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gKF94LCBfeDIsIF94MykgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCkpOwpyb3V0ZXIuYWZ0ZXJFYWNoKGZ1bmN0aW9uICh0bykgewogIGlmIChTZXR0aW5nLnNob3dQcm9ncmVzc0JhcikgaVZpZXcuTG9hZGluZ0Jhci5maW5pc2goKTsgLy8g5pu05pS55qCH6aKYCgogIHNldFRpdGxlKHRvLCByb3V0ZXIuYXBwKTsgLy8g6L+U5Zue6aG16Z2i6aG256uvCgogIHdpbmRvdy5zY3JvbGxUbygwLCAwKTsKfSk7CmV4cG9ydCBkZWZhdWx0IHJvdXRlcjs="},{"version":3,"sources":["/Users/hujun/Downloads/永益科技后端/src/router/index.js"],"names":["Vue","Router","routes","Setting","store","iView","removeCookies","getCookies","setTitle","includeArray","use","router","mode","routerMode","beforeEach","to","from","next","fullPath","indexOf","showProgressBar","LoadingBar","start","afterEach","finish","app","window","scrollTo"],"mappings":";;AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,MAAP,MAAmB,YAAnB;AACA,OAAOC,MAAP;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,aAAT,EAAwBC,UAAxB,EAAoCC,QAApC,QAAoD,aAApD;AACA,SAASC,YAAT,QAA6B,aAA7B;AAEAT,GAAG,CAACU,GAAJ,CAAQT,MAAR;AAEA,IAAMU,MAAM,GAAG,IAAIV,MAAJ,CAAW;AACtBC,EAAAA,MAAM,EAANA,MADsB;AAEtBU,EAAAA,IAAI,EAAET,OAAO,CAACU;AAFQ,CAAX,CAAf;AAIA;AACA;AACA;AACA;;AAEAF,MAAM,CAACG,UAAP;AAAA,qEAAkB,iBAAOC,EAAP,EAAWC,IAAX,EAAiBC,IAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACXF,EAAE,CAACG,QAAH,CAAYC,OAAZ,CAAoB,MAApB,KAA+B,CAAC,CADrB;AAAA;AAAA;AAAA;;AAAA,6CAEHF,IAAI,EAFD;;AAAA;AAId,gBAAId,OAAO,CAACiB,eAAZ,EAA6Bf,KAAK,CAACgB,UAAN,CAAiBC,KAAjB,GAJf,CAKd;;AALc,6CAOPL,IAAI,EAPG;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAlB;;AAAA;AAAA;AAAA;AAAA;AAsDAN,MAAM,CAACY,SAAP,CAAiB,UAAAR,EAAE,EAAI;AACnB,MAAIZ,OAAO,CAACiB,eAAZ,EAA6Bf,KAAK,CAACgB,UAAN,CAAiBG,MAAjB,GADV,CAEnB;;AACAhB,EAAAA,QAAQ,CAACO,EAAD,EAAKJ,MAAM,CAACc,GAAZ,CAAR,CAHmB,CAInB;;AACAC,EAAAA,MAAM,CAACC,QAAP,CAAgB,CAAhB,EAAmB,CAAnB;AACH,CAND;AAQA,eAAehB,MAAf","sourcesContent":["import Vue from 'vue'\nimport Router from 'vue-router'\nimport routes from './routers'\nimport Setting from '@/setting'\nimport store from '@/store'\nimport iView from 'iview'\nimport { removeCookies, getCookies, setTitle } from '@/libs/util'\nimport { includeArray } from '@/libs/auth'\n\nVue.use(Router)\n\nconst router = new Router({\n    routes,\n    mode: Setting.routerMode\n})\n/**\n * 路由拦截\n * 权限验证\n */\n\nrouter.beforeEach(async (to, from, next) => {\n    if(to.fullPath.indexOf('kefu') != -1){\n        return next()\n    }\n    if (Setting.showProgressBar) iView.LoadingBar.start()\n    // 判断是否需要登录才可以进入\n\n    return next()\n    if (to.matched.some(_ => _.meta.auth)) {\n        // 这里依据 token 判断是否登录，可视情况修改\n        const token = getCookies('token')\n        if (token && token !== 'undefined') {\n            const access = store.state.userInfo.uniqueAuth\n            const isPermission = includeArray(to.meta.auth, access)\n            if (isPermission) {\n                next()\n            } else {\n                if(access.length == 0){\n                    next({\n                        name: 'login',\n                        query: {\n                            redirect: to.fullPath\n                        }\n                    })\n                    localStorage.clear()\n                    removeCookies('token')\n                    removeCookies('expires_time')\n                    removeCookies('uuid')\n                }else{\n                    next({\n                        name: '403'\n                    })\n                }\n            }\n            // next();\n        } else {\n            // 没有登录的时候跳转到登录界面\n            // 携带上登陆成功之后需要跳转的页面完整路径\n            next({\n                name: 'login',\n                query: {\n                    redirect: to.fullPath\n                }\n            })\n            localStorage.clear()\n            removeCookies('token')\n            removeCookies('expires_time')\n            removeCookies('uuid')\n        }\n    } else {\n        // 不需要身份校验 直接通过\n        next()\n    }\n})\nrouter.afterEach(to => {\n    if (Setting.showProgressBar) iView.LoadingBar.finish()\n    // 更改标题\n    setTitle(to, router.app)\n    // 返回页面顶端\n    window.scrollTo(0, 0)\n})\n\nexport default router\n"]}]}